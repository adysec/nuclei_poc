id: CVE-2025-55182-react2shell

info:
  name: React2shell (CVE-2025-55182) vunerability detection for React Server Components 
  author: https://github.com/oways/
  severity: critical
  description: |
    Passive detection of CVE-2025-55182 vulnerable versions without exploitation.
    
    Detects vulnerable React Server Components by identifying version strings in:
    - JavaScript bundles and source maps
    - package.json files
    - HTTP headers
    - Next.js metadata
    
    Vulnerable versions:
    - react-server-dom-webpack: 19.0.0, 19.0, 19.1.0, 19.1.1, 19.1, 19.2.0, 19.2
    - react-server-dom-turbopack: 19.0.0, 19.0, 19.1.0, 19.1.1, 19.1, 19.2.0, 19.2
    - react: 19.0.0, 19.0, 19.1.0, 19.1.1, 19.1, 19.2.0, 19.2 (with Server Components)
    - Next.js: 15.0.0-15.0.4, 14.x (with React 19), 13.5+ (with React 19)
    
  reference:
    - https://github.com/facebook/react/security/advisories/GHSA-h4p6-xr9r-2xfq
    - https://github.com/facebook/react/pull/31843
  classification:
    cve-id: CVE-2025-55182
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-1321
  metadata:
    verified: true
  tags: cve,cve2025,react,rce,nextjs,version-detection

http:
  - method: GET
    path:
      - "{{BaseURL}}/_next/static/chunks/webpack.js"
      - "{{BaseURL}}/_next/static/chunks/main.js"
      - "{{BaseURL}}/_next/static/chunks/framework.js"
      - "{{BaseURL}}"
      - "{{BaseURL}}/package.json"
      - "{{BaseURL}}/node_modules/react-server-dom-webpack/package.json"
      - "{{BaseURL}}/node_modules/next/package.json"
      - "{{BaseURL}}/static/js/bundle.js.map"
      - "{{BaseURL}}/_next/static/chunks/main.js.map"
      - "{{BaseURL}}/api/version"
      - "{{BaseURL}}/api/health"
      - "{{BaseURL}}/version.json"
      - "{{BaseURL}}/static/js/main.js"
      - "{{BaseURL}}/dist/bundle.js"

    matchers-condition: or
    matchers:
      # React Server DOM packages - all vulnerable versions
      - type: regex
        name: package-json-vulnerable
        part: body
        regex:
          - '"react-server-dom-webpack"[^}]{0,100}"19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)"'
          - '"react-server-dom-turbopack"[^}]{0,100}"19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)"'
          - '"next"[^}]{0,100}"(15\.0\.[0-4]|14\.[0-9]+\.[0-9]+|13\.([5-9]|[1-9][0-9])\.[0-9]+)"'
          - '"react"[^}]{0,100}"19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)"'

      # Next.js in headers - all vulnerable versions
      - type: word
        name: nextjs-header-vulnerable
        part: header
        words:
          - "Next.js 15.0.0"
          - "Next.js 15.0.1"
          - "Next.js 15.0.2"
          - "Next.js 15.0.3"
          - "Next.js 15.0.4"
          - "Next.js 14."
          - "Next.js 13.5."
          - "Next.js 13.6."
          - "Next.js 13.7."
          - "Next.js 13.8."
          - "Next.js 13.9."

      # Source maps with vulnerable versions
      - type: regex
        name: source-map-vulnerable
        part: body
        regex:
          - 'node_modules/react-server-dom-webpack.{0,100}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'
          - 'node_modules/react-server-dom-turbopack.{0,100}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'
          - 'node_modules/react.{0,100}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'

      # Bundles with version strings
      - type: regex
        name: bundle-version-vulnerable
        part: body
        regex:
          - 'react-server-dom-webpack.{0,30}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'
          - 'react-server-dom-turbopack.{0,30}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'
          - 'react[@"\x27/].{0,30}19\.(0\.0|0|1\.0|1\.1|1|2\.0|2)'

      # HTML metadata with versions
      - type: regex
        name: nextjs-html-vulnerable
        part: body
        regex:
          - '__NEXT_DATA__.*"version":"15\.0\.[0-4]"'
          - '__NEXT_DATA__.*"version":"1[34]\.'
          - 'data-next-version="15\.0\.[0-4]"'
          - 'data-next-version="1[34]\.'
          - '"react".*"19\.(0|1|2)\.?'

    extractors:
      - type: regex
        name: detected-versions
        group: 1
        regex:
          - 'react-server-dom-(?:webpack|turbopack).{0,20}([0-9]+\.[0-9]+\.[0-9]+)'
          - '"(?:next|react)".{0,50}"([0-9]+\.[0-9]+\.[0-9]+)"'
          - 'Next\.js\s+([0-9]+\.[0-9]+\.[0-9]+)'
