id: CVE-2024-11667

info:
  name: Zyxel ZLD Firewall - Directory Traversal
  author: geeknik
  severity: high
  description: |
    A directory traversal vulnerability in the web management interface of
    Zyxel ATP, USG FLEX, USG FLEX 50(W), and USG20(W)-VPN series firmware
    versions V5.00 through V5.38 allows an attacker to download or upload
    files via crafted URLs. Exploited in the wild to deploy Helldown
    ransomware. Listed in CISA KEV catalog.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-11667
    - https://www.zyxel.com/us/en-us/support/security-advisories/zyxel-security-advisory-protecting-against-recent-firewall-threats-11-27-2024
    - https://www.cisa.gov/news-events/alerts/2024/12/03/cisa-adds-three-known-exploited-vulnerabilities-catalog
  classification:
    cve-id: CVE-2024-11667
    cwe-id: CWE-22
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
  tags: cve,cve2024,zyxel,firewall,lfi,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 302

      # Zyxel firewall web management interface indicators
      - type: word
        part: body
        words:
          - "Zyxel"
        case-insensitive: true

      # Must be a firewall appliance, not a switch/AP
      - type: word
        part: body
        words:
          - "USG FLEX"
          - "USG20"
          - "ATP"
          - "ZLD"
          - "VPN"
        condition: or
        case-insensitive: true

      # Firmware version in the vulnerable range V5.00-V5.38
      - type: regex
        part: body
        regex:
          - "V5\\.(0[0-9]|[12][0-9]|3[0-8])\\b"

    extractors:
      - type: regex
        part: body
        name: firmware_version
        regex:
          - "V5\\.\\d+(?:\\.\\d+)?"
