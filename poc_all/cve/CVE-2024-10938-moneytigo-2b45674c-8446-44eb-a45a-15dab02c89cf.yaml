id: CVE-2024-10938-moneytigo-2b45674c-8446-44eb-a45a-15dab02c89cf

info:
  name: >
    OVRI Payment 1.7.0 - Malicious .htaccess directive
  author: topscoder
  severity: medium
  description: >
    The OVRI Payment plugin for WordPress contains malicious .htaccess files in version 1.7.0. The files contain directives to prevent the execution of certain scripts while allowing execution of known malicious PHP files. If moved outside of the plugin's directory, they may interfere with the proper function of a site.
  reference:
    - https://github.com/topscoder/nuclei-wordfence-cve
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/2b45674c-8446-44eb-a45a-15dab02c89cf?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 6.5
    cve-id: CVE-2024-10938
  metadata:
    fofa-query: "wp-content/plugins/moneytigo/"
    google-query: inurl:"/wp-content/plugins/moneytigo/"
    shodan-query: 'http.html:"wp-content/plugins/moneytigo/"'
  tags: cve,wordpress,wp-plugin,moneytigo,medium,production

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/moneytigo/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag:\\s*([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "moneytigo"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '1.7.0')