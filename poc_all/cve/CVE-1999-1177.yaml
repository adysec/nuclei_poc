id: CVE-1999-1177

info:
  name: IRIX nph-publish CGI - Arbitrary File Write Detection
  author: geeknik
  severity: critical
  description: |
    The nph-publish CGI script bundled with IRIX 6.5.x allows remote
    attackers to write arbitrary files on the server. This template detects
    the presence of the vulnerable CGI endpoint. The actual vulnerability
    allows unauthenticated file creation/overwrite, but exploitation is not
    safe to test as it modifies server state.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-1999-1177
  classification:
    cve-id: CVE-1999-1177
    cwe-id: CWE-434
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
  tags: cve,cve1999,irix,cgi,filewrite

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/nph-publish"

    matchers-condition: and
    matchers:
      # Script exists and responds (not 404)
      - type: status
        status:
          - 200
          - 403
        condition: or

      # Negative matcher: must NOT be a generic 404 page
      - type: word
        part: body
        words:
          - "Not Found"
          - "does not exist"
          - "404"
        negative: true

      # Confirm CGI/IRIX environment indicators
      - type: word
        words:
          - "nph-publish"
          - "IRIX"
          - "SGI"
          - "publish"
        condition: or

    extractors:
      - type: regex
        part: header
        name: server_info
        regex:
          - "(?i)Server:\\s*[^\\r\\n]+"
