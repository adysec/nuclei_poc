id: CVE-2023-28461

info:
  name: Array Networks AG/vxAG SSL VPN - Remote Code Execution
  author: geeknik
  severity: critical
  description: |
    Array Networks AG series and vxAG (ArrayOS AG 9.4.0.481 and earlier) SSL VPN
    gateways are vulnerable to unauthenticated remote code execution via
    missing authentication for a critical function. Actively exploited in
    the wild per CISA KEV catalog.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-28461
    - https://support.arraynetworks.net/prx/001/http/supportportal.arraynetworks.net/documentation/FieldNotice/Array_Networks_Security_Advisory_for_Remote_Code_Execution_Vulnerability_AG.pdf
    - https://www.cisa.gov/news-events/alerts/2024/11/25/cisa-adds-two-known-exploited-vulnerabilities-catalog
  classification:
    cve-id: CVE-2023-28461
    cwe-id: CWE-306
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  tags: cve,cve2023,array-networks,vpn,rce,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/prx/000/http/localhost/login"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 302

      # Fingerprint Array Networks SSL VPN via ANsession cookie
      - type: word
        part: header
        words:
          - "ANsession"

      # Confirm product identity in body
      - type: word
        part: body
        words:
          - "AG_PROXY_ID"
          - "Array Networks"
          - "ArrayOS"
          - "SSL VPN"
        condition: or

    extractors:
      - type: regex
        part: header
        name: session_cookie
        regex:
          - "ANsession=[a-zA-Z0-9]+"

      - type: regex
        part: body
        name: version
        regex:
          - "(?:ArrayOS|Version)\\s*(?:AG)?\\s*([0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)"
        group: 1
