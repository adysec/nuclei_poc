id: minio-default-admin-credentials-v2
info:
  name: MinIO Admin Default Credentials
  author: thanhnx1
  severity: high
  description: |
    Detects MinIO Admin interface using default credentials (minioadmin/minioadmin) for login via the /api/v1/login endpoint.
  tags: minio,admin,credentials

http:
  - raw:
      - |
        POST /api/v1/login HTTP/2
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/json
        Origin: https://{{Hostname}}

        {"accessKey":"minioadmin","secretKey":"minioadmin"}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "token"
          - "\"Status\": \"success\""
        part: body
    extractors:
      - type: json
        part: body
        json:
          - '.token'