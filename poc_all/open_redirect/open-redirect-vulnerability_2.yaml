id: open-redirect-vulnerability

info:
  name: Open Redirect Vulnerability Detection
  author: thanhnx1
  severity: medium
  description: |
    This template detects open redirect vulnerabilities by checking for redirections to malicious URLs provided in the request.
  tags: open-redirect, redirect

http:
  - method: GET
    path:
      - "{{BaseURL}}/redirect?url={{RedirectURL}}"
      - "{{BaseURL}}/redir?target={{RedirectURL}}"
      - "{{BaseURL}}/out?link={{RedirectURL}}"
      - "{{BaseURL}}/go?to={{RedirectURL}}"

    headers:
      User-Agent: nuclei-open-redirect-check

    payloads:
      RedirectURL:
        - "https://evil.com"
        - "http://evil.com"
        - "//evil.com"
        - "/\\evil.com"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "(?i)Location:\\s*(https?:)?//evil\\.com"
        part: header
      - type: status
        status:
          - 302
          - 301
      - type: word
        words:
          - "https://evil.com"
          - "http://evil.com"
        part: header

    extractors:
      - type: regex
        regex:
          - "Location:\\s*(https?:)?//evil\\.com"
        part: header
        internal: true