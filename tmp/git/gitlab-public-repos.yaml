id: gitlab-public-repos

info:
  name: GitLab public repositories
  author: ldionmarcil
  severity: info
  reference:
    - https://twitter.com/ldionmarcil/status/1370052344562470922
    - https://github.com/ldionmarcil/gitlab-unauth-parser

rules:
  r0:
    request:
      method: GET
      path: /api/v4/projects
      headers:
        Cookie: _gitlab_session=
    expression: response.body.bcontains(b'name_with_namespace')
expression: r0()