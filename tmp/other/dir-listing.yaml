id: dir-listing

info:
  name: Directory Listing
  author: reewardius
  reference: https://blog.infiltrateops.io/tesla-paid-me-10-000-because-of-directory-indexing-c1be06c77a3e
  severity: low
  tags: generic,dir,listing
  
http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/%2ebzr"
      - "{{BaseURL}}/%2egit"
      - "{{BaseURL}}/%2ehg"
      - "{{BaseURL}}/%2esvn"
      - "{{BaseURL}}/..;/"
      - "{{BaseURL}}/.bzr"
      - "{{BaseURL}}/.git"
      - "{{BaseURL}}/.git/"
      - "{{BaseURL}}/.hg"
      - "{{BaseURL}}/.svn"
      - "{{BaseURL}}/.svn/"
      - "{{BaseURL}}/..;/..;/"
      - "{{BaseURL}}/Bitkeeper/"
      - "{{BaseURL}}/accounts/"
      - "{{BaseURL}}/admin/"
      - "{{BaseURL}}/admin/backup/"
      - "{{BaseURL}}/admin/sql/"
      - "{{BaseURL}}/administator"
      - "{{BaseURL}}/administator/backup"
      - "{{BaseURL}}/api/"
      - "{{BaseURL}}/api/v1/"
      - "{{BaseURL}}/api/v2/"
      - "{{BaseURL}}/api/v3/"
      - "{{BaseURL}}/app_data/"
      - "{{BaseURL}}/archive/"
      - "{{BaseURL}}/aspnet_client/"
      - "{{BaseURL}}/assets"
      - "{{BaseURL}}/assets/scripts"
      - "{{BaseURL}}/attachments/"
      - "{{BaseURL}}/back-up/"
      - "{{BaseURL}}/backup/"
      - "{{BaseURL}}/backup_1/"
      - "{{BaseURL}}/backups/"
      - "{{BaseURL}}/cblr/"
      - "{{BaseURL}}/chat"
      - "{{BaseURL}}/cobbler/"
      - "{{BaseURL}}/conf/logs"
      - "{{BaseURL}}/config/"
      - "{{BaseURL}}/configs/"
      - "{{BaseURL}}/console/"
      - "{{BaseURL}}/content/"
      - "{{BaseURL}}/css/"
      - "{{BaseURL}}/customers/"
      - "{{BaseURL}}/dashboard/"
      - "{{BaseURL}}/data/"
      - "{{BaseURL}}/database/"
      - "{{BaseURL}}/databases/"
      - "{{BaseURL}}/db-sql"
      - "{{BaseURL}}/db/"
      - "{{BaseURL}}/dir/"
      - "{{BaseURL}}/document/"
      - "{{BaseURL}}/documents/"
      - "{{BaseURL}}/download/"
      - "{{BaseURL}}/downloads/"
      - "{{BaseURL}}/dump/"
      - "{{BaseURL}}/dumps/"
      - "{{BaseURL}}/edit/"      
      - "{{BaseURL}}/email/"
      - "{{BaseURL}}/env/"
      - "{{BaseURL}}/etc/"
      - "{{BaseURL}}/external/"
      - "{{BaseURL}}/file/"
      - "{{BaseURL}}/file_uploads/"      
      - "{{BaseURL}}/files/"
      - "{{BaseURL}}/home/"
      - "{{BaseURL}}/image/"
      - "{{BaseURL}}/images/"
      - "{{BaseURL}}/int/"
      - "{{BaseURL}}/inter/"
      - "{{BaseURL}}/internal/"
      - "{{BaseURL}}/invoice/"
      - "{{BaseURL}}/invoices/"
      - "{{BaseURL}}/issues/"
      - "{{BaseURL}}/js/"
      - "{{BaseURL}}/log/"
      - "{{BaseURL}}/logs/"
      - "{{BaseURL}}/media/"
      - "{{BaseURL}}/panel/"
      - "{{BaseURL}}/pdf/"
      - "{{BaseURL}}/priv/"
      - "{{BaseURL}}/private/"
      - "{{BaseURL}}/profile/"
      - "{{BaseURL}}/pub/"
      - "{{BaseURL}}/public/"
      - "{{BaseURL}}/report/"
      - "{{BaseURL}}/reports/"
      - "{{BaseURL}}/root/"
      - "{{BaseURL}}/script"
      - "{{BaseURL}}/scripts"
      - "{{BaseURL}}/secret/"
      - "{{BaseURL}}/secrets/"
      - "{{BaseURL}}/server/"
      - "{{BaseURL}}/share"
      - "{{BaseURL}}/share/"
      - "{{BaseURL}}/shared/"
      - "{{BaseURL}}/sms/"
      - "{{BaseURL}}/sql-db"
      - "{{BaseURL}}/static/"
      - "{{BaseURL}}/static/admin/"
      - "{{BaseURL}}/static/css/"
      - "{{BaseURL}}/static/fonts/"
      - "{{BaseURL}}/static/images/"
      - "{{BaseURL}}/static/js"
      - "{{BaseURL}}/static/js/"
      - "{{BaseURL}}/system/config"
      - "{{BaseURL}}/typo3conf/"
      - "{{BaseURL}}/typo3conf/ext/"
      - "{{BaseURL}}/upload/"
      - "{{BaseURL}}/uploading/"
      - "{{BaseURL}}/uploads/"
      - "{{BaseURL}}/user/"
      - "{{BaseURL}}/users/"
      - "{{BaseURL}}/v1/"
      - "{{BaseURL}}/v2/"
      - "{{BaseURL}}/v3/"
      - "{{BaseURL}}/web/"
      - "{{BaseURL}}/wp-admin/"
      
    matchers:
      - type: word
        words:
          - "Directory listing for"
          - "Index of /"
          - "[To Parent Directory]"
          - "Directory: /"
          - "&lt;dir&gt;"
        condition: or
        case-insensitive: true