id: macgyver-malware

info:
  name: MacGyver.cap Malware - Detect
  author: daffainfo
  severity: info
  reference:
    - https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_MacGyver.yar
  tags: malware,file
file:
  - extensions:
      - all
    matchers:
      - type: word
        part: raw
        words:
          - "src/MacGyver/javacard/Header.cap"
          - "src/MacGyver/javacard/Directory.cap"
          - "src/MacGyver/javacard/Applet.cap"
          - "src/MacGyver/javacard/Import.cap"
          - "src/MacGyver/javacard/ConstantPool.cap"
          - "src/MacGyver/javacard/Class.cap"
          - "src/MacGyver/javacard/Method.cap"
        condition: and

# digest: 490a00463044022047afeb1e4cf0d671f015f766751963babcaa994464a7cd807161f6cc53f9f85702205ea23d159f7c5f930e8ac99992c1e81b82bc58fa7bf50481168e325861e4667d:922c64590222798bb761d5b6d8e72950
