id: cheshirecat-malware-hash
info:
  name: CheshireCat Malware Hash - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_CheshireCat.yar
  tags: malware,apt

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == 'ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300'"
          - "sha256(raw) == '32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a'"
          - "sha256(raw) == '63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb'"
          - "sha256(raw) == 'c074aeef97ce81e8c68b7376b124546cabf40e2cd3aff1719d9daa6c3f780532'"
        condition: or
# digest: 4a0a00473045022021e6a5ce1cbde7c589e8040bcf4c9ff635eae36b4030c206440580863737eed2022100b3db91ac75df21e9c8e77385d86e2d0c9099b698cb44cd9f0ee9c85aced3b886:922c64590222798bb761d5b6d8e72950