id: malware-macgyver

info:
  name: MacGyver.cap Malware - Detect
  author: daffainfo
  severity: critical
  reference:
    - https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_MacGyver.yar
  tags: malware,file

file:
  - extensions:
      - all

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "src/MacGyver/javacard/Header.cap"
          - "src/MacGyver/javacard/Directory.cap"
          - "src/MacGyver/javacard/Applet.cap"
          - "src/MacGyver/javacard/Import.cap"
          - "src/MacGyver/javacard/ConstantPool.cap"
          - "src/MacGyver/javacard/Class.cap"
          - "src/MacGyver/javacard/Method.cap"
        condition: and