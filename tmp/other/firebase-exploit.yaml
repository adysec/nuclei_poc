id: firebase-exploit

info:
  name: Detect and exploit Firebase and Appspot broken access.
  author: S1rN3tZ
  severity: info
  description: |
    This template detects Firebase and Appspot URLs in APK files and verifies if the extracted URLs with a `.json` appended return valid responses.

file:
  - extensions:
      - all

    extractors:
      - type: regex
        name: firebase_url
        regex:
          - '(\b[a-zA-Z0-9][a-zA-Z0-9-_]*\.)*firebaseio\.com\b'
          - '(\b[a-zA-Z0-9][a-zA-Z0-9-_]*\.)*appspot\.com\b'
        internal: true

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{firebase_url}}.json

    matchers:
      - type: status
        status:
          - 200

    matchers-condition: and
    stop-at-first-match: true
