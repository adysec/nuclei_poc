id: codoso-plugx-malware-hash
info:
  name: Codoso APT PlugX Malware Hash - Detect
  author: pussycat0x
  severity: info
  description: |
    Detects Codoso APT PlugX Malware.
  reference:
    - https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_Codoso.yar
  tags: malware,apt,codoso

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == 'b9510e4484fa7e3034228337768176fce822162ad819539c6ca3631deac043eb'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
        condition: or
# digest: 4b0a00483046022100a28fe5e6a592e203aac91b31c5a900928317b3742110677293d6908b550c78dc022100f11027e271942369229d95f7aa2cbd9abcf5b4bfc0ef887e4e0af9dde1146fcd:922c64590222798bb761d5b6d8e72950