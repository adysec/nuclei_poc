id: shimrat-malware

info:
  name: ShimRat Malware - Detect
  author: daffainfo
  severity: info
  reference: https://github.com/Yara-Rules/rules/blob/master/malware/RAT_Shim.yar
  tags: malware,file
file:
  - extensions:
      - all

    matchers-condition: or
    matchers:
      - type: word
        part: raw
        words:
          - ".dll"
          - ".dat"
          - "QWERTYUIOPLKJHG"
          - "MNBVCXZLKJHGFDS"
        condition: and

      - type: word
        part: raw
        words:
          - "Data$$00"
          - "Data$$01%c%sData"
        condition: and

      - type: word
        part: raw
        words:
          - "ping localhost -n 9 /c %s > nul"
          - "Demo"
          - "Win32App"
          - "COMSPEC"
          - "ShimMain"
          - "NotifyShims"
          - "GetHookAPIs"
        condition: and

# digest: 4b0a004830460221009da26e19a00937b0d0349977f9fec211af3d556f9f893e2867131c0abd215ddf0221008601cdf41e002a97fba4584ad7e7c4df833a7b6f67cfa3bde6e2f3c5c87af44d:922c64590222798bb761d5b6d8e72950
