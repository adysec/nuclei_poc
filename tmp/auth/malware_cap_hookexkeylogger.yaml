id: malware_cap_hookexkeylogger

info:
  name: CAP HookExKeylogger Malware Detector
  author: daffainfo
  severity: critical
  reference: https://github.com/Yara-Rules/rules/blob/master/malware/MALW_CAP_HookExKeylogger.yar
  tags: malware,file

file:
  - extensions:
      - all

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "SetWindowsHookEx"
          - "WH_KEYBOARD_LL"
        condition: and
        case-insensitive: true

      - type: word
        words:
          - "SetWindowsHookEx"
          - "WH_KEYBOARD"
        condition: and
        case-insensitive: true

      - type: word
        words:
          - "WH_KEYBOARD"
          - "WH_KEYBOARD_LL"
        condition: and
        case-insensitive: true