info:
  id: CVE-2016-10993
  name: Apache Struts2 Remote Code Execution - Detect
  author: OpenAI
  description: Template to detect Apache Struts2 Remote Code Execution vulnerability (CVE-2016-10993)
  severity: Critical
  classification:
    country: any
    tags:
      - apache
      - struts2
      - cve-2016-10993
      - remote code execution
      - security

  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10993
    - https://struts.apache.org/docs/s2-048.html

  matcher-condition: or

  requests:
      method: GET
      path:
        - "/?s=%22%2F%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E\""
      description: Attempt to trigger Apache Struts2 Remote Code Execution vulnerability (CVE-2016-10993)
      condition: or

  matchers:
    - pattern: "</script><script>alert(document.domain)</script>"
      type: header
      description: Apache Struts2 header found in response

  response:
    - status:
        - 200
      description: Successful response status
