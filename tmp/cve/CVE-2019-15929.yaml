id: CVE-2019-15929

info:
  name: Craft CMS Elevated Session Password Prompt Brute Force
  author: ProjectDiscoveryAI
  severity: critical
  description: In Craft CMS through 3.1.7, the elevated session password prompt was not being rate limited like normal login forms, leading to the possibility of a brute force attempt on them.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Upgrade Craft CMS to version 3.2.7 or higher to mitigate CVE-2019-15929.
  reference:
    - http://packetstormsecurity.com/files/155012/Craft-CMS-Rate-Limiting-Brute-Force.html
    - https://github.com/craftcms/cms/blob/develop/CHANGELOG-v3.md#317---2019-01-31
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-15929
    cwe-id: CWE-640
    epss-score: 0.00235
    epss-percentile: 0.62385
    cpe: cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*
  metadata:
    vendor: craftcms
    product: craft_cms
    shodan-query: http.favicon.hash:-47932290
    fofa-query:
      - body="craftcms"
      - icon_hash="-47932290"
    publicwww-query: craftcms

http:
  - method: POST
    path:
      - "{{BaseURL}}/path-to-elevated-session-password-prompt"

    body: "password={{password}}"
    attack: batteringram
    payloads:
      password
        - admin
    matchers:
      - type: status
        status:
          - 200
