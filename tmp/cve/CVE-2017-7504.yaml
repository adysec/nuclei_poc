id: CVE-2017-7504

info:
  name: JBoss 4.x JBossMQ JMS 反序列化漏洞
  author: zan8in
  severity: critical
  description: |
    fofa: jbossmq
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-7504
    - http://wiki.peiqi.tech/wiki/webserver/JBoss/JBoss%204.x%20JBossMQ%20JMS%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20CVE-2017-7504.html
    - https://github.com/joaomatosf/jexboss

rules:
  r0:
    request:
      method: GET
      path: /jbossmq-httpil/HTTPServerILServlet
    expression: response.status == 200 && response.body.ibcontains(b'this is the jbossmq http-il')
expression: r0()