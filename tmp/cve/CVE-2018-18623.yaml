id: CVE-2018-18623

info:
  name: Grafana 5.3.1 XSS Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: Grafana 5.3.1 has XSS via the "Dashboard > Text Panel" screen. NOTE: this issue exists because of an incomplete fix for CVE-2018-12099.
  reference:
    - https://github.com/grafana/grafana/issues/15293
    - https://github.com/grafana/grafana/pull/11813

http:
  - method: GET
    path:
      - "{{BaseURL}}/dashboard/new?panelId=1&fullscreen&edit&orgId=1&tab=options"
    matchers:
      - type: word
        words:
          - "<script>alert('XSS');</script>"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/dashboard/new?panelId=2&fullscreen&edit&orgId=1&tab=columnstyles"
    matchers:
      - type: word
        words:
          - "javascript:alert('XSS')"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/dashboard/settings"
    matchers:
      - type: word
        words:
          - "TEST<script>alert('XSS')</script>"
        part: body