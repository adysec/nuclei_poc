id: CVE-2019-16891

info:
  name: Liferay Portal JSON Deserialization RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: Liferay Portal CE 6.2.5 allows remote command execution due to deserialization of a JSON payload.

http:
  - method: POST
    path:
      - "{{BaseURL}}/c/portal/portlet_url"
    headers:
      User-Agent: Mozilla/5.0
      Accept: */*
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      X-Requested-With: XMLHttpRequest
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      Origin: http://liferay.victim.example.com
      Connection: close
      Referer: http://liferay.victim.example.com
    body: |
      parameterMap={"Json payload for deserialization in here!"}
    matchers:
      - type: status
        status:
          - 200