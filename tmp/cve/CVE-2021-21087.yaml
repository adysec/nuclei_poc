id: CVE-2021-21087

info:
  name: Adobe ColdFusion - Cross-Site Scripting
  author: Daviey
  severity: medium
  description: |
    Adobe Coldfusion versions 2016 (update 16 and earlier), 2018 (update 10 and earlier) and 2021.0.0.323925 are affected by an Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') vulnerability. An attacker could abuse this vulnerability to execute arbitrary JavaScript code in context of the current user. Exploitation of this issue requires user interaction.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or updates provided by Adobe to mitigate this vulnerability.
  reference:
    - https://helpx.adobe.com/security/products/coldfusion/apsb21-16.html
    - https://twitter.com/Daviey/status/1374070630283415558
    - https://nvd.nist.gov/vuln/detail/CVE-2021-21087
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2021-21087
    cwe-id: CWE-79
    epss-score: 0.00326
    epss-percentile: 0.67709
    cpe: cpe:2.3:a:adobe:coldfusion:2016:-:*:*:*:*:*:*
  metadata:
    max-request: 7
    vendor: adobe
    product: coldfusion
    shodan-query: http.component:"Adobe ColdFusion"
  tags: cve2021,cve,xss,adobe,misc,coldfusion

http:
  - method: GET
    path:
      - "{{BaseURL}}/cf_scripts/scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/cf-scripts/scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/CFIDE/scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/cfide/scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/CF_SFSD/scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/cfide-scripts/ajax/package/cfajax.js"
      - "{{BaseURL}}/cfmx/CFIDE/scripts/ajax/package/cfajax.js"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - 'eval\(\"\(\"\+json\+\"\)\"\)'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100e1b0ba13b027eed96640ed696259d627122c17395753dd43462e49e9bb32077a022100a2908c10775d7dd07951c0f7e78c20f44fe2bd135b18df5e66d61ff32cf16888:922c64590222798bb761d5b6d8e72950