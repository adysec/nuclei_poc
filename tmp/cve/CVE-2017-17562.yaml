id: CVE-2017-17562

info:
  name: Embedthis GoAhead <3.6.5 - Remote Code Execution
  author: geeknik
  severity: high
  description: |
    description: Embedthis GoAhead before 3.6.5 allows remote code execution if CGI is enabled and a CGI program is dynamically linked.
  reference:
    - https://www.elttam.com/blog/goahead/
    - https://github.com/ivanitlearning/CVE-2017-17562
    - https://github.com/vulhub/vulhub/tree/master/goahead/CVE-2017-17562
    - https://github.com/embedthis/goahead/issues/249
    - https://nvd.nist.gov/vuln/detail/CVE-2017-17562

rules:
  r0:
    request:
      method: GET
      path: /cgi-bin/admin?LD_DEBUG=help
    expression: response.status == 200 && response.body.bcontains(b'environment variable') && response.body.bcontains(b'display library search paths')
  r1:
    request:
      method: GET
      path: /cgi-bin/apply?LD_DEBUG=help
    expression: response.status == 200 && response.body.bcontains(b'environment variable') && response.body.bcontains(b'display library search paths')
expression: r0() || r1()