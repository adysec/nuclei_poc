id: CVE-2022-24775

info:
  name: "guzzlehttp/psr7 <= 1.84 and 2.0.0-2.1.0 - Improper Input Validation"
  author: topscoder
  severity: high
  description: "guzzlehttp/psr7 is a PSR-7 HTTP message library. Versions prior to 1.8.4 and 2.1.1 are vulnerable to improper header parsing. An attacker could sneak in a new line character and pass untrusted values. The issue is patched in 1.8.4 and 2.1.1. There are currently no known workarounds. Some WordPress plugins and themes use this dependency though that doesnâ€™t necessarily mean the plugin itself is vulnerable to exploitation."
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2022-24775
    - https://github.com/guzzle/psr7/security/advisories/GHSA-q7rv-6hp3-vh96
    - https://github.com/guzzle/psr7/pull/485/commits/e55afaa3fc138c89adf3b55a8ba20dc60d17f1f1
    - https://github.com/guzzle/psr7/pull/486/commits/9a96d9db668b485361ed9de7b5bf1e54895df1dc
    - https://www.drupal.org/sa-core-2022-006
    - https://security.snyk.io/vuln/SNYK-PHP-GUZZLEHTTPPSR7-2431148
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-24775
  metadata:
    fofa-query: "wp-content/plugins/insert-special-characters/"
    google-query: inurl:"/wp-content/plugins/insert-special-characters/"
    shodan-query: 'vuln:CVE-2022-24775'
  tags: cve,wordpress,wp-plugin,insert-special-characters,high

requests:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/insert-special-characters/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "insert-special-characters"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 1.0.4')