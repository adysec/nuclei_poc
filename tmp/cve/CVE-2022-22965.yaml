id: CVE-2022-22965

info:
  name: Spring Framework RCE JDK 9+
  author: zan8in
  severity: critical
  verified: true
  description: |
    srping framework 结合JDK9及以上新版本的特性可以实现对历史漏洞补丁的绕过从而实现远程代码执行
    Fofa: app="vmware-SpringBoot-Framework"
    app="APACHE-Tomcat" || app="vmware-SpringBoot-framework" || app="vmware-SpringBoot-framework" || app="vmware-Spring-Batch" || app="vmware-Spring-framework" || app="vmware-Spring-Security"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-22965
    - https://github.com/tangxiaofeng7/CVE-2022-22965-Spring-Core-Rce/blob/main/main.go


rules:
  r0:
    request:
      method: GET
      path: /?class.module.classLoader.DefaultAssertionStatus=true
    expression: response.status == 200
  r1:
    request:
      method: GET
      path: /?class.module.classLoader.DefaultAssertionStatus=x
    expression: response.status == 400
  r2:
    request:
      method: POST
      path: /
      body: class.module.classLoader.DefaultAssertionStatus=true
    expression:  response.status == 200
  r3:
    request:
      method: POST
      path: /
      body: class.module.classLoader.DefaultAssertionStatus=x
    expression: response.status == 400
expression: (r0() && r1()) || (r2() && r3())