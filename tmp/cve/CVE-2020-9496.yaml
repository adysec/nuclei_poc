id: CVE-2020-9496

info:
  name: Apache OFBiz XML-RPC Java Deserialization
  author: dwisiswant0
  severity: medium
  description: XML-RPC request are vulnerable to unsafe deserialization and Cross-Site Scripting issues in Apache OFBiz 17.12.03
  tags: cve,cve2020,apache,java,ofbiz
  reference:
    - http://packetstormsecurity.com/files/158887/Apache-OFBiz-XML-RPC-Java-Deserialization.html
    - http://packetstormsecurity.com/files/161769/Apache-OFBiz-XML-RPC-Java-Deserialization.html
    - https://securitylab.github.com/advisories/GHSL-2020-069-apache_ofbiz
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.10
    cve-id: CVE-2020-9496
    cwe-id: CWE-79,CWE-502

manual: true
transport: http
set:
    rand: randomInt(200000000, 210000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /webtools/control/xmlrpc
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0"?><methodCall><methodName>{{rand}}</methodName><params><param><value>dwisiswant0</value></param></params></methodCall>
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("xml") && response.body.bcontains(bytes("methodResponse")) && response.body.bcontains(bytes("No such service [" + string(rand)))
expression: r0()
