id: dockercfg-config

info:
    name: Detect .dockercfg
    author: geeknik
    severity: high
    description: Docker registry authentication data

rules:
    r0:
        request:
            method: GET
            path: /.dockercfg
        expression: response.status == 200 && response.content_type.contains("text/plain") && response.body.bcontains(b'"email":') && response.body.bcontains(b'"auth":') 
    r1:
        request:
            method: GET
            path: /.docker/config.json
        expression: response.status == 200 && response.content_type.contains("text/plain") && response.body.bcontains(b'"email":') && response.body.bcontains(b'"auth":') 
expression: r0() && r1()

