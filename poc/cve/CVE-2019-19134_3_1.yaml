id: CVE-2019-19134

info:
  name: >
    Hero Maps Premium <= 2.2.2 - Reflected Cross-Site Scripting
  author: topscoder
  severity: medium
  description: >
    The Hero Maps Premium plugin 2.2.2 and prior for WordPress is prone to unauthenticated XSS via the views/dashboard/index.php p parameter because it fails to sufficiently sanitize user-supplied input. An attacker may leverage this issue to inject HTML or arbitrary JavaScript within the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based tokens or to launch other attacks.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/6a1f2a7d-f91c-4dd2-b275-0e27f65498b1?source=api-prod
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-19134
  metadata:
    fofa-query: "wp-content/plugins/hmapsprem/"
    google-query: inurl:"/wp-content/plugins/hmapsprem/"
    shodan-query: 'vuln:CVE-2019-19134'
  tags: cve,wordpress,wp-plugin,hmapsprem,medium

http:
  - method: GET
    redirects: true
    max-redirects: 3
    path:
      - "{{BaseURL}}/wp-content/plugins/hmapsprem/readme.txt"

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "hmapsprem"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '<= 2.2.2')