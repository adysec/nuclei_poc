id: CVE-2024-6387

info:
  name: regreSSHion - Unauthenticated Remote Code Execution OpenSSH
  author: 0v3rl04d
  severity: high
  description: regreSSHion, CVE-2024-6387, is an unauthenticated remote code execution in OpenSSH's server (sshd) that grants full root access. It affects the default configuration and does not require user interaction. It poses a significant exploit risk.
  remediation: Upgrade to OpenSSH 9.8p1 or later. If sshd cannot be updated or recompiled, this signal handler race condition can be fixed by simply setting LoginGraceTime to 0 in the configuration file. This makes sshd vulnerable to a denial of service (the exhaustion of all MaxStartups connections), but it makes it safe from the remote code execution
  reference:
    - https://www.qualys.com/regresshion-cve-2024-6387/
    - https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6387
    - https://nvd.nist.gov/vuln/detail/CVE-2024-6387
    - https://vulners.com/cve/CVE-2024-6387
    - https://www.tenable.com/cve/CVE-2024-6387/
    - https://www.openssh.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2024-6387
    cwe-id: CWE-364
    epss-percentile: 0.17251
    epss-score: 0.00046
    cpe: cpe:2.3:o:slackware:slackware_linux:*:*:*:*:*:*:*:* cpe:2.3:o:oracle:linux:*:*:*:*:*:*:*:* cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:* cpe:2.3:o:debian:debian_linux:*:*:*:*:*:*:*:* cpe:2.3:o:canonical:ubuntu_linux:*:*:*:*:*:*:*:* cpe:2.3:o:amazon:linux:*:*:*:*:*:*:*:* cpe:2.3:h:f5:big-ip:*:*:*:*:*:*:*:* cpe:2.3:a:oracle:linux:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: OpenBSD
    product: OpenSSH
  tags: cve,cve2024,ssh,openssh,tcp,network
tcp:
  - host:
      - "{{Hostname}}"
    port: 22
    extractors:
      - type: regex
        regex:
          # OpenSSH < 4.4p1
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>1)\.(?P<minor>[0-9]).?\d*p\d?'
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>2)\.(?P<minor>[0-9]).?\d*p\d?'
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>3)\.(?P<minor>[0-9]).?\d*p\d?'
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>4)\.(?P<minor>[0-3]).?\d*p\d?'
          # 8.5p1 <= OpenSSH < 9.8p1
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>8)\.(?P<minor>[5-9]).?\d*p\d?'
          - 'SSH-(\d+\.\d+)-OpenSSH_(?P<major>9)\.(?P<minor>[0-7]).?\d*p\d?'
