id: CVE-2020-12271

info:
  name: Sophos XG Firewall SQL Injection Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: A SQL injection issue was found in SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25 on Sophos XG Firewall devices, as exploited in the wild in April 2020. This affected devices configured with either the administration (HTTPS) service or the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access.
  impact: |
    Successful exploitation could lead to unauthorized access to sensitive information.
  remediation: |
    Apply the necessary patch provided by Sophos to mitigate the SQL Injection vulnerability (CVE-2020-12271).
  reference:
    - https://cwe.mitre.org/data/definitions/89.html
    - https://github.com/20142995/nuclei-templates
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/Elsfa7-110/kenzer-templates
    - https://github.com/Live-Hack-CVE/CVE-2020-12271
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-12271
    cwe-id: CWE-89
    epss-score: 0.01666
    epss-percentile: 0.88151
    cpe: cpe:2.3:o:sophos:sfos:17.0:*:*:*:*:*:*:*
  metadata:
    vendor: sophos
    product: sfos
    shodan-query: title:"Sophos"
    fofa-query: title="sophos"
    google-query: intitle:"sophos"
  tags: kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/exampleVulnerablePath?query=vulnerableParam' OR '1'='1"

    matchers:
      - type: word
        words:
          - "exampleUniqueErrorText"
        part: body
