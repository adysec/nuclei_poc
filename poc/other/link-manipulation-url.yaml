id: multiple-parameters-link-manipulation-URL-erickfernandox

info:
  name: Link Manipulation via Multiple Parameters
  author: erickfernandox
  severity: medium
  description: |
    It is possible to manipulate links allowing open redirect or XSS via multiple parameters
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-601
  metadata:
    max-request: 3
  tags: redirect, xss, generic

http:
  - method: GET
    path:
      - "{{BaseURL}}?protocol=evil.com&domain=evil.com&subdomain=evil.com&host=evil.com&pageurl=evil.com&url=evil.com"
      - "{{BaseURL}}?protocol=/%5cevil.com&domain=/%5cevil.com&subdomain=/%5cevil.com&host=/%5cevil.com&pageurl=/%5cevil.com&url=/%5cevil.com"      

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:                    
          - 'href="//evil.com'
          - 'action="//evil.com'
          - 'src="//evil.com'
          - 'href="/\evil.com'
          - 'action="/\evil.com'
          - 'src="/\evil.com'          
          - 'href="evil.com'
          - 'action="evil.com'
          - 'src="evil.com'             
          - 'href="/evil.com'
          - 'action="/evil.com'
          - 'src="/evil.com'             
          - 'https://evil.com'          
          
      - type: status
        status:
          - 200     
          - 404
          - 302
          - 301
          
        condition: or
