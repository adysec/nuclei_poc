id: open-redirect-vulnerability

info:
  name: Open Redirect Vulnerability
  author: Mamilate
  severity: medium
  description: This template detects open redirect vulnerabilities.
  tags: open-redirect, redirect

requests:
  - method: GET
    path:
      - "{{BaseURL}}/redirect?url={{RedirectURL}}"
      - "{{BaseURL}}/redir?target={{RedirectURL}}"
      - "{{BaseURL}}/out?link={{RedirectURL}}"
      - "{{BaseURL}}/go?to={{RedirectURL}}"

    headers:
      User-Agent: nuclei-open-redirect-check

    payloads:
      RedirectURL:
        - "https://evil.com"
        - "http://evil.com"
        - "//evil.com"
        - "/\\evil.com"

    matchers:
      - type: word
        words:
          - "https://evil.com"
          - "http://evil.com"
        part: header
        condition: and

      - type: status
        status:
          - 302
          - 301

      - type: regex
        regex:
          - "Location: .*evil\\.com"
        part: header
